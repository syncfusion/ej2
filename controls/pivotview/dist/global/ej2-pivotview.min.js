this.ej=this.ej||{},this.ej.pivotview=function(e,t,i,r,n,a,o,l,s,d,p,h,c){"use strict";var u=function(){function e(){}return e.getType=function(e){return e&&e.getDay?e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0?"datetime":"date":typeof e},e.resetTime=function(e){return e.setHours(0,0,0,0),e},e.getClonedData=function(e){for(var t=[],i=Object.keys(e[0]),r=0,n=e;r<n.length;r++){for(var a=n[r],o=0,l={};o<i.length;)l[i[o]]=a[i[o]],o++;t.push(l)}return t},e.inArray=function(e,t){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},e}(),g=function(){function e(){this.valueContent=[],this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.rMembers=[],this.cMembers=[],this.valueMatrix=[],this.indexMatrix=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rawIndexObject={},this.isEditing=!1,this.data=[],this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.groupingFields={},this.columnKeys={},this.fieldDrillCollection={}}return e.prototype.renderEngine=function(e,r,n){this.getValueCellInfo=n,this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.excludeFields=t.isNullOrUndefined(e.excludeFields)?[]:e.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rawIndexObject={},this.isEditing=!1;var a;if(this.globalize=new t.Internationalization,this.localeObj=r?r.localeObj:void 0,this.fieldsType=r?r.fieldsType:{},this.enableSort=e.enableSorting,this.alwaysShowValueHeader=e.alwaysShowValueHeader,this.showSubTotals=!!t.isNullOrUndefined(e.showSubTotals)||e.showSubTotals,this.showRowSubTotals=!!t.isNullOrUndefined(e.showRowSubTotals)||e.showRowSubTotals,this.showColumnSubTotals=!!t.isNullOrUndefined(e.showColumnSubTotals)||e.showColumnSubTotals,this.showGrandTotals=!!t.isNullOrUndefined(e.showGrandTotals)||e.showGrandTotals,this.showRowGrandTotals=!!t.isNullOrUndefined(e.showRowGrandTotals)||e.showRowGrandTotals,this.showColumnGrandTotals=!!t.isNullOrUndefined(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!r&&r.enableValueSorting,this.valueContent=[],e.dataSource instanceof i.DataManager||(this.data=e.dataSource),this.data&&this.data[0]){this.fields=Object.keys(this.data[0]);this.fields;var o={};o[0]=e.rows,o[1]=e.columns,o[2]=e.values,o[3]=e.filters;for(var l=0;l<4;){if(o[l])for(var s=0;s<o[l].length;s++)this.excludeFields.indexOf(o[l][s].name)>-1&&(o[l].splice(s,1),s--);l++}this.rows=e.rows?e.rows:[],this.columns=e.columns?e.columns:[],this.filters=e.filters?e.filters:[],this.formats=e.formatSettings?e.formatSettings:[],this.values=e.values?e.values:[],this.groups=e.groupSettings?e.groupSettings:[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,a=this.getGroupData(this.data),this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMutiMeasures=this.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.values.length:1,this.colValuesLength=0===this.valueAxis?this.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.pageSettings=r?r.pageSettings?r.pageSettings:this.pageSettings:void 0,this.savedFieldList=r?r.savedFieldList:void 0,this.isDrillThrough=!!r&&(!!r.isDrillThrough&&r.isDrillThrough),this.getFieldList(a,this.enableSort,e.allowValueFilter),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[];var d=this.columns.length-1;for(this.columnKeys={};d>-1;)this.columnKeys[this.columns[d].name]=this.columns[d],d--;this.updateFilterMembers(e),this.generateGridData(e)}},e.prototype.getGroupData=function(e){for(var r=e[0],n=this,a=0,o=this.groups;a<o.length;a++){var l=function(a){var o=a.name;if(!(n.fields.indexOf(o)>-1))return{value:r};var l={};if("Number"===a.type){if("number"!==u.getType(r[o]))return{value:r};a.rangeInterval&&e.sort(function(e,t){return e[o]>t[o]?1:t[o]>e[o]?-1:0})}for(var s=e.length;s--;){var d=e[s];if(d[o]&&"Date"===a.type){var p=new Date(d[o].toString());if(!t.isNullOrUndefined(p)&&a.groupInterval.length>0){for(var h=!1,c=0,g=a.groupInterval;c<g.length;c++){var m=g[c];h=!0;var v=n.getRange(a,p.getTime()),f=u.resetTime(new Date);switch(m){case"Years":l[S=o+"_years"]=m,d[S]=v?void 0:new Date(f.setFullYear(p.getFullYear())).toString();break;case"Quarters":l[S=o+"_quarters"]=m;var y=Math.ceil((p.getMonth()+1)/3);d[S]=v?void 0:(n.localeObj?n.localeObj.getConstant("qtr"):"Qtr")+y.toString();break;case"Months":l[S=o+"_months"]=m,d[S]=v?void 0:new Date(f.setMonth(p.getMonth(),f.getDate())).toString();break;case"Days":l[S=o+"_days"]=m,d[S]=v?void 0:new Date(f.setMonth(p.getMonth(),p.getDate())).toString();break;case"Hours":l[S=o+"_hours"]=m,d[S]=v?void 0:new Date(f.setHours(p.getHours())).toString();break;case"Minutes":l[S=o+"_minutes"]=m,d[S]=v?void 0:new Date(f.setMinutes(p.getMinutes())).toString();break;case"Seconds":var S=o+"_seconds";l[S]=m,d[S]=v?void 0:new Date(f.setSeconds(p.getSeconds())).toString()}}h&&delete d[o]}}else{v=n.getRange(a,d[o]);d[o]=v?void 0:d[o]}for(var b=[],C=0,w=Y=Object.keys(d);C<w.length;C++){Z=w[C];b.push(!!d[Z])}r=-1===b.indexOf(!1)&&Y.length===Object.keys(e[0]).length?d:r}if("Date"===a.type){for(var x=!1,T=[n.rows,n.columns,n.values,n.filters],D=Object.keys(l),M=Object.keys(D).length,O=void 0,P=0,L=T;P<L.length;P++){var E=L[P];if(!x&&E){for(var F=E.length,k=0;k<F;){if(E[k].name===o){x=!0;var A=E[k];for(E.splice(k,1);M--;){O=l[D[M]];var N={name:D[M],caption:(n.localeObj?n.localeObj.getConstant(O):O)+" ("+o+")",type:"Count",showNoDataItems:A.showNoDataItems,baseField:A.baseField,baseItem:A.baseItem};E.splice(k,0,N)}break}k++}if(x)break}}for(M=Object.keys(D).length;M--;){O=l[D[M]];var j=new i.DataManager({json:n.formats}).executeLocal((new i.Query).where("name","equal",D[M]))[0];if("Quarters"!==O&&!j){var I={name:D[M],type:["Years","Months","Days"].indexOf(O)>-1?"date":"time",format:"Years"===O?"yyyy":"Months"===O?"MMM":"Days"===O?"d-MMM":"Hours"===O?"hh a":"Minutes"===O?":mm":"Seconds"===O?":ss":void 0};n.formats.push(I)}}}else if("Number"===a.type&&a.rangeInterval){var R=void 0,q=void 0,V=void 0,H=void 0,B=[],_=[],U=e.length,F=0;for(n.groupingFields[o]=o;F<U;)_.push(e[F][o]),e[F][o]&&-1===B.indexOf(e[F][o])&&B.push(e[F][o]),F++;for(var G=Math.max.apply(Math,B),k=B[0],z=G;k<z;k++)if(_.indexOf(k)<0){var W=n.frameData(e[0]);W[o]=k;var Q=_.lastIndexOf(k-1);_.splice(Q+1,0,k),e.splice(Q+1,0,W)}for(U=e.length,F=0;F<U;){if(e[F]&&e[F][o]){H=(V=e[F][o])+(a.rangeInterval-1),R=R||V,q=q?q>G?G:q:H>G?G:H,V>=R&&V<=q?e[F][o]=R===q?R.toString():R.toString()+"-"+q.toString():V>q&&V===q+1&&(q=(R=q+1)+(a.rangeInterval-1)>G?G:R+(a.rangeInterval-1),e[F][o]=R===q?R.toString():R.toString()+"-"+q.toString());for(var Y=Object.keys(e[F]),b=[],X=0,K=Y;X<K.length;X++){var Z=K[X];b.push(!!e[F][Z])}r=-1===b.indexOf(!1)&&Y.length===Object.keys(e[0]).length?e[F]:r}F++}for(var $=0,J=T=[n.rows,n.columns,n.values,n.filters];$<J.length;$++){var ee=J[$],te=new i.DataManager({json:ee}).executeLocal((new i.Query).where("name","equal",o))[0];te&&((te=te.properties?te.properties:te).type="Count")}for(var k=0,ie=n.formats.length;k<ie;k++)if(n.formats[k].name===o){n.formats.splice(k,1);break}}n.groupingFields=t.extend(n.groupingFields,l)}(o[a]);if("object"==typeof l)return l.value}return this.fields=Object.keys(r),r},e.prototype.frameData=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=void 0,i++;return r},e.prototype.getRange=function(e,t){var i;if("Date"===e.type){var r=new Date(t),n="string"==typeof e.startingAt?new Date(e.startingAt):e.startingAt,a="string"==typeof e.endingAt?new Date(e.endingAt):e.endingAt;i=!!(n&&r.getTime()<n.getTime()||a&&r.getTime()>a.getTime())}else{var o="string"==typeof e.startingAt?parseInt(e.startingAt,10):e.startingAt,l="string"==typeof e.endingAt?parseInt(e.endingAt,10):e.endingAt;i=!!(o&&t<o||l&&t>l)}return i},e.prototype.getFormattedFields=function(e){for(var t=this.formats.length;t--;)this.formatFields[this.formats[t].name]=this.formats[t],this.formats[t].type&&(this.dateFormatFunction[this.formats[t].name]={exactFormat:this.globalize.getDateFormat(this.formats[t]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:this.formats[t].type})})},e.prototype.getFieldList=function(e,i,r){var n,a=this.fields,o=t.extend([],this.rows,null,!0);o=o.concat(this.columns,this.values,this.filters),this.getFormattedFields(o),this.getCalculatedField(a),a=this.fields;var l=this.excludeFields.length;for(l-=1;l>-1;){var s=this.fields.indexOf(this.excludeFields[l]);this.fields.splice(s,1),this.fieldList&&delete this.fieldList[this.excludeFields[l]],l--}var d=a.length;if(this.savedFieldList)for(this.fieldList=this.savedFieldList;d--;){p=a[d];this.fieldList[p]?(this.fieldList[p].isSelected=!1,this.fieldList[p].index=d,this.fieldList[p].filter=[],this.fieldList[p].isExcelFilter=!1,this.fieldList[p].filterType="",this.isValueFiltersAvail&&r&&(this.fieldList[p].dateMember=[],this.fieldList[p].formattedMembers={},this.fieldList[p].members={})):this.fieldList[p]={id:p,caption:p,type:void 0===n||"undefined"===n?"number":n,filterType:"",index:d,filter:[],sort:i?"Ascending":"None",isSelected:!1}}else for(;d--;){var p=a[d];n=this.fieldsType&&this.fieldsType[p]?this.fieldsType[p]:u.getType(e[p]),this.fieldList||(this.fieldList={}),this.fieldList[p]={id:p,caption:p,type:void 0===n||"undefined"===n?"number":n,filterType:"",index:d,filter:[],sort:i?"Ascending":"None",isSelected:!1}}this.updateTreeViewData(o)},e.prototype.updateFieldList=function(e){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter},e.prototype.updateTreeViewData=function(e){for(var t=e.length,i=this.calculatedFieldSettings.length;t--;)if(this.fieldList[e[t].name]){var r=this.fieldList[e[t].name];r.caption=e[t].caption?e[t].caption:e[t].name,r.isSelected=!0,r.showNoDataItems=e[t].showNoDataItems,r.aggregateType=e[t].type,r.baseField=e[t].baseField,r.baseItem=e[t].baseItem}for(;i--;)this.fieldList[this.calculatedFieldSettings[i].name].aggregateType="CalculatedField",this.fieldList[this.calculatedFieldSettings[i].name].formula=this.calculatedFieldSettings[i].formula},e.prototype.getCalculatedField=function(e){for(var i=0,r=this.calculatedFieldSettings;i<r.length;i++){var n=r[i];this.calculatedFields[n.name]=t.extend({},n,null,!0),this.calculatedFields[n.name].actualFormula=n.formula}for(var a=Object.keys(this.calculatedFields),o=this,l=0,s=a.length;l<s;l++)!function(t,i){var r=o.calculatedFields[a[t]],n=r.properties,l=(n?n.formula:r.formula).replace(/ +/g,""),s=l.replace(/"/g,"");r.formula=s.indexOf("^")>-1?o.powerFunction(s):s,r.name=n?n.name:r.name,(e=e.filter(function(e){return e!==r.name})).push(r.name);for(var d=l.split('"'),p=0,h=d.length;p<h;p++){var c=d[p],u=c.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n\/\\]+/),g="DistinctCount"===u[0]?"DistinctCount":"PopulationStDev"===u[0]?"PopulationStDev":"SampleStDev"===u[0]?"SampleStDev":"PopulationVar"===u[0]?"PopulationVar":"SampleVar"===u[0]?"SampleVar":u[0];if(-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(g)){var m=e.indexOf(u[1]);o.calculatedFormulas[r.name]?o.calculatedFormulas[r.name].push({index:m,type:g,formula:c}):o.calculatedFormulas[r.name]=[{index:m,type:g,formula:c}]}}}(l);this.fields=e},e.prototype.validateFilters=function(e){this.isValueFiltersAvail=!1;var i=e.filterSettings?e.filterSettings:[],r=t.extend([],this.rows,null,!0);r=r.concat(this.columns);for(var n=0,a=i;n<a.length;n++){for(var o=a[n],l=0,s=r;l<s.length;l++){var d=s[l];if(o.name===d.name&&"Value"===o.type){this.isValueFiltersAvail=!0;break}}if(this.isValueFiltersAvail)break}},e.prototype.fillFieldMembers=function(e,t){for(var i=this.fields,r=e.length,n=this.fieldList,a=i.length,o=0;o<a;o++){var l=i[o];n[l].members||(n[l].members={}),n[l].formattedMembers||(n[l].formattedMembers={}),n[l].dateMember||(n[l].dateMember=[]);for(var s=n[l].members,d=Object.keys(s).length>0,p=n[l].formattedMembers,h=n[l].dateMember,c=0,u=0,g=0;g<r;g++){var m=e[g][l];if(!d){var v=m,f=!this.pageSettings||this.formatFields[l]&&["date","dateTime","time"].indexOf(this.formatFields[l].type)>-1?this.getFormattedValue(m,l):{formattedText:null===m?this.localeObj?this.localeObj.getConstant("null"):String(m):void 0===m?this.localeObj?l in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(m):m.toString(),actualText:null===m?this.localeObj?this.localeObj.getConstant("null"):String(m):void 0===m?this.localeObj?l in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(m):m};f.formattedText&&(v=f.formattedText),s.hasOwnProperty(m)?s[m].index.push(g):(c++,s[m]={index:[g],ordinal:c,isDrilled:!!this.isExpandAll},h.push({formattedText:f.formattedText,actualText:f.dateText?f.dateText:f.actualText})),p.hasOwnProperty(v)?p[v].index.push(g):(u++,p[v]={index:[g],ordinal:u,isDrilled:!!this.isExpandAll})}t[g]?t[g][o]=s[m].ordinal:(t[g]=[],t[g][o]=s[m].ordinal)}}},e.prototype.generateValueMatrix=function(e){for(var t=this.fields,i=e.length,r=[],n=t.length,a=this.fieldList;i--;){e[i];var o=n;for(r[i]=[];o--;){var l=t[o];r[i][o]="number"===a[l].type?e[i][l]:1}}return r},e.prototype.updateSortSettings=function(e,t){for(var i=0,r=e?e.length:0;i<r&&t;i++)this.fieldList[e[i].name]&&(this.fieldList[e[i].name].sort=e[i].order)},e.prototype.updateFilterMembers=function(e){var t=this.filterMembers,i={},r=this.getFilters(e,i),n=this.indexMatrix.length;if(r)for(var a=i.include.index,o=0;o<a.length;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[a[o]]||t.push(a[o]);else for(o=0;o<n;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[o]||t.push(o)},e.prototype.getFilters=function(e,t){for(var i=e.filterSettings?e.filterSettings:[],r=(this.filters,!1),n=[],a=0,o=i.length;a<o;a++){var l=i[a].properties?i[a].properties:i[a];this.fieldList[l.name]&&this.fieldList[l.name].isSelected&&this.isValidFilterField(l,e.allowLabelFilter)&&(this.applyLabelFilter(l),l&&(n=l.items),l.type&&"Include"===l.type?(this.frameFilterList(n,l.name,t,"include",l.showLabelFilter,r),r=!0):this.frameFilterList(n,l.name,t,"exclude",l.showLabelFilter),l.showLabelFilter&&(l.items=[],l.type=l.showDateFilter?"Date":l.showNumberFilter?"Number":"Label"))}return r},e.prototype.isValidFilterField=function(e,i){var r=!1,n=["Include","Exclude"],a=t.extend([],this.rows,null,!0);if(a=a.concat(this.columns),this.fieldList[e.name].isSelected&&n.indexOf(e.type)>=0){for(var o=!1,l=0,s=this.values;l<s.length;l++){h=s[l];if(e.name===h.name){o=!0;break}}o||(r=!0)}else for(var d=0,p=a;d<p.length;d++){var h=p[d];if(e.name===h.name&&i&&["Label","Date","Number"].indexOf(e.type)>=0){r=!0;break}}return r},e.prototype.applyLabelFilter=function(e){if(["Label","Date","Number"].indexOf(e.type)>=0){var t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type){e.showDateFilter=!0;var i="string"==typeof e.value1?new Date(e.value1):e.value1,r="string"==typeof e.value2?new Date(e.value2):e.value2;e.items=this.getDateFilterMembers(t,e.name,e.condition,i,r)}else{e.showNumberFilter=!0,e.items=[];for(var n=0,a=t;n<a.length;n++){var o=a[n],l=this.getParsedValue(e.name,e.value1),s=this.getParsedValue(e.name,e.value2),d=this.getParsedValue(e.name,o);this.validateFilterValue(d,e.condition,l,s)&&e.items.push(o)}}var p=["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"];e.type=e.condition?p.indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include":"Exclude"}else e.showLabelFilter=!1},e.prototype.getLabelFilterMembers=function(e,t,i,r){for(var n=[],a=0,o=e;a<o.length;a++){var l=o[a],s=l.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":s===i.toLowerCase()&&n.push(l);break;case"BeginWith":case"DoesNotBeginWith":0===s.indexOf(i.toLowerCase())&&n.push(l);break;case"EndsWith":case"DoesNotEndsWith":null!==s.match(i.toLowerCase()+"$")&&n.push(l);break;case"Contains":case"DoesNotContains":s.indexOf(i.toLowerCase())>-1&&n.push(l);break;case"GreaterThan":s>i.toLowerCase()&&n.push(l);break;case"GreaterThanOrEqualTo":s>=i.toLowerCase()&&n.push(l);break;case"LessThan":s<i.toLowerCase()&&n.push(l);break;case"LessThanOrEqualTo":s<=i.toLowerCase()&&n.push(l);break;case"Between":case"NotBetween":s>=i.toLowerCase()&&s<=r.toLowerCase()&&n.push(l);break;default:s===i.toLowerCase()&&n.push(l)}}return n},e.prototype.getDateFilterMembers=function(e,t,i,r,n){for(var a=[],o=0,l=e;o<l.length;o++){var s=l[o],d=new Date(s);if(r)switch(i){case"Equals":case"DoesNotEquals":this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(r.toString(),t).formattedText&&a.push(this.getFormattedValue(s,t).formattedText);break;case"After":d.getTime()>r.getTime()&&a.push(this.getFormattedValue(s,t).formattedText);break;case"AfterOrEqualTo":d.getTime()>=r.getTime()&&a.push(this.getFormattedValue(s,t).formattedText);break;case"Before":d.getTime()<r.getTime()&&a.push(this.getFormattedValue(s,t).formattedText);break;case"BeforeOrEqualTo":d.getTime()<=r.getTime()&&a.push(this.getFormattedValue(s,t).formattedText);break;case"Between":case"NotBetween":d.getTime()>=r.getTime()&&d.getTime()<=n.getTime()&&a.push(this.getFormattedValue(s,t).formattedText);break;default:this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(r.toString(),t).formattedText&&a.push(this.getFormattedValue(s,t).formattedText)}}return a},e.prototype.validateFilterValue=function(e,t,i,r){var n=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(n=!0);break;case"DoesNotEquals":e!==i&&(n=!0);break;case"GreaterThan":e>i&&(n=!0);break;case"GreaterThanOrEqualTo":e>=i&&(n=!0);break;case"LessThan":e<i&&(n=!0);break;case"LessThanOrEqualTo":e<=i&&(n=!0);break;case"Between":e>=i&&e<=r&&(n=!0);break;case"NotBetween":e>=i&&e<=r||(n=!0);break;default:e!==i&&(n=!0)}return n},e.prototype.frameFilterList=function(e,t,i,r,n,a){i[r]?this.updateFilter(e,t,i,r,n,a):(i[r]={indexObject:{},index:[]},this.updateFilter(e,t,i,r,n,a))},e.prototype.updateFilter=function(e,t,i,r,n,a){var o=0,l=this.fieldList[t];l.filter=e,l.filterType=r,l.isExcelFilter=n;var s=this.formatFields[t]&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1?l.formattedMembers:l.members,d=a,p={},h={};for(p[r]={indexObject:{},index:[]},this.fieldFilterMem[t]={memberObj:{}};e[o];){var c=s[e[o]].index;if("include"===r)for(var u=0,g=c.length;u<g;u++)d&&void 0===i[r].indexObject[c[u]]||(p[r].indexObject[c[u]]=c[u],p[r].index.push(c[u]));else{for(var u=0,g=c.length;u<g;u++)void 0===i[r].indexObject[c[u]]&&(i[r].indexObject[c[u]]=c[u],i[r].index.push(c[u]));this.fieldFilterMem[t].memberObj[e[o]]=e[o]}o++}if("include"===r){i[r]=p[r];for(u=0;u<e.length;u++)h[e[u]]=e[u];for(var m=Object.keys(s),u=0,g=m.length;u<g;u++)void 0===h[m[u]]&&(this.fieldFilterMem[t].memberObj[m[u]]=m[u])}},e.prototype.applyValueFiltering=function(e,i,r,n,a,o,l){this.isValueFiltered=!1;var s=t.extend({},r[r.length-1],null,!0);return this.getFilteredData(r,n,a,o,i,e.name,s,l),this.isValueFiltered&&(o.push(s),r=o),r},e.prototype.getFilteredData=function(e,i,r,n,a,o,l,s){for(var d=e.length,p=0;p<d;p++)if(r[o])if(e[p].level===a){this.isValueFiltered=!0,this.fieldList[o].isExcelFilter=!0;var h=0,c=r[o].measure,u=this.fieldList[c].index,g=this.fieldList[c].aggregateType;this.rawIndexObject={},h="row"===s?this.getAggregateValue(e[p].index,i.indexObject,u,g):this.getAggregateValue(i.index,e[p].indexObject,u,g);var m={fieldName:c,row:e[p],column:i,value:h,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[p].hasChild&&e[p].isDrilled?"subTotal":"grand sum"===e[p].type?"grandTotal":"value",columnCellType:i.hasChild&&i.isDrilled?"subTotal":"grand sum"===i.type?"grandTotal":"value",aggregateType:g,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(m),h=m.value,this.rawIndexObject={};var v=this.getParsedValue(c,r[o].value1),f=this.getParsedValue(c,r[o].value2);if(this.validateFilterValue(h,r[o].condition,v,f)||"grand sum"===e[p].type)"grand sum"!==e[p].type&&(n.push(t.extend({},e[p],null,!0)),n[n.length-1].isLevelFiltered=!0);else{var y=this.removefilteredData(e[p],this.valueFilteredData),S=y||e[p];this.validateFilteredParentData(S,this.valueFilteredData,l,0,a,s)}}else e[p].hasChild&&e[p].members.length>0&&"grand sum"!==e[p].type&&(n.push(t.extend({},e[p],null,!0)),n[n.length-1].members=[],n[n.length-1].isLevelFiltered=!0,this.getFilteredData(e[p].members,i,r,n[n.length-1].members,a,o,l,s))},e.prototype.getParsedValue=function(e,i){var r=i?i.toString():"";if(this.formatFields[e]&&i){var n=t.extend({},this.formatFields[e],null,!0);return delete n.name,this.globalize.parseNumber(r,n)}return this.globalize.parseNumber(r,{format:"N"})},e.prototype.removefilteredData=function(e,i){for(var r,n=t.extend([],i,null,!0),a=0;a<n.length;a++){if(e.isLevelFiltered&&e.axis===n[a].axis&&e.valueSort.levelName===n[a].valueSort.levelName&&e.actualText===n[a].actualText&&e.axis===n[a].axis&&e.level===n[a].level&&e.ordinal===n[a].ordinal){r=n[a],i.splice(a,1);break}i[a].hasChild&&i[a].members.length>0&&this.removefilteredData(e,i[a].members)}return r},e.prototype.validateFilteredParentData=function(e,t,i,r,n,a){if(t.length>0)for(var o=0,l=t;o<l.length;o++){var s=l[o];if(s.level===r){if("row"===a)for(var d=0,p=h=e.index;d<p.length;d++){y=p[d];i.index.indexOf(y)>=0&&i.index.splice(i.index.indexOf(y),1),e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==n&&s.index.indexOf(y)>=0&&s.index.splice(s.index.indexOf(y),1)}else for(var h=e.indexObject,c=0,u=Object.keys(h);c<u.length;c++){y=u[c];h.hasOwnProperty(y)&&(delete i.indexObject[y],e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==n&&delete s.indexObject[y])}s&&s.members.length>0&&s.members[0].level===r+1&&s.members[0].level!==n&&this.validateFilteredParentData(e,s.members,i,r+1,n,a)}}else if("row"===a)for(var g=0,m=h=e.index;g<m.length;g++){y=m[g];i.index.indexOf(y)>=0&&i.index.splice(i.index.indexOf(y),1)}else for(var h=e.indexObject,v=0,f=Object.keys(h);v<f.length;v++){var y=f[v];h.hasOwnProperty(y)&&delete i.indexObject[y]}},e.prototype.updateFramedHeaders=function(e,i,r,n,a){for(var o=0,l=e;o<l.length;o++){var s=l[o];this.isHeaderAvail=!1,(this.validateFilteredHeaders(s,r,a)||"grand sum"===s.type)&&("row"===a?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,n.push(t.extend({},s,null,!0)),n[n.length-1].members=[],s.hasChild&&s.isDrilled&&s.members.length>0&&this.updateFramedHeaders(s.members,i,r,n[n.length-1].members,a))}return this.filterFramedHeaders},e.prototype.validateFilteredHeaders=function(e,t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];if(!this.isHeaderAvail){if(e.actualText===a.actualText&&e.level===a.level&&e.valueSort.levelName===a.valueSort.levelName)return"row"===i?a.index.length>0?(this.isHeaderAvail=!0,e.index=a.index,!0):(this.isHeaderAvail=!1,e.index=a.index,!1):Object.keys(a.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=a.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=a.indexObject,!1);a.hasChild&&a.members.length>0&&"grand sum"!==a.type&&this.validateFilteredHeaders(e,a.members,i)}}return this.isHeaderAvail},e.prototype.isEmptyDataAvail=function(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0),0!==e.length&&0!==t.length||(this.isEmptyData=!0)},e.prototype.updateGridData=function(e){this.indexMatrix=[];for(var t=0,i=this.fields;t<i.length;t++){var r=i[t];this.fieldList[r].members={},this.fieldList[r].formattedMembers={},this.fieldList[r].dateMember=[]}this.fillFieldMembers(this.data,this.indexMatrix),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.cMembers=[],this.rMembers=[],this.updateFilterMembers(e),this.isEditing=!0,this.isDrillThrough=!0,this.generateGridData(e),this.isEditing=!1},e.prototype.generateGridData=function(e,i){this.fields;var r=e.columns?e.columns:[],n=this.data,a=e.rows?e.rows:[],o=e.filterSettings,l=e.values?e.values:[];this.removeCount=0,this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;var s=[],d=a[0]&&a[0].showNoDataItems||r[0]&&r[0].showNoDataItems,p=t.extend([],this.rows,null,!0);if(p=p.concat(this.columns,this.values,this.filters),d)for(h=0;h<this.indexMatrix.length;h++)s.push(h);for(var h=0;h<this.filterMembers.length;h++)this.filterPosObj[this.filterMembers[h]]=this.filterMembers[h];this.valueSortSettings.columnIndex=void 0;(new Date).getTime();this.frameDrillObject(),this.isValueFilterEnabled&&!this.isEditing||i||(this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==a.length&&(this.rMembers=this.getIndexedHeaders(a,n,0,a[0].showNoDataItems?s:this.filterMembers,"row","",this.allowValueFilter)),0!==r.length&&(this.cMembers=this.getIndexedHeaders(r,n,0,r[0].showNoDataItems?s:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:t.extend([],this.rMembers,null,!0),columnHeaders:t.extend([],this.cMembers,null,!0)}:{}),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];var c=[],u=[],g=[],m=[],v=this.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter&&!i){this.valueFilteredData=[];var f=this.saveDataHeaders.rowHeaders,y=this.saveDataHeaders.columnHeaders;if(o.length>0){for(var S={},b={},C=0,w=l;C<w.length;C++){var x=w[C];b[x.name]=x}for(var T=0,D=o;T<D.length;T++){var M=D[T];f=g.length>0?g:f,y=m.length>0?m:y,this.valueFilteredData=[];var O=M.properties?M.properties:M;if("Value"===O.type&&this.fieldList[M.name].isSelected){S[M.name]=M,O.items=[];for(var P=!1,L=a.length,E=r.length,F=0;F<L;F++)if(O.name===a[F].name&&b[O.measure]&&!P){P=!0,g=this.applyValueFiltering(a[F],F,f,y[y.length-1],S,this.valueFilteredData,"row");break}for(var k=0;k<E;k++)if(O.name===r[k].name&&b[O.measure]&&!P){P=!0,m=this.applyValueFiltering(r[k],k,y,f[f.length-1],S,this.valueFilteredData,"column");break}}}}g=g.length>0?g:f,m=m.length>0?m:y,this.isEmptyDataAvail(g,m);var A=t.extend({},this.fieldList,null,!0);this.indexMatrix=[];var N=this.data[0];this.getFieldList(N,this.enableSort,e.allowValueFilter),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.updateFilterMembers(e),this.rMembers=0!==a.length?this.getIndexedHeaders(a,n,0,a[0].showNoDataItems?s:this.filterMembers,"row",""):[],this.cMembers=0!==r.length?this.getIndexedHeaders(r,n,0,r[0].showNoDataItems?s:this.filterMembers,"column",""):[],this.insertAllMembersCommon(),this.updateFieldList(A),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,g,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,m,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}i||this.applyValueSorting(),this.pageSettings&&(i?(this.rMembers=i.rowHeaders,this.cMembers=i.columnHeaders,this.rowCount=i.rowHeadersCount,this.columnCount=i.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues()),this.getAggregatedHeaders(a,r,this.rMembers,this.cMembers,l),this.getHeaderData(this.cMembers,u,this.pivotValues,0,this.valueAxis?1:v),this.insertSubTotals(),this.getTableData(this.rMembers,c,u,0,this.pivotValues,v,this.rMembers[this.rMembers.length-1],this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(c,u,this.pivotValues),this.isEngineUpdated=!0;(new Date).getTime();this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.onDrill=function(e){this.frameDrillObject();var t=this.getHeadersInfo(e.fieldName,e.axis);this.performDrillOperation(t.headers,e,t.fields,t.position,0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount,"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers,this.updateEngine()},e.prototype.onSort=function(e){var t=this.getHeadersInfo(e.name,"");this.fieldList[e.name].sort=e.order,this.performSortOperation(t.headers,e,t,0),this.updateEngine()},e.prototype.onFilter=function(e,t){var i=this.getHeadersInfo(e.name,"");"Include"===e.type&&e.items.length===this.fieldList[e.name].dateMember.length?(this.fieldList[e.name].filter=[],this.fieldList[e.name].filterType=""):(this.fieldList[e.name].filter=e.items,this.fieldList[e.name].filterType=e.type);for(var r={},n=0,a=this.filterMembers;n<a.length;n++){var o=a[n];r[o]=o}this.filterMembers=[],this.fieldFilterMem={},this.updateFilterMembers(t);for(var l=this.filterMembers.filter(function(e){return void 0===r[e]}),s=0,d=e.items;s<d.length;s++)d[s];if(this.rows[0]&&this.rows[0].showNoDataItems||this.columns[0]&&this.columns[0].showNoDataItems){var p=[];this.filterPosObj={};for(h=0;h<l.length;h++)this.filterPosObj[l[h]]=l[h];for(var h=0;h<this.indexMatrix.length;h++)p.push(h);l=p}this.performFilterCommonUpdate(e,i,l),this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.updateEngine()},e.prototype.onAggregation=function(e){this.fieldList[e.name].aggregateType=e.type,this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.updateEngine()},e.prototype.onCalcOperation=function(e){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.getCalculatedField(this.fields),this.fieldList[e.name]?this.fieldList[e.name].formula=e.formula:(this.fieldList[e.name]={id:e.name,caption:e.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:e.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.values.length-1)*this.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.values.length-1)*this.values.length),this.updateEngine()},e.prototype.performDrillOperation=function(e,t,i,r,n){for(var a=0;a<e.length;){if(r===n){if(t.memberName===e[a].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).join(t.delimiter?t.delimiter:"**")){if("down"===t.action){e[a].isDrilled=!0,e[a].members=this.getIndexedHeaders(i,this.data,r+1,e[a].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter));var o=void 0;if("row"===t.axis)o=this.applyValueSorting(e[a].members,this.cMembers),e[a].members=o.rMembers;else{var l=this.showSubTotals&&this.showColumnSubTotals&&i[r].showSubTotals;this.columnCount-=l?0:this.colValuesLength,o=this.applyValueSorting(this.rMembers,e[a].members),e[a].members=o.cMembers}}else e[a].isDrilled=!1,this.updateHeadersCount(e[a].members,t.axis,r,i,"minus",!0),e[a].members=[];break}}else e[a].members.length>0&&(e[a].members=this.performDrillOperation(e[a].members,t,i,r,n+1));a++}return e},e.prototype.performSortOperation=function(e,t,i,r){for(var n=0;n<e.length;){if(i.position===r){e=this.getSortedHeaders(e,t.order.toString());break}e[n].members.length>0&&(e[n].members=this.performSortOperation(e[n].members,t,i,r+1)),n++}return e},e.prototype.performFilterDeletion=function(e,t,i,r,n){for(var a=0,o=!0,l=this;a<e.length&&o;)!function(){if(i.position===n){var s=l;e=e.filter(function(e){return!s.fieldFilterMem[t.name].memberObj[e.formattedText]||"grand sum"===e.type}),o=!1}else e[a].members.length>0&&(e[a].members=l.performFilterDeletion(e[a].members,t,i,r,n+1));a++}();var s=this;return e.filter(function(e){return e.members.length>0?e.members.length>0:s.matchIndexes(e.indexObject,r)})},e.prototype.matchIndexes=function(e,t){var i=Object.keys(e),r=i.length;if(0===r)return!0;for(;r>-1;){if(void 0!==t[e[i[r]]])return!0;r--}return!1},e.prototype.performFilterAddition=function(e,t,i){for(var r=0,n=this;r<e.length;)!function(){var a=e[r].valueSort.levelName;if(n.headerObjectsCollection[a]){for(var o={},l=0,s=e[r].members;l<s.length;l++){var d=s[l];o[d.valueSort.levelName.toString()]=d.valueSort.levelName.toString()}var p=n.headerObjectsCollection[a].filter(function(e){return!o[e.valueSort.levelName.toString()]});e[r].members=e[r].members.concat(p),e[r].members=n.getSortedHeaders(e[r].members,n.fieldList[i.fields[e[r].members[0].level].name].sort),delete n.headerObjectsCollection[a]}e[r].members.length>0&&(e[r].members=n.performFilterAddition(e[r].members,t,i)),r++}();return e},e.prototype.performFilterCommonUpdate=function(e,t,i){for(var r="row"===t.axis?this.rMembers:this.cMembers,n={},a=0,o=this.filterMembers;a<o.length;a++){var l=o[a];n[l]=l}if(this.fieldFilterMem[e.name]&&(r=this.performFilterDeletion(t.headers,e,t,n,0)),i.length>0){this.frameHeaderObjectsCollection=!0,t.fields.filter(function(e){return e.showNoDataItems}).length>0&&(i=this.data.map(function(e,t){return t})),this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,"");for(var s={},d=0,p=r=this.performFilterAddition(r,t.fields,t);d<p.length;d++){var h=p[d];s[h.valueSort.levelName.toString()]=h.valueSort.levelName.toString()}var c=this.headerObjectsCollection.parent.filter(function(e){return!s[e.valueSort.levelName.toString()]}),u=r.filter(function(e){return"grand sum"===e.type});u.length>0&&r.pop(),r=this.getSortedHeaders(r.concat(c),this.fieldList[t.fields[0].name].sort).concat(u)}"row"===t.axis?this.rowCount=0:this.columnCount=0,this.updateHeadersCount(r,t.axis,0,t.fields,"plus",!1),"row"===t.axis?(t.position>0&&this.insertPosition(this.rows,this.data,0,this.filterMembers,"row","",r),this.insertTotalPosition(r),this.rMembers=this.headerCollection.rowHeaders=r,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.columns,this.data,0,this.filterMembers,"column","",r),this.insertTotalPosition(r),this.cMembers=this.headerCollection.columnHeaders=r,this.headerCollection.columnHeadersCount=this.columnCount),this.applyValueSorting()},e.prototype.getHeadersInfo=function(e,t){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders;for(var i="row"===(t=""===t?this.getAxisByFieldName(e):t)?this.rMembers:this.cMembers,r="row"===t?this.rows:this.columns,n=0,a=0,o=r;a<o.length&&o[a].name!==e;a++)n++;return{axis:t,fields:r,headers:i,position:n}},e.prototype.updateEngine=function(){this.removeCount=0,this.calculatePagingValues(),this.pivotValues=[],this.headerContent=[],this.valueContent=[];var e=[],t=[],i=this.values.length;this.getAggregatedHeaders(this.rows,this.columns,this.rMembers,this.cMembers,this.values),this.getHeaderData(this.cMembers,t,this.pivotValues,0,this.valueAxis?1:i),this.insertSubTotals(),this.getTableData(this.rMembers,e,t,0,this.pivotValues,i,this.rMembers[this.rMembers.length-1],this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(e,t,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.getAxisByFieldName=function(e){for(var t=0,i="";t<4&&""===i;){switch(t){case 0:i=this.getFieldByName(e,this.rows)?"row":"";break;case 1:i=this.getFieldByName(e,this.columns)?"column":""}t++}return i},e.prototype.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.updateHeadersCount=function(e,t,i,r,n,a){var o=0,l=r[i],s=!0;for(s="column"===t?this.showSubTotals&&this.showColumnSubTotals&&l.showSubTotals:this.showSubTotals&&this.showRowSubTotals&&l.showSubTotals;o<e.length;)"row"===t?this.rowCount=this.rowCount-("plus"===n?-(1===this.valueAxis?this.values.length:1):1===this.valueAxis?this.values.length:1):this.columnCount=this.columnCount-("plus"===n?-(1===this.valueAxis?1:this.values.length):1===this.valueAxis?1:this.values.length),e[o].members.length>0&&this.updateHeadersCount(e[o].members,t,i+1,r,n,!0),o++;"column"===t&&!s&&a&&(this.columnCount+="plus"===n?-this.colValuesLength:this.colValuesLength)},e.prototype.frameHeaderWithKeys=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=e[t[i]],i++;return r},e.prototype.getSortedHeaders=function(e,t){return!(this.formatFields&&this.formatFields[e[0].valueSort.axis]&&this.formatFields[e[0].valueSort.axis].type)?"Ascending"===t?e.sort(function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0}):"Descending"===t?e.sort(function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0}):e:"Ascending"===t?e.sort(function(e,t){return e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0}):"Descending"===t?e.sort(function(e,t){return e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0}):e},e.prototype.applyValueSorting=function(e,t){var i=!1;if(void 0!==e&&void 0!==t||(e=this.rMembers,t=this.cMembers,i=!0),this.enableValueSorting&&this.valueSortSettings.headerText&&""!==this.valueSortSettings.headerText&&this.values.length>0){for(var r=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),n="",a=void 0,o=void 0,l=void 0,s=0;s<this.values.length;s++){if(this.values[s].caption===r[r.length-1]){l=this.values[s].name;break}l=r[r.length-1]}if((1===this.values.length&&0===this.columns.length||this.values.length>1)&&l&&this.fieldList[l]){for(s=0;s<r.length-1;s++)n=""===n?r[s]:n+this.valueSortSettings.headerDelimiter+r[s];a=this.fieldList[l].index,o=this.fieldList[l].aggregateType}else{if(this.alwaysShowValueHeader&&1!==r.length)for(s=0;s<r.length-1;s++)n=""===n?r[s]:n+this.valueSortSettings.headerDelimiter+r[s];else n=this.valueSortSettings.headerText;a=this.fieldList[this.values[0].name].index,o=this.fieldList[this.values[0].name].aggregateType}var d=void 0;0===this.valueAxis?(d=this.getMember(t,n))&&(e=this.sortByValueRow(e,d,this.valueSortSettings.sortOrder,a,o)):(d=this.getMember(e,n))&&(t=this.sortByValueRow(t,d,this.valueSortSettings.sortOrder,a,o)),i&&(this.rMembers=e,this.cMembers=t,this.pageSettings&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:e,cMembers:t}},e.prototype.getMember=function(e,t){for(var i,r=e.length,n=0;n<r;n++){if(e[n].valueSort.levelName===t){i=e[n];break}if(e[n].members.length>0&&(i=this.getMember(e[n].members,t)),i)return i}return i},e.prototype.sortByValueRow=function(e,t,i,r,n){for(var a=[],o=0,l=e;o<l.length;o++)if("grand sum"===(c=l[o]).type)a.push({header:c});else{this.rawIndexObject={};var s=this.getAggregateValue(c.index,t.indexObject,r,n),d={fieldName:this.fields[r],row:c,column:t,value:s,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:c.hasChild&&c.isDrilled?"subTotal":"grand sum"===c.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:n,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(d),s=d.value,this.rawIndexObject={},a.push({header:c,value:s})}a.sort(function(e,t){return"Descending"===i?(t.value||"grand sum"===t.header.type?t.value:0)-(e.value||"grand sum"===e.header.type?e.value:0):(e.value||"grand sum"===e.header.type?e.value:0)-(t.value||"grand sum"===t.header.type?t.value:0)});for(var p=0,h=e=a.map(function(e){return e.header});p<h.length;p++){var c=h[p];c.members.length>0&&(c.members=this.sortByValueRow(c.members,t,i,r,n))}return e},e.prototype.insertAllMembersCommon=function(){(!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0))&&this.insertAllMember(this.rMembers,this.filterMembers,"","row"),(!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0))&&this.insertAllMember(this.cMembers,this.filterMembers,"","column")},e.prototype.insertSubTotals=function(){for(var e=this.pivotValues.length,i=0;i<e;i++){var r=this.pivotValues[i];if(r)for(var n=void 0,a=1,o=void 0,l=r.length-1;l>0;l--){var s=r[l];if(s){n&&(n.colSpan=a,n.colIndex=n.colIndex-(a-1)),o={index:s.index,indexObject:s.indexObject},s.index=[],s.indexObject={},n=t.extend({},s,null,!0),s.index=o.index,s.indexObject=o.indexObject;for(var d=i+1;this.pivotValues[d]&&!this.pivotValues[d][l];){this.pivotValues[i][l].isDrilled||(this.pivotValues[i][l].rowSpan=d-i+1,n.rowSpan=d-i+1);var p="sum"===s.type||"grand sum"===s.type?s.type:"sum";this.pivotValues[d][l]=this.headerContent[d][l]={type:p,formattedText:"sum"===s.type||"grand sum"===s.type?s.formattedText:s.formattedText+" Total",axis:"column",level:-1,colIndex:l,rowIndex:d,valueSort:s.valueSort},s.valueSort&&s.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=l);var h=!1;"grand sum"===p?(this.pivotValues[i][l].rowSpan=d-i+1,n.rowSpan=d-i+1):"sum"!==this.pivotValues[i][l].type&&this.pivotValues[i][l].isDrilled?(this.pivotValues[i+1][l].rowSpan=d-i,h=!0):this.pivotValues[d][l].rowSpan=-1,d>i+1&&("sum"===this.pivotValues[i][l].type||h)&&(this.pivotValues[d][l].rowSpan=-1),d++}a=1}else r[l]=this.headerContent[i][l]=t.extend({},n,null,!0),r[l].index=this.headerContent[i][l].index=o.index,r[l].indexObject=this.headerContent[i][l].indexObject=o.indexObject,a++,r[l].colSpan=a,r[l].colIndex=r[l].colIndex-(a-1);1===l&&n&&(n.colSpan=a,n.colIndex=n.colIndex-(a-1))}}},e.prototype.frameDrillObject=function(){this.fieldDrillCollection={};for(var e=0;e<this.drilledMembers.length;e++)for(var t=this.drilledMembers[e],i=0;i<t.items.length;i++){var r=t.name+this.valueSortSettings.headerDelimiter+t.items[i].split(t.delimiter).join(this.valueSortSettings.headerDelimiter);this.fieldDrillCollection[r]=r}},e.prototype.getIndexedHeaders=function(e,i,r,n,a,o,l){var s=[];if(e){var d=e.length,p={},h=e[r].name,c=e[r],u=this.fieldList[h],g=!1,m=this.formatFields[h]&&["date","dateTime","time"].indexOf(this.formatFields[h].type)>-1,v=n.length<1&&r>0||c.showNoDataItems,f={};if(v){for(var y=Object.keys(u.members),S=0,b=y.length;S<b;S++)f[y[S]]=y[S];n.length<1&&(g=!0,n.length=y.length)}for(var S=0,b=n.length;S<b;S++){var C={};t.isNullOrUndefined(e[r].showSubTotals)||e[r].showSubTotals||(C.showSubTotals=!1),C.hasChild=r<d-1,C.level=r,C.axis=a,C.colSpan=1;var w=g?u.members[Object.keys(f)[0]].ordinal:this.indexMatrix[n[S]][u.index],x=g?Object.keys(f)[0]:i[n[S]][h];if(delete f[x],!v||!this.fieldFilterMem[h]||this.fieldFilterMem[h].memberObj[x]!==x){var T=m?{actualText:x,formattedText:u.dateMember[w-1].formattedText,dateText:u.dateMember[w-1].actualText}:{formattedText:null===x?this.localeObj?this.localeObj.getConstant("null"):String(x):void 0===x&&this.localeObj?h in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(x),actualText:null===x?this.localeObj?this.localeObj.getConstant("null"):String(x):void 0===x?this.localeObj?h in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(x):x};C.actualText=T.actualText,C.formattedText=T.formattedText,m&&(C.dateText=T.dateText);var D=!v||void 0!==this.filterPosObj[n[S]]&&!g;if(p&&p[w])D&&(p[w].index.push(n[S]),p[w].indexObject[n[S]]=n[S]);else{p[w]={index:[],indexObject:{}},C.index=p[w].index,C.indexObject=p[w].indexObject,D&&(C.index=p[w].index=[n[S]],p[w].indexObject[n[S]]=n[S],C.indexObject=p[w].indexObject),C.ordinal=w,C.valueSort={},C.valueSort.axis=h,0!==r?(C.valueSort.levelName=o+this.valueSortSettings.headerDelimiter+C.formattedText,C.valueSort[o+this.valueSortSettings.headerDelimiter+C.formattedText]=1):(C.valueSort[C.formattedText]=1,C.valueSort.levelName=C.formattedText);var M=C.valueSort.axis+this.valueSortSettings.headerDelimiter+C.valueSort.levelName;C.isDrilled=!(!l||!this.isValueFiltersAvail)||(C.hasChild&&this.fieldDrillCollection[M]?!this.isExpandAll:u.members[x].isDrilled),C.members=[],s.push(C)}v&&!g&&r>0&&S+1===n.length&&Object.keys(f).length>0&&(g=!0,b=Object.keys(f).length,S=-1)}}for(var O=0,P=s.length;O<P;O++){this.frameHeaderObjectsCollection||("row"===a?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength);var L=null;if(s[O].valueSort&&s[O].valueSort.levelName&&(L=s[O].valueSort.levelName),o=L||s[O].formattedText,d-1>r&&s[O].isDrilled){this.columnCount-=this.showSubTotals&&this.showColumnSubTotals&&c.showSubTotals||"column"!==a?0:this.colValuesLength;var E=s[O].index;s[O].members=this.getIndexedHeaders(e,i,r+1,void 0===E?[]:E,a,o),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[o]=s[O].members)}}return this.enableSort?m?"Ascending"===u.sort?s.sort(function(e,t){return e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0}):"Descending"===u.sort?s.sort(function(e,t){return e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0}):s:"Ascending"===u.sort?s.sort(function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0}):"Descending"===u.sort?s.sort(function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0}):s:s}return s},e.prototype.getOrderedIndex=function(e){for(var t={},i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t},e.prototype.insertPosition=function(e,t,i,r,n,a,o){var l=[],s=this.getOrderedIndex(o);if(e){for(var d={},p=e[i].name,h=this.fieldList[p],c=0,u=r.length;c<u;c++){var g={},m=this.indexMatrix[r[c]][h.index],v=o[s[m]],f=this.formatFields[p]&&["date","dateTime","time"].indexOf(this.formatFields[p].type)>-1?this.getFormattedValue(t[r[c]][p],p):{formattedText:t[r[c]][p].toString(),actualText:t[r[c]][p].toString()};v&&v.formattedText===f.formattedText&&(d&&d[m]?(d[m].index.push(r[c]),d[m].indexObject[r[c]]=r[c]):(d[m]={index:[],indexObject:{}},v.index=d[m].index=[r[c]],d[m].indexObject[r[c]]=r[c],v.indexObject=d[m].indexObject,v.valueSort={},v.valueSort.axis=p,0!==i?(v.valueSort.levelName=a+this.valueSortSettings.headerDelimiter+v.formattedText,v.valueSort[a+this.valueSortSettings.headerDelimiter+v.formattedText]=1):(v.valueSort[v.formattedText]=1,v.valueSort.levelName=v.formattedText),g.members=[],l.push(g)))}for(var y=o.length-l.length;y>0;)l.push({members:[]}),y--;for(var S=0,b=l.length;S<b;S++)if(o[S].members.length>0){var C=null;o[S].valueSort&&o[S].valueSort.levelName&&(C=o[S].valueSort.levelName),a=C||o[S].formattedText,l[S].members=this.insertPosition(e,t,i+1,o[S].index,n,a,o[S].members)}return l}return l},e.prototype.insertTotalPosition=function(e){var t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers;for(var i=0,r=this.filterMembers.length;i<r;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i]}return e},e.prototype.calculatePagingValues=function(){if(this.pageSettings){1===this.valueAxis?this.rowValuesLength=this.values.length:this.colValuesLength=this.values.length,this.memberCnt=-this.rowValuesLength,this.rowStartPos=(this.pageSettings.rowCurrentPage*this.pageSettings.rowSize-this.pageSettings.rowSize)*this.rowValuesLength;var e=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength>this.rowCount?this.rowCount-3*this.pageSettings.rowSize*this.rowValuesLength:this.rowStartPos;e<0&&(e=this.rowStartPos=0,this.pageSettings.rowCurrentPage=1),this.rowFirstLvl=(this.rowStartPos-e)%this.pageSettings.rowSize,this.rowStartPos=e,this.endPos=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength,this.endPos=this.endPos>this.rowCount?this.rowCount:this.endPos,this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.columnCurrentPage*this.pageSettings.columnSize-this.pageSettings.columnSize)*this.colValuesLength,(e=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength>this.columnCount?this.columnCount-3*this.pageSettings.columnSize*this.colValuesLength:this.colStartPos)<0&&(e=this.colStartPos=0,this.pageSettings.columnCurrentPage=1),this.colFirstLvl=(this.colStartPos-e)%this.pageSettings.columnSize,this.colStartPos=e,this.endPos=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength,this.endPos=this.endPos>this.columnCount?this.columnCount:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column"),this.memberCnt=-1,this.pageInLimit=!1}},e.prototype.performSlicing=function(e,t,i,r){for(var n=0;e[n];){if(this.memberCnt+="column"===r?this.colValuesLength:this.rowValuesLength,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===r?this.colFirstLvl=this.colFirstLvl+e[n].level:this.rowFirstLvl=this.rowFirstLvl+e[n].level,this.pageInLimit=!0),this.pageInLimit&&this.endPos<=this.memberCnt){if("column"!==r)break;if(0===e[n].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[n].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(e[n].members.length>0?this.removeChildMembers(e[n]):e[n]),e[n].members.length>0&&("column"===r&&(this.memberCnt-=this.showSubTotals&&this.showColumnSubTotals&&this.columnKeys[e[n].valueSort.axis].showSubTotals?0:this.colValuesLength),t[t.length-1].members=this.performSlicing(e[n].members,[],i,r)),this.pageInLimit||t.pop(),0===e[n].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;n++}return t},e.prototype.removeChildMembers=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=e[t[i]],"members"===t[i]&&(r.members=[]),i++;return r},e.prototype.insertAllMember=function(e,t,i,r){var n=e.length;i=" Total",e[n]={hasChild:!1,index:t,level:0,axis:r,isDrilled:!1,indexObject:{},members:[],formattedText:"Grand"+i,ordinal:n,type:"grand sum",valueSort:{}},e[n].valueSort[e[n].formattedText]=1,e[n].valueSort.levelName=e[n].formattedText;for(var a=0,o=t.length;a<o;a++)e[n].indexObject[t[a]]=t[a];"row"===r?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength},e.prototype.getTableData=function(e,i,r,n,a,o,l,s){for(var d=e.length,p=0;p<d;p++){i[n=a.length]=e[p];var h=n-Number(Object.keys(i)[0]),c=!i[n].members.length;if(e[p].colIndex=0,e[p].rowIndex=n,a[n]?a[n][0]=this.valueContent[h][0]=this.frameHeaderWithKeys(e[p]):(a[n]=[],this.valueContent[h]={},a[n][0]=this.valueContent[h][0]=this.frameHeaderWithKeys(e[p])),this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&(!e[p].isDrilled||(t.isNullOrUndefined(e[p].showSubTotals)||e[p].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals)){for(var u=n,g=h,m=0;m<o;m++){n++,h++;var v=this.values[m].caption?this.values[m].caption:this.values[m].name,f={axis:"row",actualText:this.values[m].name,formattedText:v,level:0,valueSort:{},colIndex:0,rowIndex:n,type:"value"};a[n]||(a[n]=[],this.valueContent[h]={},a[n][0]=this.valueContent[h][0]=f);var y=a[n][0].valueSort;y[a[n-m-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+v]=1,y.levelName=a[n-m-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+v;for(var S=0,b=1,C=r.length;S<C;++S)this.updateRowData(e,r,n,a,m,p,S,b,h,l,s),b=a[n].length,a[u][b-1]=this.valueContent[g][b-1]={axis:"value",actualText:"",colSpan:1,colIndex:b,formattedText:"",hasChild:!1}}this.recursiveRowData(e,i,r,n,a,o,c,p,o,l,s)}else{for(var S=0,b=1,C=r.length;S<C;++S)for(m=0;m<o;m++)this.updateRowData(e,r,n,a,m,p,S,b,h,l,s),b=a[n].length;this.recursiveRowData(e,i,r,n,a,o,c,p,0,l,s)}}},e.prototype.getAggregatedHeaders=function(e,t,i,r,n){this.selectedHeaders={selectedHeader:[],values:[]};for(var a=n.length,o=0;o<a;o++)switch(n[o].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var l=void 0,s=void 0;this.selectedHeaders.values.push(n[o].name),n[o].baseField&&n[o].baseItem?(l=n[o].baseField,s=n[o].baseItem):this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?(l=t[0].name,s=Object.keys(this.fieldList[t[0].name].members)[0]):e.length>0&&(l=e[0].name,s=Object.keys(this.fieldList[e[0].name].members)[0]);for(var d=!1,p=0,h=e;p<h.length;p++)if(h[p].name===l){this.getAggregatedHeaderData(i,n[o].name,s,!1,"row",n[o].type,this.selectedHeaders.selectedHeader,o),d=!0;break}if(!d)for(var c=0,u=t;c<u.length;c++)if(u[c].name===l){this.getAggregatedHeaderData(r,n[o].name,s,!1,"column",n[o].type,this.selectedHeaders.selectedHeader,o);break}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(n[o].name),this.getAggregatedHeaderData("PercentageOfParentRowTotal"===n[o].type?i:r,n[o].name,void 0,!1,"PercentageOfParentRowTotal"===n[o].type?"row":"column",n[o].type,this.selectedHeaders.selectedHeader,o);break;case"RunningTotals":this.selectedHeaders.values.push(n[o].name),this.getAggregatedHeaderData(this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?r:i,n[o].name,void 0,!1,this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?"column":"row",n[o].type,this.selectedHeaders.selectedHeader,o);break;case"PercentageOfParentTotal":l=void 0;this.selectedHeaders.values.push(n[o].name),n[o].baseField?l=n[o].baseField:this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?l=t[0].name:e.length>0&&(l=e[0].name);for(var d=!1,g=e.length,m=0;m<g;m++)if(e[m].name===l){this.getAggregatedHeaderData(i,n[o].name,void 0,!1,"row",n[o].type,this.selectedHeaders.selectedHeader,o,m),d=!0;break}if(!d)for(var g=t.length,m=0;m<g;m++)if(t[m].name===l){this.getAggregatedHeaderData(r,n[o].name,void 0,!1,"column",n[o].type,this.selectedHeaders.selectedHeader,o,m);break}}},e.prototype.getAggregatedHeaderData=function(e,i,r,n,a,o,l,s,d){for(var p=0,h=e;p<h.length;p++){var c=h[p];switch(o){case"DifferenceFrom":case"PercentageOfDifferenceFrom":-1!==c.valueSort.levelName.toString().split(".").indexOf(r)?(l.push(this.updateSelectedHeaders(r,c.level,a,n,i,o,c.valueSort.levelName,n?[c]:e,s+1)),c.members.length>0&&this.getAggregatedHeaderData(c.members,i,r,!0,a,o,l[l.length-1].childMembers,s)):c.members.length>0&&this.getAggregatedHeaderData(c.members,i,r,!1,a,o,l,s);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===c.type?l.push(this.updateSelectedHeaders(void 0,c.level,a,!1,i,o,c.valueSort.levelName,e,s+1)):c.members.length>0&&(l.push(this.updateSelectedHeaders(void 0,c.level,a,!1,i,o,c.valueSort.levelName,c.members,s+1)),this.getAggregatedHeaderData(c.members,i,void 0,!1,a,o,l,s));break;case"PercentageOfParentTotal":if("grand sum"!==c.type)if(c.level===d)if(c.members.length>0){if(n)for(var u=l[l.length-1].aggregateHeaders,g=0,m=c.members;g<m.length;g++){var v=m[g];u.push(v)}else{var f=t.extend([],c.members,null,!0);l.push(this.updateSelectedHeaders(void 0,c.level,a,!1,i,o,c.valueSort.levelName,f,s+1)),(u=l[l.length-1].aggregateHeaders).push(c)}this.getAggregatedHeaderData(c.members,i,void 0,!0,a,o,l,s,d+1)}else n||l.push(this.updateSelectedHeaders(void 0,c.level,a,!1,i,o,c.valueSort.levelName,[c],s+1));else c.members.length>0&&this.getAggregatedHeaderData(c.members,i,void 0,!1,a,o,l,s,d)}}},e.prototype.updateSelectedHeaders=function(e,t,i,r,n,a,o,l,s){return{name:e,level:t,axis:i,isChild:r,value:n,type:a,uniqueName:o,aggregateHeaders:l,childMembers:[],valueCount:s}},e.prototype.applyAdvancedAggregate=function(e,t,i){if(this.selectedHeaders.values.length>0){for(var r={},n=[],a=!1,o=i.length,l=0;l<o;l++)if(void 0!==i[l]&&void 0!==i[l][0]){if(!a)for(var s=i[l].length,d=0;d<s;d++)"value"===i[l][d].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][d].actualText)&&(n.push(d),a=!0);if(n.length>0&&"value"===i[l][n[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][n[0]].actualText))for(var p=0,h=n;p<h.length;p++)r[l+","+(g=h[p])]=[l,g]}this.updateAggregates(e,t,i,this.selectedHeaders.selectedHeader,n,r);for(var c=0,u=Object.keys(r);c<u.length;c++){var g=u[c];i[r[g][0]][r[g][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A"}}},e.prototype.updateAggregates=function(e,t,i,r,n,a){for(var o=0,l=r;o<l.length;o++){var s=l[o],d=s.aggregateHeaders,p=s.value,h=this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?s.valueCount:0,c=s.type,u=s.uniqueName,g="row"===s.axis,m=void 0,v=[],f=[],y=[],S=[],b=[],C=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(s.type))if(g){if("RunningTotals"!==s.type)for(var w=e.length,x=0;x<w;x++)if(void 0!==e[x]&&e[x].valueSort[u]){m=e[x],b=i[x+h];break}}else{for(var T=i.length,D=0;D<T&&(void 0!==i[D]&&void 0===i[D][0]);D++)y.push(i[D]);for(var M=y.length;M--;){var O=(F=y[M][n[0]]).actualText;-1===this.selectedHeaders.values.indexOf(O)&&(f=y[M],M=0)}if("RunningTotals"!==s.type)for(var P=f.length,L=0;L<P;L++){de=!1;if(void 0!==f[L]&&f[L].valueSort[u]){m=f[L];for(var E=i.length,D=0;D<E;D++){var F=i[D];void 0!==F&&void 0!==F[0]&&"value"===F[L].axis&&-1!==this.selectedHeaders.values.indexOf(F[L].actualText)&&(de=!0,C[D]=F[L],S.push(D))}if(de)break}}}switch(s.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var k=s.isChild;if(g){if(k){for(var A=u.split("."),w=e.length,N=0;N<w;N++)if(void 0!==e[N]&&-1!==(z=e[N].valueSort.levelName.toString().split(".")).indexOf(A[A.length-1])&&e[N].level===m.level)for(var j=0,I=n;j<I.length;j++){fe=I[j];"value"===(xe=i[N+h][fe]).axis&&xe.actualText===p&&(v.push([N+h,fe]),a[N+h+","+fe]&&delete a[N+h+","+fe])}}else for(var R=0,q=d;R<q.length;R++)for(var V=q[R],w=e.length,x=0;x<w;x++)if(void 0!==e[x]&&e[x].valueSort[V.valueSort.levelName]&&e[x].level===m.level&&"grand sum"!==e[x].type)for(var H=0,B=n;H<B.length;H++){fe=B[H];"value"===(xe=i[x+h][fe]).axis&&xe.actualText===p&&(v.push([x+h,fe]),a[x+h+","+fe]&&delete a[x+h+","+fe])}for(var _=0,U=v;_<U.length;_++){ye=(xe=i[(fe=U[_])[0]][fe[1]]).value-b[fe[1]].value;ye=isNaN(ye)?0:ye,"DifferenceFrom"===c?xe.formattedText=0===ye?this.emptyCellTextContent:this.getFormattedValue(ye,p).formattedText:(ye=0===b[fe[1]].value?0:ye/b[fe[1]].value,xe.formattedText=0!==ye?this.globalize.formatNumber(ye,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent)}}else{if(k)for(var A=u.split("."),P=f.length,G=0;G<P;G++){de=!1;if(void 0!==f[G]){var z=f[G].valueSort.levelName.toString().split(".");if(-1!==z.indexOf(A[A.length-1])&&f[G].level===m.level){for(var W=0,Q=S;W<Q.length;W++)"value"===(xe=i[fe=Q[W]][G]).axis&&xe.actualText===p&&(de=!0,v.push([fe,G]),a[fe+","+G]&&delete a[fe+","+G]);if(de)break}}}else for(var Y=0,X=d;Y<X.length;Y++)for(var V=X[Y],P=f.length,L=0;L<P;L++){de=!1;if(void 0!==f[L]&&f[L].valueSort[V.valueSort.levelName]&&f[L].level===m.level&&"grand sum"!==f[L].type){for(var K=0,Z=S;K<Z.length;K++)"value"===(xe=i[fe=Z[K]][L]).axis&&xe.actualText===p&&(de=!0,v.push([fe,L]),a[fe+","+L]&&delete a[fe+","+L]);if(de)break}}for(var $=0,J=v;$<J.length;$++){ye=(xe=i[(fe=J[$])[0]][fe[1]]).value-C[fe[0]].value;ye=isNaN(ye)?0:ye,"DifferenceFrom"===c?xe.formattedText=0===ye?this.emptyCellTextContent:this.getFormattedValue(ye,p).formattedText:(ye=0===C[fe[0]].value?0:ye/C[fe[0]].value,xe.formattedText=0!==ye?this.globalize.formatNumber(ye,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent)}}s.childMembers.length>0&&this.updateAggregates(e,t,i,s.childMembers,n,a);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(g){for(var ee=0,te=d;ee<te.length;ee++)for(var V=te[ee],w=e.length,D=0;D<w;D++)if(void 0!==e[D]&&e[D].valueSort[V.valueSort.levelName]&&e[D].level===V.level)for(var ie=0,re=n;ie<re.length;ie++){fe=re[ie];"value"===(xe=i[D+h][fe]).axis&&xe.actualText===p&&(v.push([D+h,fe]),a[D+h+","+fe]&&delete a[D+h+","+fe])}for(var ne=0,ae=v;ne<ae.length;ne++){ye=(xe=i[(D=ae[ne])[0]][D[1]]).value/b[D[1]].value;ye=isNaN(ye)?0:ye,xe.formattedText=0!==ye?this.globalize.formatNumber(ye,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent}}else{for(var oe=0,le=d;oe<le.length;oe++)for(var V=le[oe],P=f.length,se=0;se<P;se++){var de=!1;if(void 0!==f[se]&&f[se].valueSort[V.valueSort.levelName]){for(var pe=0,he=S;pe<he.length;pe++)"value"===(xe=i[fe=he[pe]][se]).axis&&xe.actualText===p&&(de=!0,v.push([fe,se]),a[fe+","+se]&&delete a[fe+","+se]);if(de)break}}for(var ce=0,ue=v;ce<ue.length;ce++){var ge=(xe=i[(D=ue[ce])[0]][D[1]]).value/C[D[0]].value;ge=isNaN(ge)?0:ge,xe.formattedText=0!==ge?this.globalize.formatNumber(ge,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent}}break;case"RunningTotals":if(g){for(var me=0,ve=n;me<ve.length;me++)for(var fe=ve[me],ye=0,Se=0,be=d;Se<be.length;Se++)for(var V=be[Se],w=e.length,N=0;N<w;N++)if(void 0!==e[N]){xe=i[N+h][fe];if(void 0!==e[N]&&e[N].valueSort[V.valueSort.levelName]&&e[N].level===V.level&&"value"===xe.axis&&xe.actualText===p){"grand sum"!==e[N].type&&(ye+=xe.value,xe.formattedText=this.getFormattedValue(ye,p).formattedText),a[N+h+","+fe]&&delete a[N+h+","+fe];break}}}else for(var w=e.length,x=0;x<w;x++)if(void 0!==e[x])for(var ye=0,Ce=0,we=d;Ce<we.length;Ce++)for(var V=we[Ce],P=f.length,L=0;L<P;L++){var xe=i[x+h][L];if(void 0!==f[L]&&f[L].valueSort[V.valueSort.levelName]&&"value"===xe.axis&&xe.actualText===p){"grand sum"!==f[L].type&&(ye+=xe.value,xe.formattedText=this.getFormattedValue(ye,p).formattedText),a[x+h+","+L]&&delete a[x+h+","+L];break}}}}},e.prototype.recursiveRowData=function(e,t,i,r,n,a,o,l,s,d,p){o||this.getTableData(t[r-s].members,t,i,r,n,a,d,p),this.pageSettings||(t[r-s].members=[])},e.prototype.updateRowData=function(e,i,r,n,a,o,l,s,d,p,h){var c=this.fieldList[this.values[a].name].index,u=this.fieldList[this.values[a].name].aggregateType,g=this.values[a].name,m=[],v={},f=0;switch(u){case"Index":for(var y=["cVal","rTotalVal","cTotalVal","gTotalVal"],S=0,b=0,C=m=[[e[o],i[l]],[e[o],h],[p,i[l]],[p,h]];b<C.length;b++){T=C[b];v[y[S]]=this.getAggregateValue(T[0].index,T[1].indexObject,c,u),S++}D=v.cVal*v.gTotalVal/(v.rTotalVal*v.cTotalVal);f=!(e[o].members.length>0)||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showRowSubTotals&&this.showSubTotals?t.isNullOrUndefined(v.cVal)?v.cVal:isNaN(D)?0:D:void 0;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":(m=[[e[o],i[l]]]).push("PercentageOfGrandTotal"===u?[p,h]:"PercentageOfColumnTotal"===u?[p,i[l]]:[e[o],h]);for(var y=["cVal","gTotalVal"],S=0,w=0,x=m;w<x.length;w++){var T=x[w];v[y[S]]=this.getAggregateValue(T[0].index,T[1].indexObject,c,u),S++}var D=v.cVal/v.gTotalVal;f=!(e[o].members.length>0)||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?t.isNullOrUndefined(v.cVal)?v.cVal:isNaN(D)?0:D:void 0;break;default:f=!(e[o].members.length>0)||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?this.getAggregateValue(e[o].index,i[l].indexObject,c,u):void 0}var M={fieldName:this.values[a].name,row:e[o],column:i[l],value:f,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[o].hasChild&&e[o].isDrilled?"subTotal":"grand sum"===e[o].type?"grandTotal":"value",columnCellType:i[l].hasChild&&i[l].isDrilled?"subTotal":"grand sum"===i[l].type?"grandTotal":"value",aggregateType:u,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(M),f=M.value;var O=e[o].hasChild||i[l].hasChild||"grand sum"===e[o].type||"grand sum"===i[l].type,P=e[o].members.length>0&&(!t.isNullOrUndefined(e[o].showSubTotals)&&!e[o].showSubTotals||!this.showSubTotals||!this.showRowSubTotals),L=P?"":void 0===f?this.emptyCellTextContent:"Count"===u?f.toLocaleString():this.getFormattedValue(f,g).formattedText;!isNaN(f)&&!t.isNullOrUndefined(f)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(u)>=0?L=this.globalize.formatNumber(f,{format:"P",maximumFractionDigits:2}):P||!isNaN(f)||t.isNullOrUndefined(f)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(u)||(L="#DIV/0!"),L=M.skipFormatting?t.isNullOrUndefined(f)?this.emptyCellTextContent:f.toString():L,n[r][s]=this.valueContent[d][s]={axis:"value",actualText:g,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===e[o].type?"":e[o].valueSort.levelName,columnHeaders:"grand sum"===i[l].type?"":i[l].valueSort.levelName,formattedText:L,value:t.isNullOrUndefined(f)?0:f,rowIndex:r,colIndex:s,isSum:O},this.rawIndexObject={}},e.prototype.getCellSet=function(e){for(var t=[],i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];this.data[parseInt(n,10)]&&t.push(this.data[parseInt(n,10)])}return t},e.prototype.getHeaderData=function(e,i,r,n,a){for(var o=e.length,l=this.columns.length,s=this.valueSortSettings.headerText,d=0;d<o;d++){e[d].members.length&&this.getHeaderData(e[d].members,i,r,n,a);var p=!0;(t.isNullOrUndefined(e[d].showSubTotals)||e[d].showSubTotals)&&this.showSubTotals&&this.showColumnSubTotals?i[n=i.length]=this.frameHeaderWithKeys(e[d]):(e[d].members.length>0?(this.removeCount++,p=!1):i[i.length]=this.frameHeaderWithKeys(e[d]),n=i.length-1);var h=e[d].level;e[d].rowIndex=h,e[d].colIndex=n*a+a,r[h]?r[h][n*a+a]=this.headerContent[h][n*a+a]=this.frameHeaderWithKeys(e[d]):(r[h]=[],this.headerContent[h]={},r[h][n*a+a]=this.headerContent[h][n*a+a]=this.frameHeaderWithKeys(e[d]));var c=0===this.columns.length&&1===this.values.length;if((this.isMutiMeasures||this.alwaysShowValueHeader||c)&&!this.valueAxis&&p)for(var u=0;u<a;u++){var g=this.values[u].caption?this.values[u].caption:this.values[u].name,m={axis:"column",actualText:this.values[u].name,formattedText:g,level:0,valueSort:{},colIndex:n*a+1+u,rowIndex:l};r[l]?r[l][n*a+1+u]=this.headerContent[l][n*a+1+u]=m:(r[l]=[],this.headerContent[l]={},r[l][n*a+1+u]=this.headerContent[l][n*a+1+u]=m);var v=r[l][n*a+1+u].valueSort;v[e[d].valueSort.levelName+this.valueSortSettings.headerDelimiter+g]=1,v.levelName=e[d].valueSort.levelName+this.valueSortSettings.headerDelimiter+g,v&&v[s]&&(this.valueSortSettings.columnIndex=n*a+1+u)}else e[d].valueSort&&e[d].valueSort[s]&&(this.valueSortSettings.columnIndex=n*a+1);this.pageSettings||(i[n].members=[])}},e.prototype.getAggregateValue=function(e,i,r,n){e.length;var a=0,o=0,l=0,s=!0,d=!1;if(n&&"count"===n.toLowerCase())for(;void 0!==e[a];)void 0!==i[e[a]]&&(d=!0,this.rawIndexObject[e[a]]=e[a],o+=t.isNullOrUndefined(this.valueMatrix[e[a]][r])?0:1),a++;else if(n&&"distinctcount"===n.toLowerCase())for(var p=[];void 0!==e[a];){if(void 0!==i[e[a]]){this.rawIndexObject[e[a]]=e[a],d=!0;F=this.valueMatrix[e[a]][r];t.isNullOrUndefined(F)||(0===p.length||p.length>0&&-1===p.indexOf(F))&&(o+=1,p.push(F))}a++}else if(n&&"product"===n.toLowerCase())for(;void 0!==e[a];){if(void 0!==i[e[a]]){this.rawIndexObject[e[a]]=e[a],d=!0;F=this.valueMatrix[e[a]][r];t.isNullOrUndefined(F)?s&&(o=F):(o=s||t.isNullOrUndefined(o)?1:o,o*=F),s=!1}a++}else if(n&&-1!==["populationstdev","samplestdev","populationvar","samplevar"].indexOf(n.toLowerCase())){for(var h=0,c=0,u=[],g=0,m=0,v=0;void 0!==e[a];){if(void 0!==i[e[a]]){d=!0,this.rawIndexObject[e[a]]=e[a];F=this.valueMatrix[e[a]][r];t.isNullOrUndefined(F)||(c+=F,u.push(F),h++)}a++}if(h>0){g=c/h;for(var f=0,y=u;f<y.length;f++){var S=y[f];v+=Math.pow(S-g,2)}o=0===(m=-1!==["populationstdev","samplestdev"].indexOf(n.toLowerCase())?Math.sqrt(v/("populationstdev"===n.toLowerCase()?h:h-1)):v/("populationvar"===n.toLowerCase()?h:h-1))?NaN:m}else o=c}else if(n&&"min"===n.toLowerCase()){var b=!0;for(o=void 0;void 0!==e[a];)void 0!==i[e[a]]&&void 0!==this.valueMatrix[e[a]][r]&&(d=!0,this.rawIndexObject[e[a]]=e[a],t.isNullOrUndefined(o)&&t.isNullOrUndefined(this.valueMatrix[e[a]][r])?o=this.valueMatrix[e[a]][r]:b?(o=this.valueMatrix[e[a]][r],b=!1):o=this.valueMatrix[e[a]][r]<o?this.valueMatrix[e[a]][r]:o),a++}else if(n&&"max"===n.toLowerCase())for(var C=!0;void 0!==e[a];)void 0!==i[e[a]]&&void 0!==this.valueMatrix[e[a]][r]&&(d=!0,this.rawIndexObject[e[a]]=e[a],C?(o=this.valueMatrix[e[a]][r],C=!1):o=this.valueMatrix[e[a]][r]>o?this.valueMatrix[e[a]][r]:o),a++;else if(n&&"calculatedfield"===n.toLowerCase())for(;void 0!==e[a];){if(void 0!==i[e[a]]){d=!0,this.rawIndexObject[e[a]]=e[a];var w=this.calculatedFields[this.fields[r]],x=w.formula,T={};if(this.calculatedFormulas[w.name])for(var D=this.calculatedFormulas[w.name],M=0,O=D.length;M<O;M++){var P=D[M],L=T[P.formula];if(void 0===L){var E=P.type;L=this.getAggregateValue(e,i,P.index,E),T[P.formula]=L}x=x.replace(P.formula,String(L))}(o=this.evaluate(x))===1/0||void 0===o||isNaN(o)||JSON.parse(String(o))}a++}else for(o=void 0;void 0!==e[a];){if(void 0!==i[e[a]]){d=!0,this.rawIndexObject[e[a]]=e[a];var F=this.valueMatrix[e[a]][r];t.isNullOrUndefined(o)&&t.isNullOrUndefined(F)?o=F:(t.isNullOrUndefined(o)&&(o=0),o+=t.isNullOrUndefined(F)?0:F),t.isNullOrUndefined(F)||l++}a++}return n&&"avg"===n.toLowerCase()&&0!==o&&!t.isNullOrUndefined(o)?o/l:d?o:void 0},e.prototype.evaluate=function(e){return Function('"use strict";return ('+e+")")()},e.prototype.getFormattedValue=function(e,i){var r=null===e?this.localeObj?this.localeObj.getConstant("null"):String(e):void 0===e?this.localeObj?i in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(e):e,n={formattedText:r.toString(),actualText:r,dateText:r};if(this.formatFields[i]&&e){var a=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i],o=t.extend({},a,null,!0);delete o.name,!o.minimumSignificantDigits&&o.minimumSignificantDigits<1&&delete o.minimumSignificantDigits,!o.maximumSignificantDigits&&o.maximumSignificantDigits<1&&delete o.maximumSignificantDigits,o.type?n.formattedText=this.dateFormatFunction[i].exactFormat(new Date(e)):n.formattedText=this.globalize.formatNumber(e,o),n.actualText=e,"None"!==this.fieldList[i].sort&&o.type&&["date","dateTime","time"].indexOf(this.formatFields[i].type)>-1&&(n.dateText=this.dateFormatFunction[i].fullFormat(new Date(e)))}return n},e.prototype.powerFunction=function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,function(e,i){return t.push(i),"~"+(t.length-1)});for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return e},e}(),m="ui-update",v="content-ready",f="data-ready",y="e-pivotfieldlist",S="e-rtl",b="e-device",C="e-icons",w="e-pivotfieldlist-wrapper",x="e-collapse",T="e-expand",D="e-table",M="e-pivot-calc-input",O="e-flat",P="e-format",L="e-pivot-formula",E="e-menu-hide",F="e-input",k="e-selectionbackground",A="e-pivotview-disable-icon",N="e-pivotview-select-icon",j=function(){function e(e){this.parent=e}return e.prototype.render=function(e,t){this.parentElement=t,this.openContextMenu(e)},e.prototype.openContextMenu=function(e){void 0===this.menuInfo&&this.createContextMenu(),this.currentMenu=e.currentTarget;var t=this.currentMenu.getBoundingClientRect();this.parent.enableRtl?this.menuInfo.open(t.top,t.left-105):this.menuInfo.open(t.top,t.left)},e.prototype.createContextMenu=function(){var e={items:[{text:this.parent.localeObj.getConstant("Sum"),id:this.parent.element.id+"_Sum"},{text:this.parent.localeObj.getConstant("Count"),id:this.parent.element.id+"_Count"},{text:this.parent.localeObj.getConstant("DistinctCount"),id:this.parent.element.id+"_DistinctCount"},{text:this.parent.localeObj.getConstant("Product"),id:this.parent.element.id+"_Product"},{text:this.parent.localeObj.getConstant("Avg"),id:this.parent.element.id+"_Avg"},{text:this.parent.localeObj.getConstant("Min"),id:this.parent.element.id+"_Min"},{text:this.parent.localeObj.getConstant("Max"),id:this.parent.element.id+"_Max"},{text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"}],enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this),select:this.selectOptionInContextMenu.bind(this)},i=document.getElementById(this.parent.element.id+"valueFieldContextMenu");null!==i&&(i.innerHTML="");var r=t.createElement("ul",{id:this.parent.element.id+"valueFieldContextMenu"});this.parent.element.appendChild(r),this.menuInfo=new a.ContextMenu(e),this.menuInfo.isStringTemplate=!0,this.menuInfo.appendTo(r)},e.prototype.beforeMenuOpen=function(e){e.element.style.zIndex=(this.menuInfo.element.style.zIndex+3).toString(),e.element.style.display="inline"},e.prototype.createValueSettingsDialog=function(e,i){var n=this;this.parentElement=i;var a=t.createElement("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":e.id}});this.parentElement.appendChild(a),this.valueDialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(e),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){n.valueDialog.hide()},buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parentElement,overlayClick:function(){n.removeDialog()},close:this.removeDialog.bind(this)}),this.valueDialog.isStringTemplate=!0,this.valueDialog.appendTo(a),this.valueDialog.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("valueFieldSettings")},e.prototype.createFieldOptions=function(e){var i=e.getAttribute("data-caption"),r=e.getAttribute("data-type"),n=e.getAttribute("data-basefield"),a=e.getAttribute("data-baseitem");r="undefined"!==r.toString()?r:"Sum";for(var s=[{value:"Sum",text:this.parent.localeObj.getConstant("Sum")},{value:"Count",text:this.parent.localeObj.getConstant("Count")},{value:"DistinctCount",text:this.parent.localeObj.getConstant("DistinctCount")},{value:"Product",text:this.parent.localeObj.getConstant("Product")},{value:"Avg",text:this.parent.localeObj.getConstant("Avg")},{value:"Min",text:this.parent.localeObj.getConstant("Min")},{value:"Max",text:this.parent.localeObj.getConstant("Max")},{value:"Index",text:this.parent.localeObj.getConstant("Index")},{value:"SampleStDev",text:this.parent.localeObj.getConstant("SampleStDev")},{value:"PopulationStDev",text:this.parent.localeObj.getConstant("PopulationStDev")},{value:"SampleVar",text:this.parent.localeObj.getConstant("SampleVar")},{value:"PopulationVar",text:this.parent.localeObj.getConstant("PopulationVar")},{value:"RunningTotals",text:this.parent.localeObj.getConstant("RunningTotals")},{value:"DifferenceFrom",text:this.parent.localeObj.getConstant("DifferenceFrom")},{value:"PercentageOfDifferenceFrom",text:this.parent.localeObj.getConstant("PercentageOfDifferenceFrom")},{value:"PercentageOfGrandTotal",text:this.parent.localeObj.getConstant("PercentageOfGrandTotal")},{value:"PercentageOfColumnTotal",text:this.parent.localeObj.getConstant("PercentageOfColumnTotal")},{value:"PercentageOfRowTotal",text:this.parent.localeObj.getConstant("PercentageOfRowTotal")},{value:"PercentageOfParentTotal",text:this.parent.localeObj.getConstant("PercentageOfParentTotal")},{value:"PercentageOfParentColumnTotal",text:this.parent.localeObj.getConstant("PercentageOfParentColumnTotal")},{value:"PercentageOfParentRowTotal",text:this.parent.localeObj.getConstant("PercentageOfParentRowTotal")}],d=["DifferenceFrom","PercentageOfDifferenceFrom"],p=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],h=t.extend([],this.parent.dataSourceSettings.rows,null,!0),c=[],u=[],g=0,m=h=h.concat(this.parent.dataSourceSettings.columns);g<m.length;g++){var v=m[g],f=v.name,y=v.caption?v.caption:v.name;c.push({value:f,text:y})}n="undefined"!==n.toString()?n:c[0].value,u=Object.keys(this.parent.engineModule.fieldList["undefined"!==n.toString()?n:c[0].value].formattedMembers),a="undefined"!==a.toString()?a:u[0];var S=t.createElement("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":r,"data-caption":i,"data-basefield":n,"data-baseitem":a}}),b=t.createElement("div",{className:"e-field-name-text-wrapper"}),C=t.createElement("div",{className:"e-field-option-wrapper"}),w=t.createElement("div",{className:"e-type-option-wrapper"}),x=t.createElement("div",{className:"e-base-field-option-wrapper"}),T=t.createElement("div",{className:"e-base-item-option-wrapper"}),D=t.createElement("div",{className:"e-field-name-title",innerHTML:this.parent.localeObj.getConstant("sourceName")+"&nbsp;"}),M=t.createElement("div",{className:"e-field-name-content",innerHTML:e.id.toString()}),O=t.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("sourceCaption")}),P=t.createElement("div",{className:"e-base-field-option-text",innerHTML:this.parent.localeObj.getConstant("summarizeValuesBy")}),L=t.createElement("div",{className:"e-base-item-option-text",innerHTML:this.parent.localeObj.getConstant("baseField")}),E=t.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("baseItem")}),F=t.createElement("div",{className:"e-caption-input-wrapper"}),k=t.createElement("div",{id:this.parentElement.id+"_type_option"}),A=t.createElement("div",{id:this.parentElement.id+"_base_field_option"}),N=t.createElement("div",{id:this.parentElement.id+"_base_item_option"}),j=t.createElement("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});b.appendChild(D),b.appendChild(M),F.appendChild(O),F.appendChild(j),w.appendChild(P),x.appendChild(L),T.appendChild(E),w.appendChild(k),x.appendChild(A),T.appendChild(N),C.appendChild(b),C.appendChild(F),C.appendChild(w),C.appendChild(x),C.appendChild(T),S.appendChild(C);var I=this,R=new l.DropDownList({dataSource:s,fields:{value:"value",text:"text"},value:r,cssClass:"e-value-options",width:"100%",change:function(e){q.enabled=-1!==p.indexOf(e.value),V.enabled=-1!==d.indexOf(e.value),V.enabled&&1===V.dataSource.length&&(V.dataSource=u,V.dataBind())}});R.isStringTemplate=!0,R.appendTo(k);var q=new l.DropDownList({dataSource:c,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:n,enabled:-1!==p.indexOf(r),cssClass:"e-value-options",width:"100%",change:function(e){u=Object.keys(I.parent.engineModule.fieldList[e.value].formattedMembers),V.dataSource=u,V.value=u[0],V.filterBarPlaceholder=I.parent.localeObj.getConstant("example")+" "+u[0],V.dataBind()}});q.isStringTemplate=!0,q.appendTo(A);var V=new l.DropDownList({dataSource:[u[0]],enableRtl:this.parent.enableRtl,value:a,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+u[0],enabled:-1!==d.indexOf(r),cssClass:"e-filter-operator",width:"100%"});V.isStringTemplate=!0,V.appendTo(N);var H=new o.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,value:i,width:"100%"});return H.isStringTemplate=!0,H.appendTo(j),S},e.prototype.selectOptionInContextMenu=function(e){if(null!==e.item.text){var t=this.currentMenu.parentElement,i=e.item.id.split(this.parent.element.id+"_")[1];if("MoreOption"===i)this.createValueSettingsDialog(t,this.parentElement);else{var r=t.getAttribute("data-uid"),n=this.parent.dataSourceSettings.values,a=t.querySelector(".e-content"),o=e.item.text+" of "+this.parent.engineModule.fieldList[r].caption;a.innerHTML=o,a.setAttribute("title",o),t.setAttribute("data-type",i);for(var l=0;l<this.parent.dataSourceSettings.values.length;l++)if(this.parent.dataSourceSettings.values[l].name===r){var s=n[l].properties?n[l].properties:n[l];s.type=i,this.parent.lastAggregationInfo=s}this.updateDataSource()}}},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(m,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateValueSettings=function(){var e,i=this.valueDialog.element,r=t.getInstance("#"+this.parentElement.id+"type_input_option",o.MaskedTextBox),n=t.getInstance("#"+this.parentElement.id+"_type_option",l.DropDownList),a=t.getInstance("#"+this.parentElement.id+"_base_field_option",l.DropDownList),s=t.getInstance("#"+this.parentElement.id+"_base_item_option",l.DropDownList),d=i.getAttribute("data-field");if(this.parentElement.querySelector(".e-pivot-button")&&(e=this.parentElement.querySelector(".e-pivot-button."+d.replace(/[^A-Z0-9]/gi,""))),e){var p=e.querySelector(".e-content"),h=this.parent.localeObj.getConstant(n.value)+" of "+r.value;p.innerHTML=h,p.setAttribute("title",h),e.setAttribute("data-type",n.value),e.setAttribute("data-caption",r.value),e.setAttribute("data-basefield",a.value),e.setAttribute("data-baseitem",s.value)}var c=this.parent.pivotCommon.eventBase.getFieldByName(d,this.parent.dataSourceSettings.values);(c=c.properties?c.properties:c).caption=r.value,c.type=n.value,c.baseField=a.value,c.baseItem=s.value,this.valueDialog.close(),this.parent.lastAggregationInfo=c,this.updateDataSource(!0)},e.prototype.removeDialog=function(){this.valueDialog&&!this.valueDialog.isDestroyed&&this.valueDialog.destroy(),document.getElementById(this.parentElement.id+"_ValueDialog")&&t.remove(document.getElementById(this.parentElement.id+"_ValueDialog"))},e.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&!this.menuInfo.isDestroyed&&this.menuInfo.destroy()},e}(),I=function(){function e(e){this.colPos=0,this.lastSpan=0,this.parent=e,this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine=e.engineModule,this.gridSettings=e.gridSettings,this.formatList=this.getFormatList(),this.aggMenu=new j(this.parent)}return e.prototype.render=function(){var e=this.parent,i=this.parent.engineModule;this.parent.gridHeaderCellInfo=[],this.parent.gridCellCollection={},this.injectGridModules(e),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid")?(i.isEngineUpdated?(this.parent.enableValueSorting&&(i.valueContent=this.frameDataSource("value")),i.isEngineUpdated=!1):(i.headerContent=this.frameDataSource("header"),i.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:e.dataSourceSettings.values.length>0&&!this.engine.isEmptyData?i.valueContent:this.frameDataSource("value")},!0),this.parent.grid.notify("datasource-modified",{}),this.parent.isScrolling&&(this.parent.resizeInfo={}),this.parent.grid.refreshColumns(),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth(),this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),this.parent.isScrolling||this.calculateGridHeight(!0)):(this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild(t.createElement("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo("#"+this.parent.element.id+"_grid")),this.parent.grid.on(n.headerRefreshed,this.refreshHeader,this)},e.prototype.refreshHeader=function(){if(this.parent.enableVirtualization){var e=this.parent.element.querySelector(".e-movableheader"),i=this.parent.element.querySelector(".e-movablecontent"),r=i.querySelector(".e-virtualtrack");this.parent.virtualHeaderDiv=e.querySelector(".e-virtualtrack"),e.querySelector(".e-virtualtrack")?t.remove(e.querySelector(".e-virtualtrack")):this.parent.virtualHeaderDiv=t.createElement("div",{className:"e-virtualtrack"}),e.appendChild(this.parent.virtualHeaderDiv),r&&t.setStyleAttribute(this.parent.virtualHeaderDiv,{height:0,width:r.style.width}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:i.querySelector(".e-table").style.transform.split(",")[0]+",0px)"}),e.scrollLeft=i.scrollLeft}},e.prototype.bindGrid=function(e,t){this.injectGridModules(e),this.parent.grid=new n.Grid({frozenColumns:1,frozenRows:0,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.parent.width:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,allowReordering:this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this)}),this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this))},e.prototype.headerRefreshed=function(e){this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&(this.parent.lastGridSettings=void 0,this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth())},e.prototype.rowSelected=function(e){this.parent.renderModule.selected(),this.parent.trigger("rowSelected",e)},e.prototype.rowDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger("rowDeselected",e)},e.prototype.cellSelected=function(e){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger("selected",e))},e.prototype.cellSelecting=function(e){this.parent.trigger("cellSelecting",e)},e.prototype.cellDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger("cellDeselected",e)},e.prototype.queryCellInfo=function(e){this.parent.renderModule.rowCellBoundEvent(e)},e.prototype.headerCellInfo=function(e){this.parent.renderModule.columnCellBoundEvent(e)},e.prototype.excelHeaderQueryCellInfo=function(e){this.parent.renderModule.excelColumnEvent(e)},e.prototype.pdfQueryCellInfo=function(e){this.parent.renderModule.pdfRowEvent(e)},e.prototype.excelQueryCellInfo=function(e){this.parent.renderModule.excelRowEvent(e)},e.prototype.pdfHeaderQueryCellInfo=function(e){this.parent.renderModule.pdfColumnEvent(e)},e.prototype.dataBound=function(e){if(this.parent.cellTemplate&&(!window||!window.Blazor)){for(var i=0,r=this.parent.gridHeaderCellInfo;i<r.length;i++){var n=r[i];this.parent.cellTemplate&&t.append([].slice.call(this.parent.getCellTemplate()(n,this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate")),n.targetCell)}this.parent.gridHeaderCellInfo=[]}this.parent.element.querySelector(".e-firstcell")&&(this.parent.enableRtl?this.parent.element.querySelector(".e-firstcell").style.borderRight="none":this.parent.element.querySelector(".e-firstcell").style.borderLeft="none"),this.parent.grid.widthService.setWidthToTable(),this.parent.isEmptyGrid||this.calculateGridHeight(!0),"Chart"!==this.parent.currentView&&this.parent.grid.hideScroll(),this.parent.isScrolling=!1,this.parent.notify(v,{})},e.prototype.contextMenuOpen=function(e){for(var t=0,i=e.items;t<i.length;t++){var r=i[t],n=this.parent.lastCellClicked,a=null,o=void 0;n.classList.contains("e-stackedheadercelldiv")||n.classList.contains("e-cellvalue")||n.classList.contains("e-headercelldiv")||n.classList.contains("e-icons")||n.classList.contains("e-rhandler")?a=n.parentElement:n.classList.contains("e-headercell")||n.classList.contains("e-rowcell")||n.classList.contains("e-columnsheader")||n.classList.contains("e-rowsheader")||n.classList.contains("e-valuescontent")||n.classList.contains("e-valuesheader")?a=n:n.classList.contains("e-headertext")&&(a=n.parentElement.parentElement),(a.classList.contains("e-valuesheader")||a.classList.contains("e-stot"))&&(o=!0);var l=Number(a.getAttribute("index")),s=Number(a.getAttribute("aria-colindex"));this.parent.pivotValues[l][s];switch(r.id){case this.parent.element.id+"_expand":a.querySelectorAll("."+T).length>0?(e.element.querySelectorAll("#"+this.parent.element.id+"_expand")&&e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add("e-disabled"),e.element.querySelector("#"+this.parent.element.id+"_expand").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_expand").classList.remove("e-disabled"),e.element.querySelector("#"+this.parent.element.id+"_expand").classList.contains(E)&&(e.element.querySelector("#"+this.parent.element.id+"_expand").classList.remove(E),e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.remove(E))):o?e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add(E):e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add("e-disabled");break;case this.parent.element.id+"_collapse":a.querySelectorAll("."+x).length>0?(e.element.querySelector("#"+this.parent.element.id+"_expand")&&e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add("e-disabled"),e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.remove("e-disabled"),e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.contains(E)&&(e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.remove(E),e.element.querySelector("#"+this.parent.element.id+"_expand").classList.remove(E))):o?e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.add(E):e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.add("e-disabled");break;case this.parent.element.id+"_drillthrough":this.parent.allowDrillThrough?a.classList.contains("e-summary")?e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.remove("e-disabled"):""===a.innerText&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough")&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.add("e-disabled"):e.element.querySelector("#"+this.parent.element.id+"_drillthrough")&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.add("e-disabled");break;case this.parent.element.id+"_sortasc":this.parent.enableValueSorting?a.querySelectorAll(".e-icon-descending").length>0?(e.element.querySelector("#"+this.parent.element.id+"_sortdesc")?e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.add("e-disabled"):e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.remove("e-disabled"),e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.remove("e-disabled")):e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.remove("e-disabled"):e.element.querySelector("#"+this.parent.element.id+"_sortasc")&&e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.add("e-disabled");break;case this.parent.element.id+"_sortdesc":this.parent.enableValueSorting?a.querySelectorAll(".e-icon-ascending").length>0?(e.element.querySelector("#"+this.parent.element.id+"_sortasc")?e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.add("e-disabled"):e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.remove("e-disabled"),e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.remove("e-disabled")):e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.remove("e-disabled"):e.element.querySelector("#"+this.parent.element.id+"_sortdesc")&&e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.add("e-disabled");break;case this.parent.element.id+"_CalculatedField":this.parent.allowCalculatedField||e.element.querySelector("#"+this.parent.element.id+"_CalculatedField").classList.add("e-disabled");break;case this.parent.element.id+"_pdf":this.parent.allowPdfExport||e.element.querySelector("#"+this.parent.element.id+"_pdf").classList.add("e-disabled");break;case this.parent.element.id+"_excel":this.parent.allowExcelExport||e.element.querySelector("#"+this.parent.element.id+"_excel").classList.add("e-disabled");break;case this.parent.element.id+"_csv":this.parent.allowExcelExport||e.element.querySelector("#"+this.parent.element.id+"_csv").classList.add("e-disabled");break;case this.parent.element.id+"_exporting":this.parent.allowExcelExport||this.parent.allowPdfExport||e.element.querySelector("#"+this.parent.element.id+"_exporting").classList.add("e-disabled");break;case this.parent.element.id+"_aggregate":""===a.innerText?e.element.querySelector("#"+this.parent.element.id+"_aggregate")&&e.element.querySelector("#"+this.parent.element.id+"_aggregate").classList.add("e-disabled"):e.element.querySelector("#"+this.parent.element.id+"_aggregate").classList.contains("e-disabled")&&e.element.querySelector("#"+this.parent.element.id+"_aggregate").classList.remove("e-disabled")}}this.parent.trigger("contextMenuOpen",e)},e.prototype.contextMenuClick=function(e){var t=this.parent.lastCellClicked,i=e.item.id,r=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),n=null;t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-icons")||t.classList.contains("e-rhandler")?n=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?n=t:t.classList.contains("e-headertext")&&(n=t.parentElement.parentElement);var a=Number(n.getAttribute("index")),o=Number(n.getAttribute("aria-colindex")),l=this.parent.pivotValues[a][o];switch(e.item.id!==this.parent.element.id+"_AggSum"&&e.item.id!==this.parent.element.id+"_AggProduct"&&e.item.id!==this.parent.element.id+"_AggCount"&&e.item.id!==this.parent.element.id+"_AggDistinctCount"&&e.item.id!==this.parent.element.id+"_AggAvg"&&e.item.id!==this.parent.element.id+"_AggMin"&&e.item.id!==this.parent.element.id+"_AggMax"&&e.item.id!==this.parent.element.id+"_AggMoreOption"||(this.field=this.parent.engineModule.fieldList[l.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[l.actualText.toString()].caption),i){case this.parent.element.id+"_pdf":this.parent.pdfExport();break;case this.parent.element.id+"_excel":this.parent.excelExport();break;case this.parent.element.id+"_csv":this.parent.csvExport();break;case this.parent.element.id+"_drillthrough_menu":n.dispatchEvent(r);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:l.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:l.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(n.querySelectorAll("."+T)){var s=n.querySelectorAll("."+T)[0];this.parent.onDrill(s)}break;case this.parent.element.id+"_collapse":if(n.querySelectorAll("."+x)){var d=n.querySelectorAll("."+x)[0];this.parent.onDrill(d)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggSum":this.updateAggregate("Sum");break;case this.parent.element.id+"_AggProduct":this.updateAggregate("Product");break;case this.parent.element.id+"_AggCount":this.updateAggregate("Count");break;case this.parent.element.id+"_AggDistinctCount":this.updateAggregate("DistinctCount");break;case this.parent.element.id+"_AggAvg":this.updateAggregate("Avg");break;case this.parent.element.id+"_AggMin":this.updateAggregate("Min");break;case this.parent.element.id+"_AggMax":this.updateAggregate("Max");break;case this.parent.element.id+"_AggMoreOption":n.setAttribute("id",this.field),n.setAttribute("data-caption",this.fieldCaption),n.setAttribute("data-field",this.field),n.setAttribute("data-type",this.parent.engineModule.fieldList[l.actualText.toString()].aggregateType),n.setAttribute("data-basefield",this.parent.engineModule.fieldList[l.actualText.toString()].baseField),n.setAttribute("data-baseItem",this.parent.engineModule.fieldList[l.actualText.toString()].baseItem),this.aggMenu.createValueSettingsDialog(n,this.parent.element)}this.parent.trigger("contextMenuClick",e)},e.prototype.updateAggregate=function(e){for(var t=this.parent.dataSourceSettings.values,i=0;i<this.parent.dataSourceSettings.values.length;i++)this.parent.dataSourceSettings.values[i].name===this.field&&(t[i].type=e)},e.prototype.injectGridModules=function(e){n.Grid.Inject(n.Freeze),e.allowExcelExport&&n.Grid.Inject(n.ExcelExport),e.allowPdfExport&&n.Grid.Inject(n.PdfExport),n.Grid.Inject(n.Selection,n.Reorder,n.Resize),this.gridSettings.contextMenuItems&&n.Grid.Inject(n.ContextMenu)},e.prototype.updateGridSettings=function(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){var e=Object.keys(this.parent.lastGridSettings);e.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height),e.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width),this.updatePivotColumns()}this.clearColumnSelection()},e.prototype.updatePivotColumns=function(){for(var e=Object.keys(this.parent.lastGridSettings),i=0;i<this.parent.pivotColumns.length;i++)for(var r=this.parent.pivotColumns[i],n=0;n<e.length;n++){var a=e[n];t.isNullOrUndefined(this.parent.pivotColumns[i][a])||(r[a]=this.parent.lastGridSettings[a])}this.parent.fillGridColumns(this.parent.grid.columns)},e.prototype.clearColumnSelection=function(){this.parent.element.querySelectorAll(".e-active").forEach(function(e){e.classList.remove("e-active"),e.classList.remove(k)})},e.prototype.appendValueSortIcon=function(e,i,r,n){if(this.parent.enableValueSorting){var a=this.parent.dataSourceSettings.valueSortSettings,o="grand sum"!==e.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.engineModule.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:this.parent.engineModule.headerContent.length-1:0,l=a&&a.headerText?e.valueSort.levelName===a.headerText:n===a.columnIndex;if(void 0!==a&&l&&r===o&&"column"===this.parent.dataSourceSettings.valueAxis&&(i.querySelector(".e-sortfilterdiv")?(i.querySelector(".e-sortfilterdiv").classList.add("Descending"===a.sortOrder?"e-descending":"e-ascending"),i.querySelector(".e-sortfilterdiv").classList.add("Descending"===a.sortOrder?"e-icon-descending":"e-icon-ascending")):i.appendChild(t.createElement("div",{className:"Descending"===a.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv"})),!t.isNullOrUndefined(e.hasChild)&&"grand sum"!==e.type&&i.querySelector(".e-expand")&&(i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending")))){var s=i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending");t.setStyleAttribute(s,{"padding-top":"12px"})}}return i},e.prototype.onResizeStop=function(e){var t="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[t]=Number(e.column.width.toString().split("px")[0]),this.setGroupWidth(e),this.calculateGridHeight(!0),this.parent.grid.hideScroll()},e.prototype.setGroupWidth=function(e){if(this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth){e.cancel=!0;var t=this.parent.grid.columns;t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width=this.resColWidth+"px"}this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px";var i=this.parent.element.querySelector(".e-headercontent").offsetHeight;this.parent.element.querySelector(".e-group-rows").style.height=i+"px"}this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?"resizeStop":"resizing",e)},e.prototype.selected=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.onSelect.bind(this),300)},e.prototype.onSelect=function(){for(var e={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},t=0,i=this.parent.element.querySelectorAll(".e-cellselectionbackground,."+k);t<i.length;t++){var r=i[t],n=Number(r.getAttribute("aria-colindex")),a=Number(r.getAttribute("index")),o=this.engine.pivotValues[a][n];o&&("value"===o.axis?e.selectedCellsInfo.push({currentCell:o,value:o.value,columnHeaders:o.columnHeaders,rowHeaders:o.rowHeaders,measure:o.actualText.toString()}):"column"===o.axis?e.selectedCellsInfo.push({currentCell:o,value:o.formattedText,columnHeaders:o.valueSort.levelName,rowHeaders:"",measure:""}):e.selectedCellsInfo.push({currentCell:o,value:o.formattedText,columnHeaders:"",rowHeaders:o.valueSort.levelName,measure:""}))}this.parent.trigger("cellSelected",e)},e.prototype.rowCellBoundEvent=function(e){var i=e.cell;if(i&&!this.parent.isEmptyGrid){var r=this.parent.hyperlinkSettings.cssClass;i.setAttribute("index",(Number(i.getAttribute("index"))+this.engine.headerContent.length).toString());var n=e.data[0];if("0"===i.getAttribute("aria-colindex")){var a=n.type&&"value"===n.type;i.innerText="";var o=n.level?n.level:a?this.lastSpan+1:0;do{o>0&&i.appendChild(t.createElement("span",{className:0===o?"":"e-nextspan"})),o--}while(o>-1);o=n.level?n.level:0,this.lastSpan=a?this.lastSpan:o,!n.hasChild&&o>0&&i.appendChild(t.createElement("span",{className:"e-lastspan"}));var l=void 0;this.parent.dataSourceSettings.rows.length>0&&(!n.valueSort||Object.keys(n.valueSort).length>0)&&(l=o>-1?this.parent.dataSourceSettings.rows[o].name:"",i.setAttribute("fieldname",l));var s=n.formattedText;n.type&&("grand sum"===n.type?(i.classList.add("e-gtot"),s=this.parent.localeObj.getConstant("grandTotal")):i.classList.add("e-stot")),i.classList.add("e-rowsheader"),!0===n.hasChild&&i.appendChild(t.createElement("div",{className:(!0===n.isDrilled?x:T)+" "+C,attrs:{title:!0===n.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}})),i.appendChild(t.createElement("span",{className:"e-cellvalue",innerHTML:this.parent.isRowCellHyperlink||n.enableHyperlink?'<a  data-url="'+s+'" class="e-hyperlinkcell '+r+'">'+s+"</a>":s}));var d=this.parent.pivotView.dataSourceSettings.valueSortSettings;if(this.parent.enableValueSorting&&d&&d.headerText&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName===d.headerText){var p=i.querySelector(".e-expand")||i.querySelector(".e-collapse")?"padding-top: 18px":"padding-top: 12px";i.appendChild(t.createElement("div",{className:"Descending"===d.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv",styles:p}))}}else{var h=i.innerText;i.innerText="",i.classList.add("e-valuescontent"),(n=e.data[Number(i.getAttribute("aria-colindex"))]).isSum&&i.classList.add("e-summary"),n.cssClass&&i.classList.add(n.cssClass),i.appendChild(t.createElement("span",{className:"e-cellvalue",innerHTML:-1!==i.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===i.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||n.enableHyperlink?'<a data-url="'+h+'" class="e-hyperlinkcell '+r+'">'+h+"</a>":h}))}if(this.parent.cellTemplate){var c=i.getAttribute("index"),u=i.getAttribute("aria-colindex"),g=c+"_"+u;window&&window.Blazor?c&&u&&(this.parent.gridCellCollection[g]=i):t.append([].slice.call(this.parent.getCellTemplate()({targetCell:i},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate")),i)}this.unWireEvents(i),this.wireEvents(i)}e.pivotview=this.parent,this.parent.trigger("queryCellInfo",e)},e.prototype.columnCellBoundEvent=function(e){if(e.cell.column&&e.cell.column.customAttributes){var i=e.cell.column.customAttributes.cell,r=e.node;if(i){var n=this.parent.hyperlinkSettings.cssClass,a=i.level?i.level:0;-1===i.level&&!i.rowSpan&&i.rowIndex!==this.engine.headerContent.length-1||-1===i.rowSpan?e.node.style.display="none":i.rowSpan>1&&(e.node.setAttribute("rowspan",i.rowSpan.toString()),e.node.setAttribute("aria-rowspan",i.rowSpan.toString()),i.rowIndex+i.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("aria-colindex",i.colIndex.toString()),e.node.setAttribute("index",i.rowIndex.toString());var o=void 0;if(!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&i.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(o=a>-1&&this.parent.dataSourceSettings.columns[a]?this.parent.dataSourceSettings.columns[a].name:"",r.setAttribute("fieldname",o)),i.type){r.classList.add("grand sum"===i.type?"e-gtot":"e-stot");var l="grand sum"===i.type?this.parent.localeObj.getConstant("grandTotal"):i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");null!==r.querySelector(".e-headertext")?r.querySelector(".e-headertext").innerText=l:r.querySelector(".e-stackedheadercelldiv").innerText=l}if(r.classList.add("e-columnsheader"),this.parent.isColumnCellHyperlink||i.enableHyperlink)if(r.querySelector(".e-stackedheadercelldiv")){s=r.querySelector(".e-stackedheadercelldiv").innerText;r.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+s+'" class="e-hyperlinkcell '+n+'">'+s+"</a>"}else if(r.querySelector(".e-headertext")){var s=r.querySelector(".e-headertext").innerText;r.querySelector(".e-headertext").innerHTML='<a data-url="'+s+'" class="e-hyperlinkcell '+n+'">'+s+"</a>"}if(!0===i.hasChild){var d=r.querySelector(".e-headercelldiv");d&&(d.style.height="auto",d.style.lineHeight="normal");var p=t.createElement("div",{className:(!0===i.isDrilled?x:T)+" "+C,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}});r.children[0].classList.add("e-cellvalue"),window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?r.children[0].style.display="table":r.children[0].style.display="block",r.insertBefore(p,r.children[0])}if(r=this.appendValueSortIcon(i,r,i.rowIndex,i.colIndex),this.parent.cellTemplate){var h=r.getAttribute("index"),c=r.getAttribute("aria-colindex"),u=h+"_"+c;window&&window.Blazor?h&&c&&(this.parent.gridCellCollection[u]=r):this.parent.gridHeaderCellInfo.push({targetCell:r})}for(var g=this.parent.dataSourceSettings.values.length,m=0;m<g;m++)this.parent.dataSourceSettings.values[m].name===i.actualText&&r.classList.add("e-valuesheader");this.unWireEvents(r),this.wireEvents(r)}}this.parent.trigger("headerCellInfo",e)},e.prototype.onHyperCellClick=function(e){var i=e.target.parentElement.parentElement,r={currentCell:i=i.className.indexOf("e-headercelldiv")>-1?i.parentElement:i,data:this.engine.pivotValues[Number(i.getAttribute("index"))][Number(i.getAttribute("aria-colindex"))],cancel:!0};this.parent.trigger("hyperlinkCellClick",r,function(e){if(!e.cancel){r.currentCell=t.getElement(r.currentCell);var i=r.currentCell.getAttribute("data-url")?r.currentCell.getAttribute("data-url"):r.currentCell.querySelector("a").getAttribute("data-url");window.open(i)}})},e.prototype.getRowStartPos=function(){for(var e,t=this.parent.pivotValues,i=0;i<t.length;i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e},e.prototype.frameDataSource=function(e){var t=[];if(this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var i=0,r=this.parent.pivotValues,n="value"===e?this.rowStartPos:0,a="value"===e?r.length:this.rowStartPos,o=n;o<a;o++)if(r[o]){t[i="header"===e?o:i]={};for(var l=0;l<r[o].length;l++)r[o][l]&&(t[i][l]=r[o][l]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t},e.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},e.prototype.calculateColWidth=function(e){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2;var i=(e-=1)*this.gridSettings.columnWidth<t?t/e:this.gridSettings.columnWidth;return Math.floor(i)},e.prototype.resizeColWidth=function(e){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);e-=1,t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2;var i=e*this.gridSettings.columnWidth<t?t/e:this.gridSettings.columnWidth;return Math.floor(i)},e.prototype.calculateGridWidth=function(){var e=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return"auto"===this.gridSettings.width?"auto"===this.parent.width?e=t:this.parent.width.toString().indexOf("%")>-1&&(e=parseFloat(this.parent.width.toString())/100*t):e=this.gridSettings.width,e},e.prototype.calculateGridHeight=function(e){var t=this.parent.height,i=this.parent.getHeightAsNumber();if(isNaN(i)&&(i=this.parent.element.offsetHeight>0?this.parent.element.offsetHeight:1),"Chart"!==this.parent.currentView)if("auto"===this.gridSettings.height&&i&&this.parent.element.querySelector(".e-gridheader"))if(t=i-(this.parent.element.querySelector(".e-gridheader").offsetHeight+(this.parent.element.querySelector(".e-grouping-bar")?this.parent.element.querySelector(".e-grouping-bar").offsetHeight:0)+(this.parent.element.querySelector(".e-pivot-toolbar")?42:0))-2,e){var r=this.parent.element.querySelector(".e-frozencontent ."+D).offsetHeight,n=this.parent.element.querySelector(".e-movablecontent").offsetHeight,a=this.parent.element.querySelector(".e-movablecontent ."+D).offsetWidth,o=this.parent.element.querySelector(".e-movablecontent").offsetWidth<a,l=n<r,s=!!(o&&t-r<18);this.parent.grid.height=t>=r&&(!o||t>=n)&&!l&&!s?"auto":t}else t>this.engine.valueContent.length*this.gridSettings.rowHeight&&(t="auto");else t=this.gridSettings.height;return t<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:t},e.prototype.frameStackedHeaders=function(){var e=[];if(this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData){var t=this.engine.headerContent.length,i=[],r=[],n=this.calculateColWidth(this.engine.pivotValues[0].length);do{var a=[],o=0;t--;var l=this.engine.headerContent[t];if(l)for(var s=0;s<Object.keys(l).length+(l[0]?0:1);s++){var d=l[s]&&l[s].colSpan?l[s].colSpan:1,p=(l[s]&&l[s].rowSpan&&l[s].rowSpan,l[s]?"grand sum"===l[s].type?this.parent.localeObj.getConstant("grandTotal"):"sum"===l[s].type?l[s].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):l[s].formattedText:"");if(t===this.engine.headerContent.length-1)a[o]={field:s+".formattedText",headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,n):this.resColWidth,minWidth:30,format:0===s?"":this.formatList[(s-1)%this.parent.dataSourceSettings.values.length],allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0};else if(i[s]){for(var h=d,c=[],u=s;h>0;){if(a[o]){if(!e[r[u]])break;c.push(e[r[u]])}else a[o]={headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,n):this.resColWidth,minWidth:30,allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0},c=[e[r[u]]];h-=i[u],u+=i[u]}a[o].columns=c}a[o]&&(a[o].clipMode=this.gridSettings.clipMode),i[s]=d,r[s]=o,o++,s=s+d-1}e=a.length>0?a:e}while(t>0);e[0]={field:"0.formattedText",width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0}}else e=this.frameEmptyColumns();return e.length>1&&(e[e.length-1].minWidth=e[e.length-1].width,e[e.length-1].width="auto"),this.parent.triggerColumnRenderEvent(e),e},e.prototype.setSavedWidth=function(e,t){return t=this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:t},e.prototype.frameEmptyColumns=function(){var e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),e},e.prototype.getFormatList=function(){for(var e=[],t=0;t<this.parent.dataSourceSettings.values.length;t++){var i=this.parent.dataSourceSettings.values[t];if(this.parent.dataSourceSettings.formatSettings.length>0){for(var r="",n=0;n<this.parent.dataSourceSettings.formatSettings.length;n++){var a=this.parent.dataSourceSettings.formatSettings[n];if(i.name===a.name){r=a.format;break}}e.push(r)}else e.push("N")}return e},e.prototype.excelColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger("excelHeaderQueryCellInfo",e)},e.prototype.pdfColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger("pdfHeaderQueryCellInfo",e)},e.prototype.excelRowEvent=function(e){if("0.formattedText"===e.column.field){var t="value"===e.data[0].type,i=t?this.lastSpan+1:e.data[0].level;this.colPos=0,e.style={hAlign:"Left",indent:2*i},this.lastSpan=t?this.lastSpan:i}else this.colPos++,e.value=e.data[this.colPos].value||e.data[this.colPos].formattedText;e=this.exportContentEvent(e),this.parent.trigger("excelQueryCellInfo",e)},e.prototype.pdfRowEvent=function(e){if("0.formattedText"===(e=this.exportContentEvent(e)).column.field){var t="value"===e.data[0].type,i=t?this.lastSpan+1:e.data[0].level;e.style={paragraphIndent:10*i},this.lastSpan=t?this.lastSpan:i}this.parent.trigger("pdfQueryCellInfo",e)},e.prototype.exportHeaderEvent=function(e){var t=1;if(e.gridCell.column.customAttributes){var i=e.gridCell.column.customAttributes.cell;t=i.rowSpan?i.rowSpan:1}else t=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan&&e.cell.rowSpan!==t&&t>-1&&(e.cell.rowSpan=t),e},e.prototype.exportContentEvent=function(e){return e.value="grand sum"===e.data[Number(e.column.field.split(".formattedText")[0])].type?this.parent.localeObj.getConstant("grandTotal"):e.value,e},e.prototype.unWireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.remove(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},e.prototype.wireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.add(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},e}(),R=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),q=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},V=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"name",void 0),q([t.Property()],i.prototype,"caption",void 0),q([t.Property("Sum")],i.prototype,"type",void 0),q([t.Property()],i.prototype,"axis",void 0),q([t.Property(!1)],i.prototype,"showNoDataItems",void 0),q([t.Property()],i.prototype,"baseField",void 0),q([t.Property()],i.prototype,"baseItem",void 0),q([t.Property(!0)],i.prototype,"showSubTotals",void 0),i}(t.ChildProperty),H=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}R(t,e)}(V),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}R(i,e),q([t.Property()],i.prototype,"backgroundColor",void 0),q([t.Property()],i.prototype,"color",void 0),q([t.Property()],i.prototype,"fontFamily",void 0),q([t.Property()],i.prototype,"fontSize",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"name",void 0),q([t.Property("Include")],i.prototype,"type",void 0),q([t.Property()],i.prototype,"items",void 0),q([t.Property("DoesNotEquals")],i.prototype,"condition",void 0),q([t.Property()],i.prototype,"value1",void 0),q([t.Property()],i.prototype,"value2",void 0),q([t.Property()],i.prototype,"measure",void 0),i}(t.ChildProperty)),B=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"measure",void 0),q([t.Property()],i.prototype,"label",void 0),q([t.Property()],i.prototype,"conditions",void 0),q([t.Property()],i.prototype,"value1",void 0),q([t.Property()],i.prototype,"value2",void 0),q([t.Property()],i.prototype,"style",void 0),i}(t.ChildProperty),_=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"name",void 0),q([t.Property("Ascending")],i.prototype,"order",void 0),i}(t.ChildProperty),U=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"name",void 0),q([t.Property()],i.prototype,"minimumFractionDigits",void 0),q([t.Property()],i.prototype,"maximumFractionDigits",void 0),q([t.Property()],i.prototype,"minimumSignificantDigits",void 0),q([t.Property()],i.prototype,"maximumSignificantDigits",void 0),q([t.Property(!0)],i.prototype,"useGrouping",void 0),q([t.Property()],i.prototype,"skeleton",void 0),q([t.Property()],i.prototype,"type",void 0),q([t.Property()],i.prototype,"currency",void 0),q([t.Property()],i.prototype,"minimumIntegerDigits",void 0),q([t.Property()],i.prototype,"format",void 0),i}(t.ChildProperty),G=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"name",void 0),q([t.Property()],i.prototype,"groupInterval",void 0),q([t.Property()],i.prototype,"startingAt",void 0),q([t.Property()],i.prototype,"endingAt",void 0),q([t.Property("Date")],i.prototype,"type",void 0),q([t.Property()],i.prototype,"rangeInterval",void 0),i}(t.ChildProperty),z=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"name",void 0),q([t.Property()],i.prototype,"formula",void 0),i}(t.ChildProperty),W=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"name",void 0),q([t.Property()],i.prototype,"items",void 0),q([t.Property()],i.prototype,"delimiter",void 0),i}(t.ChildProperty),Q=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"headerText",void 0),q([t.Property(".")],i.prototype,"headerDelimiter",void 0),q([t.Property("None")],i.prototype,"sortOrder",void 0),i}(t.ChildProperty),Y=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return R(i,e),q([t.Property()],i.prototype,"dataSource",void 0),q([t.Collection([],V)],i.prototype,"rows",void 0),q([t.Collection([],V)],i.prototype,"columns",void 0),q([t.Collection([],V)],i.prototype,"values",void 0),q([t.Collection([],V)],i.prototype,"filters",void 0),q([t.Property([])],i.prototype,"excludeFields",void 0),q([t.Property(!1)],i.prototype,"expandAll",void 0),q([t.Property("column")],i.prototype,"valueAxis",void 0),q([t.Collection([],H)],i.prototype,"filterSettings",void 0),q([t.Collection([],_)],i.prototype,"sortSettings",void 0),q([t.Property(!0)],i.prototype,"enableSorting",void 0),q([t.Property(!1)],i.prototype,"allowLabelFilter",void 0),q([t.Property(!1)],i.prototype,"allowValueFilter",void 0),q([t.Property(!0)],i.prototype,"showSubTotals",void 0),q([t.Property(!0)],i.prototype,"showRowSubTotals",void 0),q([t.Property(!0)],i.prototype,"showColumnSubTotals",void 0),q([t.Property(!0)],i.prototype,"showGrandTotals",void 0),q([t.Property(!0)],i.prototype,"showRowGrandTotals",void 0),q([t.Property(!0)],i.prototype,"showColumnGrandTotals",void 0),q([t.Property(!1)],i.prototype,"alwaysShowValueHeader",void 0),q([t.Property(!0)],i.prototype,"showAggregationOnValueField",void 0),q([t.Collection([],U)],i.prototype,"formatSettings",void 0),q([t.Collection([],W)],i.prototype,"drilledMembers",void 0),q([t.Complex({},Q)],i.prototype,"valueSortSettings",void 0),q([t.Collection([],z)],i.prototype,"calculatedFieldSettings",void 0),q([t.Collection([],B)],i.prototype,"conditionalFormatSettings",void 0),q([t.Property()],i.prototype,"emptyCellsTextContent",void 0),q([t.Collection([],G)],i.prototype,"groupSettings",void 0),i}(t.ChildProperty),X=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),K=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Z=(function(e){function i(){return null!==e&&e.apply(this,arguments)||this}X(i,e),K([t.Property("Row")],i.prototype,"mode",void 0),K([t.Property("Flow")],i.prototype,"cellSelectionMode",void 0),K([t.Property("Single")],i.prototype,"type",void 0),K([t.Property(!1)],i.prototype,"checkboxOnly",void 0),K([t.Property(!1)],i.prototype,"persistSelection",void 0),K([t.Property("Default")],i.prototype,"checkboxMode",void 0),K([t.Property(!1)],i.prototype,"enableSimpleMultiRowSelection",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return X(i,e),K([t.Property("auto")],i.prototype,"height",void 0),K([t.Property("auto")],i.prototype,"width",void 0),K([t.Property("Both")],i.prototype,"gridLines",void 0),K([t.Property(!1)],i.prototype,"allowTextWrap",void 0),K([t.Property(!1)],i.prototype,"allowReordering",void 0),K([t.Property(!0)],i.prototype,"allowResizing",void 0),K([t.Property(null)],i.prototype,"rowHeight",void 0),K([t.Property(110)],i.prototype,"columnWidth",void 0),K([t.Property("Ellipsis")],i.prototype,"clipMode",void 0),K([t.Property(!1)],i.prototype,"allowSelection",void 0),K([t.Property(-1)],i.prototype,"selectedRowIndex",void 0),K([t.Property({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],i.prototype,"selectionSettings",void 0),K([t.Property({WrapMode:"Both"})],i.prototype,"textWrapSettings",void 0),K([t.Property("AllPages")],i.prototype,"printMode",void 0),K([t.Property()],i.prototype,"contextMenuItems",void 0),K([t.Event()],i.prototype,"beforeCopy",void 0),K([t.Event()],i.prototype,"printComplete",void 0),K([t.Event()],i.prototype,"beforePrint",void 0),K([t.Event()],i.prototype,"contextMenuOpen",void 0),K([t.Event()],i.prototype,"contextMenuClick",void 0),K([t.Event()],i.prototype,"queryCellInfo",void 0),K([t.Event()],i.prototype,"headerCellInfo",void 0),K([t.Event()],i.prototype,"rowSelecting",void 0),K([t.Event()],i.prototype,"rowSelected",void 0),K([t.Event()],i.prototype,"rowDeselecting",void 0),K([t.Event()],i.prototype,"rowDeselected",void 0),K([t.Event()],i.prototype,"cellSelecting",void 0),K([t.Event()],i.prototype,"cellSelected",void 0),K([t.Event()],i.prototype,"cellDeselecting",void 0),K([t.Event()],i.prototype,"cellDeselected",void 0),K([t.Event()],i.prototype,"resizeStart",void 0),K([t.Event()],i.prototype,"resizing",void 0),K([t.Event()],i.prototype,"resizeStop",void 0),K([t.Event()],i.prototype,"pdfHeaderQueryCellInfo",void 0),K([t.Event()],i.prototype,"pdfQueryCellInfo",void 0),K([t.Event()],i.prototype,"excelHeaderQueryCellInfo",void 0),K([t.Event()],i.prototype,"excelQueryCellInfo",void 0),K([t.Event()],i.prototype,"columnDragStart",void 0),K([t.Event()],i.prototype,"columnDrag",void 0),K([t.Event()],i.prototype,"columnDrop",void 0),K([t.Event()],i.prototype,"columnRender",void 0),i}(t.ChildProperty)),$=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.exportToExcel=function(e){if(this.parent.enableVirtualization){var t=this.parent.engineModule.pageSettings;this.parent.engineModule.pageSettings=null,this.parent.engineModule.generateGridData(this.parent.dataSourceSettings),this.parent.engineModule.pageSettings=t}var i={fileName:"default",header:"",footer:"",dataCollections:[this.parent.engineModule.pivotValues]};this.parent.trigger("beforeExport",i);for(var r=i.fileName,n=i.dataCollections,a=[],o=0;o<n.length;o++){for(var l=n[o],d=0,p=l.length,h=0,c=this.parent.renderModule.getFormatList(),u=[],g=0,m=0;m<p;m++)if(l[m]){h++,d=l[m].length;for(var v=[],f=0;f<d;f++)if(l[m][f]){var y=l[m][f];if(-1!==y.level||y.rowSpan){var S="value"===y.axis?y.value:y.formattedText;S="grand sum"===y.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===y.type?S.toString().replace("Total",this.parent.localeObj.getConstant("total")):S,(-1!==y.level||y.rowSpan)&&(v.push({index:f+1,value:S,colSpan:y.colSpan,rowSpan:y.rowSpan}),"value"===y.axis?(v[v.length-1].style={numberFormat:c[(f-1)%this.parent.dataSourceSettings.values.length],bold:!1,wrapText:!0},y.style&&(v[v.length-1].style.backColor=y.style.backgroundColor,v[v.length-1].style.fontColor=y.style.color,v[v.length-1].style.fontName=y.style.fontFamily,v[v.length-1].style.fontSize=Number(y.style.fontSize.split("px")[0]))):(v[v.length-1].style={bold:!0,vAlign:"Center",wrapText:!0,indent:1===f?10*y.level:0},"row"===y.axis&&0===f&&(v[v.length-1].style.hAlign="Left",v[v.length-1].style.indent=2*y.level,g=y.level>g?y.level:g)),v[v.length-1].style.borders={color:"#000000",lineStyle:"Thin"})}f+=y.colSpan?y.colSpan-1:0}else v.push({index:f+1,value:"",colSpan:1,rowSpan:1});u.push({index:h,cells:v})}for(var b=[],f=0;f<d;f++)b.push({index:f+1,width:100});g>0&&(b[0].width=100+20*g),a.push({columns:b,rows:u})}new s.Workbook({worksheets:a},"Excel"===e?"xlsx":"csv").save(r+("Excel"===e?".xlsx":".csv"))},e.prototype.destroy=function(){},e}(),J=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.addPage=function(e){var t=e.document.pages.add(),i=e.args.header,r=e.args.footer,n=new d.PdfStandardFont(d.PdfFontFamily.TimesRoman,15,d.PdfFontStyle.Regular),a=new d.PdfSolidBrush(new d.PdfColor(0,0,0)),o=new d.PdfPen(new d.PdfColor(0,0,0),.5),l=new d.PdfPageTemplateElement(new d.RectangleF(0,0,t.graphics.clientSize.width,20));l.graphics.drawString(i,n,o,a,0,0,new d.PdfStringFormat(d.PdfTextAlignment.Center)),e.document.template.top=l;var s=new d.PdfPageTemplateElement(new d.RectangleF(0,0,t.graphics.clientSize.width,20));return s.graphics.drawString(r,n,o,a,0,0,new d.PdfStringFormat(d.PdfTextAlignment.Center)),e.document.template.bottom=s,t},e.prototype.hexDecToRgb=function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color..");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},e.prototype.getFontStyle=function(e){var i=d.PdfFontStyle.Regular;return!t.isNullOrUndefined(e)&&e.bold&&(i|=d.PdfFontStyle.Bold),!t.isNullOrUndefined(e)&&e.italic&&(i|=d.PdfFontStyle.Italic),!t.isNullOrUndefined(e)&&e.underline&&(i|=d.PdfFontStyle.Underline),!t.isNullOrUndefined(e)&&e.strikeout&&(i|=d.PdfFontStyle.Strikeout),i},e.prototype.getBorderStyle=function(e){var i=new d.PdfBorders;if(t.isNullOrUndefined(e)){var r=new d.PdfColor(234,234,234);i.all=new d.PdfPen(r)}else{var n=e.width,a=t.isNullOrUndefined(n)||"number"!=typeof n?void 0:.75*n,o=new d.PdfColor(196,196,196);if(!t.isNullOrUndefined(e.color)){var l=this.hexDecToRgb(e.color);o=new d.PdfColor(l.r,l.g,l.b)}var s=new d.PdfPen(o,a);t.isNullOrUndefined(e.dashStyle)||(s.dashStyle=this.getDashStyle(e.dashStyle)),i.all=s}return i},e.prototype.getDashStyle=function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},e.prototype.getStyle=function(){var e=new d.PdfBorders;if(t.isNullOrUndefined(this.gridStyle))return{brush:new d.PdfSolidBrush(new d.PdfColor),border:e,font:void 0};var i=t.isNullOrUndefined(this.gridStyle.header.fontName)?d.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.header.fontName),r=this.getFontStyle(this.gridStyle.header),n=t.isNullOrUndefined(this.gridStyle.header.fontSize)?10.5:this.gridStyle.header.fontSize,a=new d.PdfColor;if(!t.isNullOrUndefined(this.gridStyle.header.fontColor)){var o=this.hexDecToRgb(this.gridStyle.header.fontColor);a=new d.PdfColor(o.r,o.g,o.b)}var l=new d.PdfStandardFont(i,n,r);return t.isNullOrUndefined(this.gridStyle.header.font)||(l=this.gridStyle.header.font),{border:this.getBorderStyle(this.gridStyle.header.border),font:l,brush:new d.PdfSolidBrush(a)}},e.prototype.setRecordThemeStyle=function(e,i){if(!t.isNullOrUndefined(this.gridStyle)&&!t.isNullOrUndefined(this.gridStyle.record)){var r=t.isNullOrUndefined(this.gridStyle.record.fontName)?d.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.record.fontName),n=t.isNullOrUndefined(this.gridStyle.record.fontSize)?9.75:this.gridStyle.record.fontSize,a=this.getFontStyle(this.gridStyle.record),o=new d.PdfStandardFont(r,n,a);t.isNullOrUndefined(this.gridStyle.record.font)||(o=this.gridStyle.record.font),e.style.setFont(o);var l=new d.PdfColor;if(!t.isNullOrUndefined(this.gridStyle.record.fontColor)){var s=this.hexDecToRgb(this.gridStyle.record.fontColor);l=new d.PdfColor(s.r,s.g,s.b)}e.style.setTextBrush(new d.PdfSolidBrush(l))}var p=this.gridStyle&&this.gridStyle.record&&this.gridStyle.record.border?this.getBorderStyle(this.gridStyle.record.border):i;return e.style.setBorder(p),e},e.prototype.exportToPDF=function(){for(var e=this.applyEvent(),t=this.getStyle(),i=0,r=e.args.dataCollections[i],n=0;e.args.allowRepeatHeader&&n<r.length;n++)for(var a=6;r[n]&&a<r[n].length;a+=6)r[n].splice(a,0,r[n][0]);var o=r&&r.length>0?r[0].length:0,l=0;do{var s=this.addPage(e),p=new d.PdfGrid;if(r&&r.length>0){p.columns.add(r[0].length-l>=6?6:r[0].length-l);for(var h=r.length,c=0,u=0,g=0;g<h;g++)if(r[g]){var m=!(r[g][0]&&"row"===r[g][0].axis),v=r[g].length>l+6?l+6:r[g].length;m&&p.headers.add(1);var f=m?p.headers.getHeader(c):p.rows.addRow();m?(f.style.setBorder(t.border),t.font&&f.style.setFont(t.font),f.style.setTextBrush(t.brush)):this.setRecordThemeStyle(f,t.border);for(var y=0,S=!0,b=l;b<v;b++){var C=!1;if(r[g][b]){var w=r[g][b];if(-1!==w.level||w.rowSpan){var x=w.formattedText;x="grand sum"===w.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===w.type?x.toString().replace("Total",this.parent.localeObj.getConstant("total")):x,(-1!==w.level||w.rowSpan)&&(f.cells.getCell(y).columnSpan=w.colSpan?6-y<w.colSpan?6-y:w.colSpan:1,m&&w.rowSpan&&w.rowSpan>1&&(f.cells.getCell(y).rowSpan=w.rowSpan?w.rowSpan:1),f.cells.getCell(y).value=x?x.toString():""),""!==x&&(S=!1)}u=w.level>u?w.level:u,C="value"===w.axis,b+=f.cells.getCell(y).columnSpan?f.cells.getCell(y).columnSpan-1:0,y+=f.cells.getCell(y).columnSpan?f.cells.getCell(y).columnSpan-1:0,w.style&&(f=this.applyStyle(f,w,y));T={style:w&&w.isSum?{bold:!0}:void 0,pivotCell:w,cell:f.cells.getCell(y)};this.parent.trigger("onPdfCellRender",T),T.style&&this.processCellStyle(f.cells.getCell(y),T)}else{var T={style:void 0,pivotCell:void 0,cell:f.cells.getCell(y)};this.parent.trigger("onPdfCellRender",T),T.style&&this.processCellStyle(f.cells.getCell(y),T),f.cells.getCell(y).value="",0===b&&m&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0?p.headers.getHeader(0).cells.getCell(0).rowSpan++:0!==b&&m&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&p.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.parent.engineModule.headerContent).length&&p.headers.getHeader(0).cells.getCell(0).rowSpan++}var D=new d.PdfStringFormat;D.paragraphIndent=!m&&0===y&&r[g][b]?15*r[g][b].level:0,D.alignment=C?d.PdfTextAlignment.Right:d.PdfTextAlignment.Left,D.lineAlignment=d.PdfVerticalAlignment.Middle,f.cells.getCell(y).style.stringFormat=D,y++}S&&(f.height=16),c++}p.columns.getColumn(0).width=100+20*u}0===l&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&p.headers.getHeader(0).cells.getCell(0).rowSpan--,p.draw(s,new d.PointF(10,20)),(l+=6)>=o&&e.args.dataCollections.length>i+1&&(i++,o=(r=e.args.dataCollections[i])&&r.length>0?r[0].length:0,l=0)}while(l<o);e.document.save(e.args.fileName+".pdf"),e.document.destroy()},e.prototype.applyStyle=function(e,t,i){var r=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),n=new d.PdfSolidBrush(new d.PdfColor(r.r,r.g,r.b));e.cells.getCell(i).style.backgroundBrush=n;var a=Number(t.style.fontSize.split("px")[0]),o=new d.PdfStandardFont(d.PdfFontFamily.TimesRoman,a,d.PdfFontStyle.Regular);return e.cells.getCell(i).style.font=o,r=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),n=new d.PdfSolidBrush(new d.PdfColor(r.r,r.g,r.b)),e.cells.getCell(i).style.textBrush=n,e},e.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},e.prototype.getFont=function(e){if(e.style.font)return e.style.font;var i=t.isNullOrUndefined(e.style.fontSize)?9.75:.75*e.style.fontSize,r=t.isNullOrUndefined(e.style.fontFamily)?d.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),n=d.PdfFontStyle.Regular;return!t.isNullOrUndefined(e.style.bold)&&e.style.bold&&(n|=d.PdfFontStyle.Bold),!t.isNullOrUndefined(e.style.italic)&&e.style.italic&&(n|=d.PdfFontStyle.Italic),!t.isNullOrUndefined(e.style.underline)&&e.style.underline&&(n|=d.PdfFontStyle.Underline),!t.isNullOrUndefined(e.style.strikeout)&&e.style.strikeout&&(n|=d.PdfFontStyle.Strikeout),new d.PdfStandardFont(r,i,n)},e.prototype.processCellStyle=function(e,i){if(!t.isNullOrUndefined(i.style.backgroundColor)){var r=this.hexDecToRgb(i.style.backgroundColor);e.style.backgroundBrush=new d.PdfSolidBrush(new d.PdfColor(r.r,r.g,r.b))}if(!t.isNullOrUndefined(i.style.textBrushColor)){var n=this.hexDecToRgb(i.style.textBrushColor);e.style.textBrush=new d.PdfSolidBrush(new d.PdfColor(n.r,n.g,n.b))}if(!t.isNullOrUndefined(i.style.textPenColor)){var a=this.hexDecToRgb(i.style.textPenColor);e.style.textPen=new d.PdfPen(new d.PdfColor(a.r,a.g,a.b))}if(t.isNullOrUndefined(i.style.fontFamily)&&t.isNullOrUndefined(i.style.fontSize)&&t.isNullOrUndefined(i.style.bold)&&t.isNullOrUndefined(i.style.italic)&&t.isNullOrUndefined(i.style.underline)&&t.isNullOrUndefined(i.style.strikeout)||(e.style.font=this.getFont(i)),!t.isNullOrUndefined(i.style.border)){var o=new d.PdfBorders,l=i.style.border.width,s=t.isNullOrUndefined(l)||"number"!=typeof l?void 0:.75*l,p=new d.PdfColor(196,196,196);if(!t.isNullOrUndefined(i.style.border.color)){var h=this.hexDecToRgb(i.style.border.color);p=new d.PdfColor(h.r,h.g,h.b)}var c=new d.PdfPen(p,s);t.isNullOrUndefined(i.style.border.dashStyle)||(c.dashStyle=this.getDashStyle(i.style.border.dashStyle)),o.all=c,e.style.borders=o}},e.prototype.applyEvent=function(){if(this.parent.enableVirtualization){var e=this.parent.engineModule.pageSettings;this.parent.engineModule.pageSettings=null,this.parent.engineModule.generateGridData(this.parent.dataSourceSettings),this.parent.engineModule.pageSettings=e}var t={fileName:"default",header:"",footer:"",dataCollections:[JSON.parse(JSON.stringify(this.parent.engineModule.pivotValues))],allowRepeatHeader:!0,style:void 0};return this.parent.trigger("beforeExport",t),this.gridStyle=t.style,{document:new d.PdfDocument,args:t}},e.prototype.destroy=function(){},e}(),ee=function(){function e(e){this.keyConfigs={tab:"tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"tab":this.processTab(e);break;case"enter":this.processEnter(e);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(e);break;case"escape":this.clearSelection()}},e.prototype.getNextButton=function(e){var t=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button")),i=e;if(this.parent.grid.element.querySelector(".e-pivot-button"))for(var r=t.length,n=0;n<r;n++)if(t[n].getAttribute("data-uid")===e.getAttribute("data-uid")){i=t[n+1]?t[n+1]:i;break}return i},e.prototype.processTab=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button")){var r=this.parent.grid.serviceLocator.getService("focus"),n=this.getNextButton(i);if(n.getAttribute("data-uid")!==i.getAttribute("data-uid"))r.currentInfo.skipAction=!0,n.focus();else{r.focus();l=r.getFocusedElement();t.addClass([l],["e-focused","e-focus"]),l.setAttribute("tabindex","0")}return void e.preventDefault()}if(!this.parent.showGroupingBar&&this.parent.showFieldList){if(i&&t.closest(i,".e-toggle-field-list")){(r=this.parent.grid.serviceLocator.getService("focus")).focus();l=r.getFocusedElement();t.addClass([l],["e-focused","e-focus"]),l.setAttribute("tabindex","0")}}else if(!this.parent.showGroupingBar&&!this.parent.showFieldList&&i&&t.closest(i,".e-pivotview")){var a=t.closest(i,".e-pivotview"),r=this.parent.grid.serviceLocator.getService("focus"),o=[].slice.call(a.getElementsByTagName("tr"));if(i.innerHTML===o[o.length-1].lastChild.innerHTML)r.currentInfo.skipAction=!0;else{r.focus();var l=r.getFocusedElement();t.addClass([l],["e-focused","e-focus"]),l.setAttribute("tabindex","0")}}},e.prototype.processEnter=function(e){var i=e.target;if(i&&t.closest(i,".e-grid"))return i.querySelector("."+C)?i.querySelector("."+C).click():i.classList.contains("e-valuescontent")&&i.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),void e.preventDefault()},e.prototype.clearSelection=function(){var e=this.parent;[].slice.call(e.element.querySelectorAll(".e-cellselectionbackground,."+k)).forEach(function(e){e.classList.remove(k),e.classList.remove("e-cellselectionbackground"),e.classList.remove("e-active")}),this.parent.renderModule.selected()},e.prototype.processSelection=function(e){if(this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode){var i,r=e.target,n=this.parent,a=Number(e.target.getAttribute("aria-colIndex")),o=Number(e.target.getAttribute("index"));if("TH"!==r.nodeName&&"TD"!==r.nodeName||(i="shiftUp"===e.action||"upArrow"===e.action?0===o||0===a||"TH"!==r.nodeName&&n.renderModule.rowStartPos!==o?null:this.getParentElement(n,i,a,o-1):"shiftDown"===e.action||"downArrow"===e.action?n.element.querySelector('th[aria-colindex="'+a+'"][index="'+(o+1)+'"]'):"shiftLeft"===e.action||"leftArrow"===e.action?e.target.previousSibling:e.target.nextSibling),t.isNullOrUndefined(i))"upArrow"===e.action?(i=n.element.querySelector('[aria-colindex="'+a+'"][index="'+(o-1)+'"]'),o--):"downArrow"===e.action&&(i=n.element.querySelector('[aria-colindex="'+a+'"][index="'+(o+1)+'"]'),o++),t.isNullOrUndefined(i)||n.clearSelection(i,e,a,o);else if("Both"===n.gridSettings.selectionSettings.mode&&i.classList.contains("e-rowcell"))n.clearSelection(i,e,a,o);else{a=Number(i.getAttribute("aria-colindex")),o=Number(i.getAttribute("index"));var l=Number(i.getAttribute("aria-colspan"));n.clearSelection(i,e,a,o);var s={cancel:!1,isCellClick:!0,currentCell:i,data:n.pivotValues[o][a]};n.trigger("cellSelecting",s,function(t){t.cancel||n.applyColumnSelection(e,i,a,a+(l>0?l-1:0),o)})}}},e.prototype.getParentElement=function(e,t,i,r){for(;!t;)t=e.element.querySelector('[aria-colindex="'+i+'"][index="'+r+'"]'),i--;return t},e.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},e}(),te=function(){function e(e){this.parent=e,this.parent.contextMenuModule=this}return e.prototype.render=function(){this.renderContextMenu()},e.prototype.renderContextMenu=function(){var e={cssClass:"e-pivot-context-menu",items:[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],enableRtl:this.parent.enableRtl,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},i=t.createElement("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(i),this.menuObj=new a.ContextMenu(e),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(i)},e.prototype.onBeforeMenuOpen=function(e){var i=[].slice.call(e.element.querySelectorAll("li")),r=this.fieldElement.querySelector(".e-content").getAttribute("data-type");if(t.removeClass(i,"e-disabled"),"CalculatedField"===r)for(var n=0,a=i;n<a.length;n++){var o=a[n];o.textContent!==this.parent.localeObj.getConstant("addToValue")&&t.addClass([o],"e-disabled")}},e.prototype.onSelectContextMenu=function(e){if(null!==e.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}},e.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy()},e}(),ie=function(){function e(e){this.previousValues={top:0,left:0},this.frozenPreviousValues={top:0,left:0},this.eventType="",this.parent=e,this.addInternalEvents()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.addInternalEvents=function(){this.parent.on(v,this.wireEvents,this)},e.prototype.wireEvents=function(){var e=this.parent.element.querySelector(".e-movablecontent"),i=this.parent.element.querySelector(".e-frozencontent"),r=this.parent.element.querySelector(".e-movableheader");t.EventHandler.clearEvents(e),t.EventHandler.clearEvents(i),this.parent.engineModule&&(t.EventHandler.add(e,"scroll touchmove pointermove",this.onHorizondalScroll(r,e,i),this),t.EventHandler.add(e,"scroll wheel touchmove pointermove",this.onVerticalScroll(i,e),this),t.EventHandler.add(e,"mouseup touchend",this.common(r,e,i),this),t.EventHandler.add(i,"wheel",this.onWheelScroll(e,i),this),t.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(r,e,i),this),t.EventHandler.add(r,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(r,"touchmove pointermove",this.onTouchScroll(r,e,i),this)),this.parent.grid.isPreventScrollEvent=!0},e.prototype.onWheelScroll=function(e,t){var i=this,r=e;return function(e){var n=r.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);i.frozenPreviousValues.top!==n&&(e.preventDefault(),t.scrollTop=n,r.scrollTop=n,i.frozenPreviousValues.top=n,i.eventType=e.type)}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.onTouchScroll=function(e,t,i){var r=this,n=t;return function(t){if("mouse"!==t.pointerType){var a=r.getPointXY(t),o=n.scrollTop+(r.pageXY.y-a.y),l=n.scrollLeft+(r.pageXY.x-a.x);if(r.parent.element.querySelector(".e-headercontent").contains(t.target)){if(r.frozenPreviousValues.left===l||l<0)return;e.scrollLeft=l,n.scrollLeft=l,r.pageXY.x=a.x,r.frozenPreviousValues.left=l}else{if(r.frozenPreviousValues.top===o||o<0)return;i.scrollTop=o,n.scrollTop=o,r.pageXY.y=a.y,r.frozenPreviousValues.top=o}r.eventType=t.type}}},e.prototype.update=function(e,t,i,n,a){if(this.parent.isScrolling=!0,"vertical"===this.direction){var o="row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,l=this.parent.pageSettings.rowSize*o*this.parent.gridSettings.rowHeight,s=Math.ceil(i/l);if(this.parent.scrollPosObject.vertical===s||this.parent.engineModule.pageSettings.rowSize>=this.parent.engineModule.rowCount)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element),this.parent.scrollPosObject.vertical=s,this.parent.engineModule.pageSettings.rowCurrentPage=s>1?s:1,this.parent.engineModule.generateGridData(this.parent.dataSourceSettings,this.parent.engineModule.headerCollection),this.parent.pivotValues=this.parent.engineModule.pivotValues;h=l*(p=Math.ceil(this.parent.engineModule.rowStartPos/(this.parent.pageSettings.rowSize*o)))-this.parent.engineModule.rowFirstLvl*o*this.parent.gridSettings.rowHeight;this.parent.scrollPosObject.verticalSection=h}else{var d="column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,l=this.parent.pageSettings.columnSize*d*this.parent.gridSettings.columnWidth,s=Math.ceil(n/l);if(this.parent.scrollPosObject.horizontal===s)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element),this.parent.scrollPosObject.horizontal=s,this.parent.engineModule.pageSettings.columnCurrentPage=s>1?s:1,this.parent.engineModule.generateGridData(this.parent.dataSourceSettings,this.parent.engineModule.headerCollection),this.parent.pivotValues=this.parent.engineModule.pivotValues;var p=Math.ceil(this.parent.engineModule.colStartPos/(this.parent.pageSettings.columnSize*d)),h=l*p-this.parent.engineModule.colFirstLvl*d*this.parent.gridSettings.columnWidth;this.parent.scrollPosObject.horizontalSection=h}},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.common=function(e,t,i){var r=this;return function(i){r.update(e,t,t.scrollTop*r.parent.verticalScrollScale,t.scrollLeft*r.parent.horizontalScrollScale,i)}},e.prototype.onHorizondalScroll=function(e,i,r){var n,a=this;return function(o){var l=i.scrollLeft*a.parent.horizontalScrollScale;if("wheel"!==o.type&&"touchmove"!==o.type&&"wheel"!==a.eventType&&"touchmove"!==a.eventType||(clearTimeout(n),n=setTimeout(function(){l="touchmove"===o.type?i.scrollLeft:l,a.update(e,i,i.scrollTop*a.parent.verticalScrollScale,l,o)},300)),a.previousValues.left===l)return void(r.scrollTop=i.scrollTop);a.direction="horizondal";var s=-(l-a.parent.scrollPosObject.horizontalSection-i.scrollLeft),d=i.querySelector("."+D).style.transform.split(",")[1].trim();i.scrollLeft<a.parent.scrollerBrowserLimit&&(t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+s+"px,"+d}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+s+"px,0px)"}));var p=a.parent.scrollPosObject.horizontalSection>l?-(a.parent.scrollPosObject.horizontalSection-l):l+e.offsetWidth-(a.parent.scrollPosObject.horizontalSection+i.querySelector(".e-table").offsetWidth),h=Math.ceil(a.parent.scrollPosObject.horizontalSection/a.parent.horizontalScrollScale)<a.parent.scrollerBrowserLimit;if(a.parent.scrollPosObject.horizontalSection>l||p>1&&h){l>e.clientWidth?(a.parent.scrollPosObject.left<1&&(a.parent.scrollPosObject.left=e.clientWidth),a.parent.scrollPosObject.left=a.parent.scrollPosObject.left-50,p=a.parent.scrollPosObject.horizontalSection>l?p-a.parent.scrollPosObject.left:p+a.parent.scrollPosObject.left):p=-a.parent.scrollPosObject.horizontalSection,s=-(l-(a.parent.scrollPosObject.horizontalSection+p)-i.scrollLeft);var c=a.parent.gridSettings.columnWidth*a.parent.engineModule.columnCount-a.parent.grid.columns[0].width;c>a.parent.scrollerBrowserLimit&&(a.parent.horizontalScrollScale=c/a.parent.scrollerBrowserLimit,c=a.parent.scrollerBrowserLimit),s>c&&s>l&&(s=l,p=0),t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+s+"px,"+d}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+s+"px,0px)"}),a.parent.scrollPosObject.horizontalSection=a.parent.scrollPosObject.horizontalSection+p}a.previousValues.left=l,a.frozenPreviousValues.left=l,a.eventType="",e.scrollLeft=i.scrollLeft}},e.prototype.onVerticalScroll=function(e,i){var r,n=this;return function(a){var o=i.scrollTop*n.parent.verticalScrollScale;if("wheel"!==a.type&&"touchmove"!==a.type&&"wheel"!==n.eventType&&"touchmove"!==n.eventType||(clearTimeout(r),r=setTimeout(function(){n.update(null,i,i.scrollTop*n.parent.verticalScrollScale,i.scrollLeft*n.parent.horizontalScrollScale,a)},300)),n.previousValues.top!==o){n.direction="vertical";var l=-(o-n.parent.scrollPosObject.verticalSection-i.scrollTop),s=i.querySelector("."+D).style.transform.split(",")[0].trim();i.scrollTop<n.parent.scrollerBrowserLimit&&(t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+l+"px)"}),t.setStyleAttribute(i.querySelector(".e-table"),{transform:s+","+l+"px)"}));var d=n.parent.scrollPosObject.verticalSection>o?-(n.parent.scrollPosObject.verticalSection-o):o+e.clientHeight-(n.parent.scrollPosObject.verticalSection+e.querySelector(".e-table").offsetHeight),p=Math.ceil(n.parent.scrollPosObject.verticalSection/n.parent.verticalScrollScale)<n.parent.scrollerBrowserLimit;if(n.parent.scrollPosObject.verticalSection>o||d>1&&p){o>e.clientHeight?(n.parent.scrollPosObject.top<1&&(n.parent.scrollPosObject.top=e.clientHeight),n.parent.scrollPosObject.top=n.parent.scrollPosObject.top-50,d=n.parent.scrollPosObject.verticalSection>o?d-n.parent.scrollPosObject.top:d+n.parent.scrollPosObject.top):d=-n.parent.scrollPosObject.verticalSection;var h=n.parent.element.querySelector(".e-movablecontent").querySelector(".e-table");l=-(o-(n.parent.scrollPosObject.verticalSection+d)-i.scrollTop);var c=n.parent.gridSettings.rowHeight*n.parent.engineModule.rowCount+.1-h.clientHeight;c>n.parent.scrollerBrowserLimit&&(n.parent.verticalScrollScale=c/n.parent.scrollerBrowserLimit,c=n.parent.scrollerBrowserLimit),l>c&&l>o&&(l=o,d=0),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+l+"px)"}),t.setStyleAttribute(i.querySelector(".e-table"),{transform:s+","+l+"px)"}),n.parent.scrollPosObject.verticalSection=n.parent.scrollPosObject.verticalSection+d}n.previousValues.top=o,n.frozenPreviousValues.top=o,n.eventType="",e.scrollTop=i.scrollTop,i.scrollTop=e.scrollTop}}},e.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(v,this.wireEvents)},e.prototype.destroy=function(){this.removeInternalEvents()},e}(),re=function(){function e(e){this.isUpdated=!1,this.gridIndexObjects={},this.parent=e}return e.prototype.showDrillThroughDialog=function(e){var i=this;this.removeDrillThroughDialog();var n=t.createElement("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog",styles:"visibility:hidden;"});this.parent.element.appendChild(n),this.dialogPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(e),beforeOpen:function(){i.drillThroughGrid.setProperties({dataSource:i.parent.editSettings.allowEditing?i.dataWithPrimarykey(e):e.rawData,height:300},!0),i.drillThroughGrid.enableVirtualization=!i.parent.editSettings.allowEditing},beforeClose:function(){if(i.parent.editSettings.allowEditing&&i.isUpdated){for(var e=Object.keys(i.gridIndexObjects).length,r=[],n=0,a=i.drillThroughGrid.dataSource;n<a.length;n++){var o=a[n];if(t.isNullOrUndefined(o.__index)||""===o.__index){for(var l=0,s=i.parent.engineModule.fields;l<s.length;l++){var d=s[l];t.isNullOrUndefined(o[d])&&delete o[d]}delete o.__index,r.push(o)}else e>0&&(delete i.gridIndexObjects[o.__index.toString()],e--)}e=0;for(var p=[],h=0,c=i.parent.engineModule.data;h<c.length;h++)delete(o=c[h]).__index,void 0===i.gridIndexObjects[e.toString()]&&p.push(o),e++;p=p.concat(r),i.parent.setProperties({dataSourceSettings:{dataSource:p}},!0),i.parent.engineModule.updateGridData(i.parent.dataSourceSettings),i.parent.pivotValues=i.parent.engineModule.pivotValues}i.isUpdated=!1,i.gridIndexObjects={}},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!0,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(n),this.dialogPopUp.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("details"),t.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"})},e.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy();var e=document.getElementById(this.parent.element.id+"_drillthrough");e&&t.remove(e),document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&t.remove(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},e.prototype.createDrillThroughGrid=function(e){var i=t.createElement("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),r=t.createElement("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"});if(""!==e.rowHeaders&&(r.innerHTML="<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("row")+"</span> :<span class=e-drillthrough-body-header-value>"+e.rowHeaders+"</span></span>"),""!==e.columnHeaders&&(r.innerHTML=r.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("column")+"</span> :<span class=e-drillthrough-body-header-value>"+e.columnHeaders+"</span></span>"),""!==e.value){var a=e.value.split("(")[0],o=e.value.split("(")[1].split(")")[0];"0"!==o&&(r.innerHTML=r.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+a+"</span> :<span class=e-drillthrough-body-header-value>"+o+"</span></span>")}var l=["ColumnChooser"];this.parent.editSettings.allowEditing&&(l=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]);var s=t.createElement("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"});n.Grid.Inject(n.Selection,n.Reorder,n.Resize,n.Toolbar,n.ColumnChooser),this.drillThroughGrid=new n.Grid({gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,toolbar:l,columns:this.frameGridColumns(),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing});var d=this;return this.parent.trigger("beginDrillThrough",{cellInfo:e,gridObj:this.drillThroughGrid,type:"editing"}),this.parent.editSettings.allowEditing?(n.Grid.Inject(n.Edit,n.Page),this.drillThroughGrid.editSettings=this.parent.editSettings,this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,n.Grid.Inject(n.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1}),this.drillThroughGrid.actionComplete=function(e){"batchsave"!==e.requestType&&"save"!==e.requestType&&"delete"!==e.requestType||(d.isUpdated=!0),("Normal"===d.drillThroughGrid.editSettings.mode&&"save"===e.requestType&&d.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!d.parent.editSettings.allowCommandColumns||"batchsave"===e.requestType)&&d.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=function(){d.isUpdated=!0}):n.Grid.Inject(n.VirtualScroll),document.body.appendChild(s),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(s),i.appendChild(r),i.appendChild(s),i},e.prototype.frameGridColumns=function(){for(var e=[],t=0,i=Object.keys(this.parent.engineModule.fieldList);t<i.length;t++){var r=i[t];if("CalculatedField"!==this.parent.engineModule.fieldList[r].aggregateType){var n="";n="number"===this.parent.engineModule.fieldList[r].type?"numericedit":"date"===this.parent.engineModule.fieldList[r].type?"datepickeredit":"",e.push({field:r,headerText:this.parent.engineModule.fieldList[r].caption,width:120,visible:this.parent.engineModule.fieldList[r].isSelected,validationRules:{required:!0},editType:n,type:"string"})}}return e},e.prototype.dataWithPrimarykey=function(e){for(var t=Object.keys(e.currentCell.indexObject),i=e.rawData,r=0,n=0,a=i;n<a.length;n++)a[n].__index=t[r],this.gridIndexObjects[t[r].toString()]=Number(t[r]),r++;return i},e}(),ne=function(){function e(e){this.parent=e,this.drillThroughDialog=new re(this.parent),this.addInternalEvents()}return e.prototype.getModuleName=function(){return"drillthrough"},e.prototype.addInternalEvents=function(){this.parent.on(v,this.wireEvents,this)},e.prototype.wireEvents=function(){this.unWireEvents(),t.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},e.prototype.unWireEvents=function(){t.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},e.prototype.mouseClickHandler=function(e){var t=e.target,i=null;t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")?i=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),i&&(this.parent.allowDrillThrough&&i.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing)&&this.executeDrillThrough(i)},e.prototype.executeDrillThrough=function(e){var t=Number(e.getAttribute("aria-colindex")),i=Number(e.getAttribute("index")),r=this.parent.pivotValues[i][t],n=this.parent.engineModule.fieldList[r.actualText.toString()]?this.parent.engineModule.fieldList[r.actualText.toString()].caption:r.actualText.toString(),a=[];if(void 0!==r.rowHeaders&&void 0!==r.columnHeaders&&void 0!==r.value){for(var o=0,l=Object.keys(r.indexObject);o<l.length;o++){var s=l[o];a.push(this.parent.engineModule.data[Number(s)])}var d=this.parent.engineModule.fieldList[r.actualText].aggregateType,p="CalculatedField"===d?n.toString():d+" of "+n,h={currentTarget:e,currentCell:r,rawData:a,rowHeaders:""===r.rowHeaders?"":r.rowHeaders.toString().split(".").join(" - "),columnHeaders:""===r.columnHeaders?"":r.columnHeaders.toString().split(".").join(" - "),value:p+"("+r.formattedText+")"};this.parent.trigger("drillThrough",h),this.drillThroughDialog.showDrillThroughDialog(h)}},e}(),ae=function(){function e(){this.headerColl={},this.maxLevel=0,this.columnGroupObject={}}return e.prototype.getModuleName=function(){return"pivotchart"},e.prototype.loadChart=function(e,t){if(this.parent=e,this.engineModule=this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=t,!(this.dataSourceSettings.values.length>0))return this.parent.chart?(this.parent.chart.series=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=1,void this.parent.chart.refresh()):void this.parent.notify(v,{});this.chartSettings.enableMultiAxis?this.measureList=this.dataSourceSettings.values.map(function(e){return e.name}):this.measureList=[""===t.value?this.dataSourceSettings.values[0].name:t.value],this.columnGroupObject={};var i=this.parent.engineModule.pivotValues;this.currentMeasure=t.enableMultiAxis?this.measureList[0]:(""===t.value||0===this.dataSourceSettings.values.filter(function(e){return e.name===t.value}).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:t.value;var r,n=this.getColumnTotalIndex(i),a=Object.keys(i),o=-.5;this.headerColl={},this.maxLevel=0;for(var l,s=0,d=a;s<d.length;s++){var p=d[s],h=Number(p);if(i[h][0]&&"row"===i[h][0].axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==i[h][0].type)){var c=i[h][0];"value"!==c.type&&(void 0===r||r<c.level||o++,r=c.level),this.maxLevel=c.level>this.maxLevel?c.level:this.maxLevel;var u=c.actualText?c.actualText.toString():c.formattedText.toString(),g={name:u,text:c.hasChild?(c.isDrilled?" - ":" + ")+u:u,hasChild:c.hasChild,isDrilled:c.isDrilled,levelName:c.valueSort.levelName.toString(),level:c.level,fieldName:c.valueSort.axis?c.valueSort.axis.toString():"",rowIndex:h,colIndex:0};"value"!==c.type&&(this.headerColl[o]?this.headerColl[o][c.level]=g:(this.headerColl[o]={},this.headerColl[o][c.level]=g));var m=void 0;l="value"!==c.type?c:l;for(var f=i[h],y=0,S=Object.keys(f);y<S.length;y++){var b=S[y],C=Number(b),w=i[h][C],x=""!==w.rowHeaders||0===this.dataSourceSettings.rows.length;if(!n[w.colIndex]&&"value"===w.axis&&(t.enableMultiAxis||w.actualText===this.currentMeasure)){if(("value"===c.type&&m?m.members.length>0:c.members.length>0)||!x)break;var T=w.columnHeaders.toString().split(".").join(" - ")+" | "+w.actualText;this.columnGroupObject[T]?this.columnGroupObject[T].push({x:0===this.dataSourceSettings.rows.length?c.formattedText:w.rowHeaders.toString().split(".").join(" - "),y:Number(w.value)}):this.columnGroupObject[T]=[{x:0===this.dataSourceSettings.rows.length?c.formattedText:w.rowHeaders.toString().split(".").join(" - "),y:Number(w.value)}]}m=l}}}this.refreshChart()},e.prototype.refreshChart=function(){this.chartSeries=[];var e=Object.keys(this.columnGroupObject);this.persistSettings=JSON.parse(this.parent.getPersistData()).chartSettings;for(var i=0,r=e;i<r.length;i++){var n=r[i],a={};(a=this.persistSettings.chartSeries?this.frameObjectWithKeys(this.persistSettings.chartSeries):a).dataSource=this.columnGroupObject[n],a.xName="x",a.yName="y",a.name=this.chartSettings.enableMultiAxis?n:n.split(" | ")[0],"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(a.yAxisName=n.split(" | ")[1]),this.chartSeries=this.chartSeries.concat(a)}var o={series:this.chartSeries,cancel:!1};this.parent.trigger("chartSeriesCreated",o),o.cancel?(this.element&&t.remove(this.element),this.parent.notify(v,{})):this.bindChart()},e.prototype.frameObjectWithKeys=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=e[t[i]],i++;return r},e.prototype.bindChart=function(){var e=this.configXAxis(),i=this.configTooltipSettings(),r=this.configLegendSettings(),n=this.configZoomSettings(),a=this.frameAxesWithRows(),o=this.chartSettings.chartSeries.type;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:t.createElement("div",{className:"e-pivotchart",id:this.parent.element.id+"_chart"}),this.parent.element.querySelector(".e-grid")):this.parent.element.appendChild(this.element?this.element:t.createElement("div",{className:"e-pivotchart",id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild(t.createElement("div",{className:"e-pivotchart",id:this.parent.element.id+"_chart"}))),this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=this.chartSeries,this.parent.chart.primaryXAxis=e,"Polar"===o||"Radar"===o?(this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=a.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.axes=a.axes,this.parent.chart.rows=a.rows),this.parent.chart.refresh()):(this.parent.showGroupingBar?this.element.style.minWidth="400px !important":this.element.style.minWidth="310px !important",p.Chart.Inject(p.ColumnSeries,p.StackingColumnSeries,p.RangeColumnSeries,p.BarSeries,p.StackingBarSeries,p.ScatterSeries,p.BubbleSeries,p.LineSeries,p.StepLineSeries,p.SplineSeries,p.SplineAreaSeries,p.MultiColoredLineSeries,p.PolarSeries,p.RadarSeries,p.AreaSeries,p.RangeAreaSeries,p.StackingAreaSeries,p.StepAreaSeries,p.MultiColoredAreaSeries,p.ParetoSeries,p.Legend,p.Tooltip,p.Category,p.MultiLevelLabel,p.ScrollBar,p.Zoom,p.Export,p.Crosshair),this.parent.chart=new p.Chart({series:this.chartSeries,legendSettings:r,tooltip:i,zoomSettings:n,axes:"Polar"===o||"Radar"===o?[]:a.axes,rows:"Polar"===o||"Radar"===o?[{}]:a.rows,primaryYAxis:"Polar"===o||"Radar"===o?a.axes[0]:{visible:!1},primaryXAxis:e,width:this.parent.width.toString(),height:this.parent.height.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:this.chartSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.chartSettings.pointClick?this.chartSettings.pointClick.bind(this):void 0,chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,dragComplete:this.chartSettings.dragComplete?this.chartSettings.dragComplete.bind(this):void 0,zoomComplete:this.chartSettings.zoomComplete?this.chartSettings.zoomComplete.bind(this):void 0,scrollStart:this.chartSettings.scrollStart?this.chartSettings.scrollStart.bind(this):void 0,scrollEnd:this.chartSettings.scrollEnd?this.chartSettings.scrollEnd.bind(this):void 0,scrollChanged:this.chartSettings.scrollChanged?this.chartSettings.scrollChanged.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this)}),this.parent.chart.isStringTemplate=!0,this.parent.chart.appendTo("#"+this.parent.element.id+"_chart"))},e.prototype.frameAxesWithRows=function(){var e=this,t=[],i=[],r=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type);if(this.chartSettings.enableMultiAxis)for(var n=0,a=100/this.dataSourceSettings.values.length+"%",o=this,l=0,s=this.dataSourceSettings.values;l<s.length;l++)!function(e){var l=o.engineModule.fieldList[e.name],s=o.parent.localeObj.getConstant(l.aggregateType)+" of "+l.caption,d=o.dataSourceSettings.formatSettings.filter(function(t){return t.name===e.name})[0],p="Polar"===o.chartSettings.chartSeries.type||"Radar"===o.chartSettings.chartSeries.type,h={};(h=o.persistSettings.primaryYAxis?o.frameObjectWithKeys(o.persistSettings.primaryYAxis):h).labelFormat=h.labelFormat?h.labelFormat:r?"":d&&!p?d.format:"N",h.title=h.title?h.title:s,h.plotOffset=h.plotOffset?h.plotOffset:n%2!=0?30:0,h.rowIndex=n,p||(h.name=e.name),t=t.concat(h),i.push({height:a}),n++}(s[l]);else{var d=this.engineModule.fieldList[this.currentMeasure],p=this.parent.localeObj.getConstant(d.aggregateType)+" of "+d.caption,h=this.dataSourceSettings.formatSettings.filter(function(t){return t.name===e.currentMeasure})[0],c={};(c=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):c).rowIndex=0,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(c.name=this.currentMeasure),c.labelFormat=c.labelFormat?c.labelFormat:r?"":h?h.format:"N",c.title=c.title?c.title:p,t=t.concat(c),i.push({height:"100%"})}return{axes:t,rows:i}},e.prototype.getColumnTotalIndex=function(e){for(var t={},i=0,r=Object.keys(e);i<r.length;i++)for(var n=r[i],a=e[Number(n)],o=0,l=Object.keys(a);o<l.length;o++){var s=l[o],d=a[Number(s)];if("column"!==d.axis)return t;("sum"===d.type||0!==this.dataSourceSettings.columns.length&&"grand sum"===d.type)&&-1!==d.rowSpan&&(t[d.colIndex]=d.colIndex)}return t},e.prototype.frameMultiLevelLabels=function(){for(var e=Object.keys(this.headerColl),t=this.headerColl[-.5],i=0,r=e;i<r.length;i++){for(var n=r[i],a=Number(n),o=this.headerColl[a],l=0,s=!1;l<=this.maxLevel;)s?o[l]||(o[l]={name:o[l-1].name,text:"",hasChild:o[l-1].hasChild,isDrilled:o[l-1].isDrilled,levelName:o[l-1].levelName,level:o[l-1].level,fieldName:o[l-1].fieldName,rowIndex:o[l-1].rowIndex,colIndex:o[l-1].colIndex,span:-1}):o[l]?s=!0:o[l]=t[l],l++;t=this.headerColl[a]}for(var d={},p=0,h=e;p<h.length;p++){for(var n=h[p],a=Number(n),o=this.headerColl[a],c=0,u=Object.keys(o);c<u.length;c++){var g=u[c],m=Number(g);if(d[m]){var v=d[m].length;o[m].levelName===t[m].levelName?d[m][v-1].end=d[m][v-1].end+1:d[m].push({start:a,end:a+1,text:o[m].text,type:-1===o[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:o[m]})}else d[m]=[{start:a,end:a+1,text:o[m].text,type:-1===o[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:o[m]}]}t=o}for(var f=[],y=Object.keys(d).length-1;y>-1;y--)f.push({categories:d[y],border:{width:1},overflow:"Trim"});return f},e.prototype.getZoomFactor=function(){isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.calculatedWidth=this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?this.calculatedWidth=Number(this.parent.width.toString().split("px")[0]):this.calculatedWidth=this.parent.element.clientWidth:this.calculatedWidth=Number(this.parent.width);var e=10*this.chartSeries.length>120?10*this.chartSeries.length:120,t=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*e):1;return t=t<1&&t>0?t:1},e.prototype.configTooltipSettings=function(){var e=this.chartSettings.tooltip;return e.enable=void 0===e.enable||e.enable,e.header=e.header?e.header:"",e.enableMarker=void 0===e.enableMarker||e.enableMarker,e},e.prototype.configLegendSettings=function(){var e={};return e=this.chartSettings.legendSettings?this.chartSettings.legendSettings:e,e.padding=e.padding?e.padding:25,e.shapePadding=e.shapePadding?e.shapePadding:10,e},e.prototype.configXAxis=function(){var e={};return e=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):e,e.valueType="Category",e.labelIntersectAction=e.labelIntersectAction?e.labelIntersectAction:"Rotate45",e.title=e.title?e.title:this.dataSourceSettings.rows.map(function(e){return e.caption||e.name}).join(" / "),e.zoomFactor=this.getZoomFactor(),this.chartSettings.showMultiLevelLabels&&(e.multiLevelLabels=this.frameMultiLevelLabels(),e.border={width:1,type:"WithoutTopandBottomBorder"},e.majorTickLines={width:0,height:-10}),e},e.prototype.configZoomSettings=function(){var e=this.chartSettings.zoomSettings;return e.enableSelectionZooming=void 0===e.enableSelectionZooming||e.enableSelectionZooming,e.enableScrollbar=void 0===e.enableScrollbar||e.enableScrollbar,e},e.prototype.tooltipRender=function(e){var t=this.engineModule.fieldList[e.series.yAxisName?e.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultiAxis?e.series.name.split(" | ")[1]:this.currentMeasure],i=this.parent.localeObj.getConstant(t.aggregateType)+" of "+t.caption,r=this.engineModule.formatFields[t.id]&&this.chartSettings.useGroupingSeparator?this.parent.engineModule.getFormattedValue(e.point.y,t.id).formattedText:e.text.split("<b>")[1].split("</b>")[0];e.text=i+": "+r+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+e.series.name.split(" | ")[0])+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+e.point.x),this.parent.trigger("chartTooltipRender",e)},e.prototype.loaded=function(e){if(this.parent.isChartLoaded=!0,this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels){var i=u.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0";t.isNullOrUndefined(this.parent.element.querySelector("#"+this.parent.element.id+i))||this.parent.element.querySelector("#"+this.parent.element.id+i).setAttribute("cursor","pointer")}this.parent.notify(v,{}),this.parent.trigger("chartLoaded",e)},e.prototype.axisLabelRender=function(e){this.chartSettings.showMultiLevelLabels&&"primaryXAxis"===e.axis.name&&(e.text=""),this.parent.trigger("chartAxisLabelRender",e)},e.prototype.multiLevelLabelClick=function(e){e.customAttributes&&e.customAttributes.hasChild&&this.onDrill(e)},e.prototype.onDrill=function(e){var t=e.customAttributes,i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",n=t.fieldName,a=this.engineModule.pivotValues[t.rowIndex][t.colIndex],o=a.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),l=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:n,items:[o],delimiter:i}]}},!0);else{for(var s=0;s<this.dataSourceSettings.drilledMembers.length;s++){var d=this.dataSourceSettings.drilledMembers[s];if(o=o.split(i).join(d.delimiter?d.delimiter:i),i=d.delimiter=d.delimiter?d.delimiter:i,d.name===n){l=!0;var p=d.items.indexOf(o);p>-1?d.items.splice(p,1):d.items.push(o)}}l||this.dataSourceSettings.drilledMembers.push({name:n,items:[o],delimiter:i})}r.showSpinner(this.parent.element);var h={fieldName:n,memberName:o,delimiter:i,axis:"row",action:t.isDrilled?"up":"down",currentCell:a};this.parent.trigger("drill",{drillInfo:h,pivotview:this}),this.parent.enableVirtualization?(this.engineModule.drilledMembers=this.dataSourceSettings.drilledMembers,this.engineModule.onDrill(h)):this.engineModule.generateGridData(this.dataSourceSettings),this.parent.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.parent.renderPivotGrid()},e.prototype.load=function(e){e.chart.zoomModule&&(e.chart.zoomModule.isZoomed=!0),this.parent.trigger("chartLoad",e)},e.prototype.resized=function(e){e.chart.primaryXAxis.zoomFactor=this.getZoomFactor(),this.parent.trigger("chartResized",e)},e.prototype.destroy=function(){},e}(),oe=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),le=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},se=(function(){function e(){}le([t.Property("")],e.prototype,"color",void 0),le([t.Property(1)],e.prototype,"width",void 0)}(),function(){function e(){}le([t.Property(!0)],e.prototype,"enable",void 0),le([t.Property(1e3)],e.prototype,"duration",void 0),le([t.Property(0)],e.prototype,"delay",void 0)}(),function(){function e(){}le([t.Property(null)],e.prototype,"value",void 0),le([t.Property(null)],e.prototype,"color",void 0),le([t.Property("0")],e.prototype,"dashArray",void 0)}(),function(){function e(){}le([t.Property(!1)],e.prototype,"visible",void 0),le([t.Property("Circle")],e.prototype,"shape",void 0),le([t.Property("")],e.prototype,"imageUrl",void 0),le([t.Property(5)],e.prototype,"height",void 0),le([t.Property(5)],e.prototype,"width",void 0),le([t.Complex({width:2,color:null},p.Border)],e.prototype,"border",void 0),le([t.Property(null)],e.prototype,"fill",void 0),le([t.Property(1)],e.prototype,"opacity",void 0),le([t.Complex({},p.DataLabelSettings)],e.prototype,"dataLabel",void 0)}(),function(){function e(){}le([t.Property(!1)],e.prototype,"visible",void 0),le([t.Property("Fixed")],e.prototype,"type",void 0),le([t.Property("Both")],e.prototype,"direction",void 0),le([t.Property("Vertical")],e.prototype,"mode",void 0),le([t.Property(null)],e.prototype,"color",void 0),le([t.Property(1)],e.prototype,"verticalError",void 0),le([t.Property(1)],e.prototype,"width",void 0),le([t.Property(1)],e.prototype,"horizontalError",void 0),le([t.Property(3)],e.prototype,"verticalPositiveError",void 0),le([t.Property(3)],e.prototype,"verticalNegativeError",void 0),le([t.Property(1)],e.prototype,"horizontalPositiveError",void 0),le([t.Property(1)],e.prototype,"horizontalNegativeError",void 0),le([t.Complex(null,p.ErrorBarCapSettings)],e.prototype,"errorBarCap",void 0)}(),function(){function e(){}le([t.Property("")],e.prototype,"name",void 0),le([t.Property("Linear")],e.prototype,"type",void 0),le([t.Property(2)],e.prototype,"period",void 0),le([t.Property(2)],e.prototype,"polynomialOrder",void 0),le([t.Property(0)],e.prototype,"backwardForecast",void 0),le([t.Property(0)],e.prototype,"forwardForecast",void 0),le([t.Complex({},p.Animation)],e.prototype,"animation",void 0),le([t.Complex({},p.MarkerSettings)],e.prototype,"marker",void 0),le([t.Property(!0)],e.prototype,"enableTooltip",void 0),le([t.Property(null)],e.prototype,"intercept",void 0),le([t.Property("")],e.prototype,"fill",void 0),le([t.Property(1)],e.prototype,"width",void 0),le([t.Property("SeriesType")],e.prototype,"legendShape",void 0)}(),function(){function e(){}le([t.Property(null)],e.prototype,"fill",void 0),le([t.Complex({color:"transparent",width:0},p.Border)],e.prototype,"border",void 0),le([t.Property("Gap")],e.prototype,"mode",void 0)}(),function(){function e(){}le([t.Property(0)],e.prototype,"topLeft",void 0),le([t.Property(0)],e.prototype,"topRight",void 0),le([t.Property(0)],e.prototype,"bottomLeft",void 0),le([t.Property(0)],e.prototype,"bottomRight",void 0)}(),function(){function e(){}le([t.Property("Normal")],e.prototype,"fontStyle",void 0),le([t.Property("16px")],e.prototype,"size",void 0),le([t.Property("Normal")],e.prototype,"fontWeight",void 0),le([t.Property("")],e.prototype,"color",void 0),le([t.Property("Center")],e.prototype,"textAlignment",void 0),le([t.Property("Segoe UI")],e.prototype,"fontFamily",void 0),le([t.Property(1)],e.prototype,"opacity",void 0),le([t.Property("Trim")],e.prototype,"textOverflow",void 0)}(),function(){function e(){}le([t.Property(!1)],e.prototype,"enable",void 0),le([t.Property(null)],e.prototype,"fill",void 0),le([t.Complex(p.Theme.crosshairLabelFont,p.Font)],e.prototype,"textStyle",void 0)}(),function(){function e(){}le([t.Property(1)],e.prototype,"width",void 0),le([t.Property(5)],e.prototype,"height",void 0),le([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}le([t.Property(1)],e.prototype,"width",void 0),le([t.Property("")],e.prototype,"dashArray",void 0),le([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}le([t.Property(.7)],e.prototype,"width",void 0),le([t.Property(5)],e.prototype,"height",void 0),le([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}le([t.Property(.7)],e.prototype,"width",void 0),le([t.Property("")],e.prototype,"dashArray",void 0),le([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}le([t.Property(1)],e.prototype,"width",void 0),le([t.Property("")],e.prototype,"dashArray",void 0),le([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}le([t.Property(!0)],e.prototype,"visible",void 0),le([t.Property(!1)],e.prototype,"startFromAxis",void 0),le([t.Property(null)],e.prototype,"start",void 0),le([t.Property(null)],e.prototype,"end",void 0),le([t.Property(null)],e.prototype,"size",void 0),le([t.Property("#808080")],e.prototype,"color",void 0),le([t.Property(null)],e.prototype,"dashArray",void 0),le([t.Property("Auto")],e.prototype,"sizeType",void 0),le([t.Property(!1)],e.prototype,"isRepeat",void 0),le([t.Property(null)],e.prototype,"repeatEvery",void 0),le([t.Property(null)],e.prototype,"repeatUntil",void 0),le([t.Property(!1)],e.prototype,"isSegmented",void 0),le([t.Property(null)],e.prototype,"segmentStart",void 0),le([t.Property(null)],e.prototype,"segmentEnd",void 0),le([t.Property(null)],e.prototype,"segmentAxisName",void 0),le([t.Complex({color:"transparent",width:1},p.Border)],e.prototype,"border",void 0),le([t.Property("")],e.prototype,"text",void 0),le([t.Property(null)],e.prototype,"rotation",void 0),le([t.Property("Middle")],e.prototype,"horizontalAlignment",void 0),le([t.Property("Middle")],e.prototype,"verticalAlignment",void 0),le([t.Complex(p.Theme.stripLineLabelFont,p.Font)],e.prototype,"textStyle",void 0),le([t.Property("Behind")],e.prototype,"zIndex",void 0),le([t.Property(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}le([t.Property("")],e.prototype,"color",void 0),le([t.Property(1)],e.prototype,"width",void 0),le([t.Property("Rectangle")],e.prototype,"type",void 0)}(),function(){function e(){}le([t.Complex({},p.Border)],e.prototype,"border",void 0),le([t.Property("transparent")],e.prototype,"background",void 0),le([t.Property(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}le([t.Property(!1)],e.prototype,"enable",void 0),le([t.Property("")],e.prototype,"dashArray",void 0),le([t.Complex({color:null,width:1},p.Border)],e.prototype,"line",void 0),le([t.Property("Both")],e.prototype,"lineType",void 0)}(),function(){function e(){}le([t.Property(!0)],e.prototype,"visible",void 0),le([t.Property(null)],e.prototype,"height",void 0),le([t.Property(null)],e.prototype,"width",void 0),le([t.Complex({x:0,y:0},Location)],e.prototype,"location",void 0),le([t.Property("Auto")],e.prototype,"position",void 0),le([t.Property(8)],e.prototype,"padding",void 0),le([t.Property("Center")],e.prototype,"alignment",void 0),le([t.Complex(p.Theme.legendLabelFont,p.Font)],e.prototype,"textStyle",void 0),le([t.Property(10)],e.prototype,"shapeHeight",void 0),le([t.Property(10)],e.prototype,"shapeWidth",void 0),le([t.Complex({},p.Border)],e.prototype,"border",void 0),le([t.Complex({left:0,right:0,top:0,bottom:0},p.Margin)],e.prototype,"margin",void 0),le([t.Property(5)],e.prototype,"shapePadding",void 0),le([t.Property("transparent")],e.prototype,"background",void 0),le([t.Property(1)],e.prototype,"opacity",void 0),le([t.Property(!0)],e.prototype,"toggleVisibility",void 0),le([t.Property(null)],e.prototype,"description",void 0),le([t.Property(3)],e.prototype,"tabIndex",void 0)}(),function(){function e(){}le([t.Property(0)],e.prototype,"series",void 0),le([t.Property(0)],e.prototype,"point",void 0)}(),function(){function e(){}le([t.Property(10)],e.prototype,"left",void 0),le([t.Property(10)],e.prototype,"right",void 0),le([t.Property(10)],e.prototype,"top",void 0),le([t.Property(10)],e.prototype,"bottom",void 0)}(),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return oe(i,e),le([t.Property(null)],i.prototype,"fill",void 0),le([t.Complex(null,p.Animation)],i.prototype,"animation",void 0),le([t.Property("0")],i.prototype,"dashArray",void 0),le([t.Property(1)],i.prototype,"width",void 0),le([t.Property("X")],i.prototype,"segmentAxis",void 0),le([t.Property("Line")],i.prototype,"drawType",void 0),le([t.Property(!0)],i.prototype,"isClosed",void 0),le([t.Collection([],p.ChartSegment)],i.prototype,"segments",void 0),le([t.Property("")],i.prototype,"stackingGroup",void 0),le([t.Complex({color:"transparent",width:0},p.Border)],i.prototype,"border",void 0),le([t.Property(!0)],i.prototype,"visible",void 0),le([t.Property(1)],i.prototype,"opacity",void 0),le([t.Property("Line")],i.prototype,"type",void 0),le([t.Complex(null,p.MarkerSettings)],i.prototype,"marker",void 0),le([t.Complex(null,p.ErrorBarSettings)],i.prototype,"errorBar",void 0),le([t.Property(!0)],i.prototype,"enableTooltip",void 0),le([t.Collection([],p.Trendline)],i.prototype,"trendlines",void 0),le([t.Property("")],i.prototype,"tooltipMappingName",void 0),le([t.Property("SeriesType")],i.prototype,"legendShape",void 0),le([t.Property(1)],i.prototype,"minRadius",void 0),le([t.Property(null)],i.prototype,"selectionStyle",void 0),le([t.Property("Natural")],i.prototype,"splineType",void 0),le([t.Property(3)],i.prototype,"maxRadius",void 0),le([t.Property(.5)],i.prototype,"cardinalSplineTension",void 0),le([t.Property(null)],i.prototype,"columnWidth",void 0),le([t.Complex(null,p.EmptyPointSettings)],i.prototype,"emptyPointSettings",void 0),le([t.Complex(null,p.CornerRadius)],i.prototype,"cornerRadius",void 0),le([t.Property(0)],i.prototype,"columnSpacing",void 0),i}(t.ChildProperty)),de=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return oe(i,e),le([t.Property("Rotate45")],i.prototype,"labelIntersectAction",void 0),le([t.Complex(p.Theme.axisLabelFont,p.Font)],i.prototype,"labelStyle",void 0),le([t.Property("")],i.prototype,"title",void 0),le([t.Complex({},p.CrosshairTooltip)],i.prototype,"crosshairTooltip",void 0),le([t.Property("")],i.prototype,"labelFormat",void 0),le([t.Complex(p.Theme.axisTitleFont,p.Font)],i.prototype,"titleStyle",void 0),le([t.Property(!1)],i.prototype,"isIndexed",void 0),le([t.Property(0)],i.prototype,"plotOffset",void 0),le([t.Property("None")],i.prototype,"edgeLabelPlacement",void 0),le([t.Property("BetweenTicks")],i.prototype,"labelPlacement",void 0),le([t.Property("Outside")],i.prototype,"tickPosition",void 0),le([t.Property(!1)],i.prototype,"opposedPosition",void 0),le([t.Property(!0)],i.prototype,"visible",void 0),le([t.Property("Outside")],i.prototype,"labelPosition",void 0),le([t.Property(0)],i.prototype,"labelRotation",void 0),le([t.Property(0)],i.prototype,"minorTicksPerInterval",void 0),le([t.Property(null)],i.prototype,"maximum",void 0),le([t.Property(null)],i.prototype,"minimum",void 0),le([t.Property(34)],i.prototype,"maximumLabelWidth",void 0),le([t.Property(null)],i.prototype,"interval",void 0),le([t.Complex({},p.MajorTickLines)],i.prototype,"majorTickLines",void 0),le([t.Property(!1)],i.prototype,"enableTrim",void 0),le([t.Complex({},p.MajorGridLines)],i.prototype,"majorGridLines",void 0),le([t.Complex({},p.MinorTickLines)],i.prototype,"minorTickLines",void 0),le([t.Complex({},p.AxisLine)],i.prototype,"lineStyle",void 0),le([t.Complex({},p.MinorGridLines)],i.prototype,"minorGridLines",void 0),le([t.Property(!1)],i.prototype,"isInversed",void 0),le([t.Property(null)],i.prototype,"description",void 0),le([t.Property(0)],i.prototype,"startAngle",void 0),le([t.Property(100)],i.prototype,"coefficient",void 0),le([t.Collection([],p.StripLineSettings)],i.prototype,"stripLines",void 0),le([t.Property(2)],i.prototype,"tabIndex",void 0),le([t.Complex({color:null,width:0,type:"Rectangle"},p.LabelBorder)],i.prototype,"border",void 0),i}(t.ChildProperty),pe=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return oe(i,e),le([t.Property(!1)],i.prototype,"enableMarker",void 0),le([t.Property(!0)],i.prototype,"enable",void 0),le([t.Property(null)],i.prototype,"fill",void 0),le([t.Property(!1)],i.prototype,"shared",void 0),le([t.Property(.75)],i.prototype,"opacity",void 0),le([t.Property(null)],i.prototype,"header",void 0),le([t.Property(null)],i.prototype,"format",void 0),le([t.Complex(p.Theme.tooltipLabelFont,p.Font)],i.prototype,"textStyle",void 0),le([t.Property(null)],i.prototype,"template",void 0),le([t.Complex({color:"#cccccc",width:.5},p.Border)],i.prototype,"border",void 0),le([t.Property(!0)],i.prototype,"enableAnimation",void 0),i}(t.ChildProperty),he=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return oe(i,e),le([t.Property(!1)],i.prototype,"enablePinchZooming",void 0),le([t.Property(!0)],i.prototype,"enableSelectionZooming",void 0),le([t.Property(!1)],i.prototype,"enableDeferredZooming",void 0),le([t.Property(!1)],i.prototype,"enableMouseWheelZooming",void 0),le([t.Property("XY")],i.prototype,"mode",void 0),le([t.Property(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],i.prototype,"toolbarItems",void 0),le([t.Property(!0)],i.prototype,"enableScrollbar",void 0),le([t.Property(!1)],i.prototype,"enablePan",void 0),i}(t.ChildProperty),ce=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return oe(i,e),le([t.Complex({},se)],i.prototype,"chartSeries",void 0),le([t.Complex({},de)],i.prototype,"primaryXAxis",void 0),le([t.Complex({},de)],i.prototype,"primaryYAxis",void 0),le([t.Property("")],i.prototype,"value",void 0),le([t.Property(!1)],i.prototype,"enableMultiAxis",void 0),le([t.Complex(p.Theme.chartTitleFont,p.Font)],i.prototype,"titleStyle",void 0),le([t.Property("")],i.prototype,"title",void 0),le([t.Complex(p.Theme.chartSubTitleFont,p.Font)],i.prototype,"subTitleStyle",void 0),le([t.Property("")],i.prototype,"subTitle",void 0),le([t.Complex({color:"#DDDDDD",width:0},p.Border)],i.prototype,"border",void 0),le([t.Complex({},p.Margin)],i.prototype,"margin",void 0),le([t.Complex({border:{color:null,width:.5},background:"transparent"},p.ChartArea)],i.prototype,"chartArea",void 0),le([t.Property(null)],i.prototype,"background",void 0),le([t.Property("Material")],i.prototype,"theme",void 0),le([t.Property([])],i.prototype,"palettes",void 0),le([t.Complex({},p.CrosshairSettings)],i.prototype,"crosshair",void 0),le([t.Complex({},pe)],i.prototype,"tooltip",void 0),le([t.Complex({},he)],i.prototype,"zoomSettings",void 0),le([t.Property()],i.prototype,"legendSettings",void 0),le([t.Property("None")],i.prototype,"selectionMode",void 0),le([t.Property(!0)],i.prototype,"enableExport",void 0),le([t.Property(!1)],i.prototype,"isMultiSelect",void 0),le([t.Collection([],p.Indexes)],i.prototype,"selectedDataIndexes",void 0),le([t.Property(!0)],i.prototype,"enableAnimation",void 0),le([t.Property(!0)],i.prototype,"useGroupingSeparator",void 0),le([t.Property(!1)],i.prototype,"isTransposed",void 0),le([t.Property(1)],i.prototype,"tabIndex",void 0),le([t.Property(null)],i.prototype,"description",void 0),le([t.Event()],i.prototype,"resized",void 0),le([t.Property(!0)],i.prototype,"enableSideBySidePlacement",void 0),le([t.Event()],i.prototype,"loaded",void 0),le([t.Event()],i.prototype,"beforePrint",void 0),le([t.Event()],i.prototype,"animationComplete",void 0),le([t.Event()],i.prototype,"load",void 0),le([t.Event()],i.prototype,"textRender",void 0),le([t.Event()],i.prototype,"legendRender",void 0),le([t.Event()],i.prototype,"seriesRender",void 0),le([t.Event()],i.prototype,"pointRender",void 0),le([t.Event()],i.prototype,"tooltipRender",void 0),le([t.Event()],i.prototype,"axisLabelRender",void 0),le([t.Event()],i.prototype,"chartMouseClick",void 0),le([t.Event()],i.prototype,"chartMouseMove",void 0),le([t.Event()],i.prototype,"pointMove",void 0),le([t.Event()],i.prototype,"pointClick",void 0),le([t.Event()],i.prototype,"chartMouseDown",void 0),le([t.Event()],i.prototype,"chartMouseLeave",void 0),le([t.Event()],i.prototype,"dragComplete",void 0),le([t.Event()],i.prototype,"chartMouseUp",void 0),le([t.Event()],i.prototype,"scrollStart",void 0),le([t.Event()],i.prototype,"zoomComplete",void 0),le([t.Event()],i.prototype,"scrollChanged",void 0),le([t.Event()],i.prototype,"scrollEnd",void 0),le([t.Property(!0)],i.prototype,"showMultiLevelLabels",void 0),i}(t.ChildProperty),ue=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ge=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},me=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ue(i,e),ge([t.Property(!0)],i.prototype,"showFilterIcon",void 0),ge([t.Property(!0)],i.prototype,"showSortIcon",void 0),ge([t.Property(!0)],i.prototype,"showRemoveIcon",void 0),ge([t.Property(!0)],i.prototype,"showValueTypeIcon",void 0),ge([t.Property("Both")],i.prototype,"displayMode",void 0),ge([t.Property(!0)],i.prototype,"allowDragAndDrop",void 0),i}(t.ChildProperty),ve=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ue(i,e),ge([t.Property(!1)],i.prototype,"allowAdding",void 0),ge([t.Property(!1)],i.prototype,"allowEditing",void 0),ge([t.Property(!1)],i.prototype,"allowDeleting",void 0),ge([t.Property(!1)],i.prototype,"allowCommandColumns",void 0),ge([t.Property("Normal")],i.prototype,"mode",void 0),ge([t.Property(!0)],i.prototype,"allowEditOnDblClick",void 0),ge([t.Property(!0)],i.prototype,"showConfirmDialog",void 0),ge([t.Property(!1)],i.prototype,"showDeleteConfirmDialog",void 0),i}(t.ChildProperty),fe=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ue(i,e),ge([t.Property()],i.prototype,"measure",void 0),ge([t.Property()],i.prototype,"label",void 0),ge([t.Property("NotEquals")],i.prototype,"conditions",void 0),ge([t.Property()],i.prototype,"value1",void 0),ge([t.Property()],i.prototype,"value2",void 0),i}(t.ChildProperty),ye=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ue(i,e),ge([t.Property(!1)],i.prototype,"showHyperlink",void 0),ge([t.Property(!1)],i.prototype,"showRowHeaderHyperlink",void 0),ge([t.Property(!1)],i.prototype,"showColumnHeaderHyperlink",void 0),ge([t.Property(!1)],i.prototype,"showValueCellHyperlink",void 0),ge([t.Property(!1)],i.prototype,"showSummaryCellHyperlink",void 0),ge([t.Collection([],fe)],i.prototype,"conditionalSettings",void 0),ge([t.Property()],i.prototype,"headerText",void 0),ge([t.Property("")],i.prototype,"cssClass",void 0),i}(t.ChildProperty),Se=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ue(i,e),ge([t.Property("Table")],i.prototype,"view",void 0),ge([t.Property("Table")],i.prototype,"primary",void 0),i}(t.ChildProperty),be=function(e){function a(t,i){var r=e.call(this,t,i)||this;return r.verticalScrollScale=1,r.horizontalScrollScale=1,r.scrollerBrowserLimit=5e5,r.lastSortInfo={},r.lastFilterInfo={},r.lastAggregationInfo={},r.lastCalcFieldInfo={},r.isScrolling=!1,r.shiftLockedPos=[],r.savedSelectedCellsPos=[],r.isPopupClicked=!1,r.isMouseDown=!1,r.isMouseUp=!1,r.fieldsType={},r.defaultItems={},r.isCellBoxMultiSelection=!1,r.gridHeaderCellInfo=[],r.gridCellCollection={},r.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},r.resizeInfo={},r.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},r.pivotColumns=[],r.totColWidth=0,r.posCount=0,r.isModified=!1,r.needsID=!0,r.pivotView=r,r.engineModule=new g,r}ue(a,e),o=a,a.prototype.requiredModules=function(){var e,t=[];return e=!0,t.push({args:[this],member:"grouping"}),this.allowConditionalFormatting&&t.push({args:[this],member:"conditionalformatting"}),this.allowNumberFormatting&&(e=!0,t.push({args:[this],member:"numberformatting"})),this.allowCalculatedField&&(e=!0,t.push({args:[this],member:"calculatedfield"})),this.showToolbar&&this.toolbar.length>0&&(e=!0,t.push({args:[this],member:"toolbar"})),this.showFieldList&&(e=!0,t.push({args:[this],member:"fieldlist"})),this.allowExcelExport&&t.push({args:[this],member:"excelExport"}),this.allowPdfExport&&t.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&t.push({args:[this],member:"virtualscroll"}),this.gridSettings&&this.gridSettings.contextMenuItems&&(e=!0),e&&t.push({args:[this],member:"common"}),t},a.prototype.preRender=function(){this.initProperties(),this.isAdaptive=t.Browser.isDevice,this.renderToolTip(),this.keyboardModule=new ee(this),this.contextMenuModule=new te(this),this.globalize=new t.Internationalization(this.locale),this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"APPLY",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field :",baseItem:"Base item :",summarizeValuesBy:"Summarize values by :",sourceName:"Field name :",sourceCaption:"Field caption :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report",new:"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report",export:"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",showSubTotals:"Show sub totals",doNotShowSubTotals:"Do not show sub totals",showSubTotalsRowsOnly:"Show sub totals rows only",showSubTotalsColumnsOnly:"Show sub totals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter vaild report name!!!",reportList:"Report list",removeConfirm:"Are you sure want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Want to save changes to report?",emptyReportName:"Enter a report name",qtr:"Qtr",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping",true:"True",false:"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.renderContextMenu(),this.isDragging=!1,this.addInternalEvents()},a.prototype.onBeforeTooltipOpen=function(e){e.element.classList.add("e-pivottooltipwrap")},a.prototype.renderToolTip=function(){this.showTooltip?(this.tooltip=new r.Tooltip({target:"td.e-valuescontent",showTipPointer:!1,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()},a.prototype.renderContextMenu=function(){if(this.gridSettings.contextMenuItems){for(var e=[],t=[],i=[],r=[],n=[],a=[],o=0,l=this.gridSettings.contextMenuItems;o<l.length;o++){var s=l[o];"string"==typeof s&&-1!==this.getDefaultItems().indexOf(s)?-1!==s.toString().toLowerCase().indexOf("aggregate")?a=[{text:this.localeObj.getConstant("Sum"),id:this.element.id+"_AggSum"},{text:this.localeObj.getConstant("DistinctCount"),id:this.element.id+"_AggDistinctCount"},{text:this.localeObj.getConstant("Count"),id:this.element.id+"_AggCount"},{text:this.localeObj.getConstant("Product"),id:this.element.id+"_AggProduct"},{text:this.localeObj.getConstant("Avg"),id:this.element.id+"_AggAvg"},{text:this.localeObj.getConstant("Max"),id:this.element.id+"_AggMax"},{text:this.localeObj.getConstant("Min"),id:this.element.id+"_AggMin"},{text:this.localeObj.getConstant("MoreOption"),id:this.element.id+"_AggMoreOption"}]:-1!==s.toString().toLowerCase().indexOf("export")?i.push(this.buildDefaultItems(s)):e.push(this.buildDefaultItems(s)):"string"!=typeof s&&t.push(s)}if(a.length>0){var d=this.buildDefaultItems("Aggregate");d.items=a,r.push(d)}if(i.length>0){var p=this.buildDefaultItems("export");p.items=i,n.push(p)}this.gridSettings.contextMenuItems=[],Array.prototype.push.apply(this.gridSettings.contextMenuItems,r),Array.prototype.push.apply(this.gridSettings.contextMenuItems,e),Array.prototype.push.apply(this.gridSettings.contextMenuItems,n),Array.prototype.push.apply(this.gridSettings.contextMenuItems,t)}},a.prototype.getDefaultItems=function(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]},a.prototype.buildDefaultItems=function(e){var t;switch(e){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("calculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+C};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+C};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:"e-pivotview-pdf-export "+C};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:"e-pivotview-excel-export "+C};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:"e-pivotview-csv-export "+C};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+C};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+C};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+C};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+C}}return this.defaultItems[e]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[e]},a.prototype.initProperties=function(){this.isScrolling=!1,this.setProperties({pivotValues:[]},!0),this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo.bind(this):void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo.bind(this):void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo.bind(this):void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo.bind(this):void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0,this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0,this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0,this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0,this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0,this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0,this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0,this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0,this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0,this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0,this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0,this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0,null===this.gridSettings.rowHeight&&this.setProperties({gridSettings:{rowHeight:this.isAdaptive?48:36}},!0),this.element.style.height="100%",this.enableVirtualization&&(this.updatePageSettings(!0),this.allowExcelExport&&o.Inject($),this.allowPdfExport&&o.Inject(J),this.editSettings.allowEditing&&o.Inject(ne)),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,"Table"!==this.displayOption.view&&(this.chartModule=new ae),this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view},a.prototype.updatePageSettings=function(e){if(this.enableVirtualization){var t=1,i=1;this.dataSourceSettings.values.length>1&&("row"===this.dataSourceSettings.valueAxis?i=this.dataSourceSettings.values.length:t=this.dataSourceSettings.values.length);var r=this.getHeightAsNumber();isNaN(r)&&(r=this.element.offsetHeight),this.pageSettings={columnCurrentPage:e?1:this.pageSettings.columnCurrentPage,rowCurrentPage:e?1:this.pageSettings.rowCurrentPage,columnSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/t),rowSize:Math.ceil(Math.floor(r/this.gridSettings.rowHeight)/i)}}},a.prototype.render=function(){var e=this;this.cellTemplateFn=this.templateParser(this.cellTemplate),r.createSpinner({target:this.element},this.createElement);var i={dataSourceSettings:this.dataSourceSettings,pivotview:this,fieldsType:{}};this.trigger("load",i,function(t){e.dataSourceSettings=t.dataSourceSettings,e.fieldsType=t.fieldsType,e.updateClass(),e.notify("init-groupingbar",{}),e.notify("initial-load",{}),e.isAdaptive&&e.contextMenuModule.render(),e.notify("init-toolbar",{})}),t.isBlazor()&&this.renderComplete()},a.prototype.addInternalEvents=function(){this.on("initial-load",this.generateData,this),this.on(f,this.renderPivotGrid,this),this.on(v,this.onContentReady,this)},a.prototype.removeInternalEvents=function(){this.off("initial-load",this.generateData),this.off(f,this.renderPivotGrid),this.off(v,this.onContentReady)},a.prototype.getPersistData=function(){var e=["dataSourceSettings","pivotValues","gridSettings","chartSettings"];return this.addOnPersist(e)},a.prototype.getModuleName=function(){return"pivotview"},a.prototype.copy=function(e){this.grid.copy(e)},a.prototype.onPropertyChanged=function(i,r){for(var n=0,a=Object.keys(i);n<a.length;n++)switch(a[n]){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":if(i.dataSourceSettings&&1===Object.keys(i.dataSourceSettings).length&&i.dataSourceSettings.groupSettings){var o=t.extend([],this.dataSourceSettings.groupSettings,null,!0),l=u.getClonedData(this.clonedDataSet),s=t.extend({},this.clonedReport,null,!0);s.dataSource=l,(0===i.dataSourceSettings.groupSettings.length||i.dataSourceSettings.groupSettings.length>0)&&(s.groupSettings=i.dataSourceSettings.groupSettings.length>0?o:[],this.setProperties({dataSourceSettings:s},!0))}this.notify("initial-load",{});break;case"pivotValues":case"displayOption":case"height":case"width":this.notify(f,{});break;case"gridSettings":this.lastGridSettings=i.gridSettings,this.renderModule.updateGridSettings(),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type;break;case"chartSettings":this.chartModule.loadChart(this,this.chartSettings);break;case"locale":case"currencyCode":case"enableRtl":this.tooltip&&this.tooltip.destroy(),e.prototype.refresh.call(this),this.updateClass();break;case"enableValueSorting":this.enableValueSorting=i.enableValueSorting,this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")&&this.element.querySelector(".e-grouping-bar").remove(),this.renderPivotGrid();break;case"groupingBarSettings":this.axisFieldModule.render();break;case"showTooltip":this.renderToolTip();break;case"toolbar":this.toolbarModule&&this.toolbarModule.refreshToolbar()}},a.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return t.compile(document.querySelector(e).innerHTML.trim())}catch(i){return t.compile(e)}},a.prototype.getCellTemplate=function(){return this.cellTemplateFn},a.prototype.renderPivotGrid=function(){"Table"===this.currentView&&this.cellTemplate&&window&&window.Blazor&&t.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.chartModule&&(this.chartModule.engineModule=this.engineModule,this.chartModule.loadChart(this,this.chartSettings)),(this.showFieldList||this.showGroupingBar)&&(this.notify(m,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=t.extend({},this.dataSourceSettings,null,!0))),this.enableVirtualization&&(this.virtualscrollModule=new ie(this)),"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new ne(this)),this.renderModule=new I(this),this.renderModule.render()):this.grid&&t.remove(this.grid.element),this.trigger("dataBound"),this.allowConditionalFormatting&&this.applyFormatting(),this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&("Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none"):(this.grid.element.style.display="none",this.chart.element.style.display="")),this.toolbarModule&&(this.showFieldList&&this.element.querySelector("#"+this.element.id+"_PivotFieldList")&&(this.element.querySelector("#"+this.element.id+"_PivotFieldList").style.display="none"),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action?this.isModified=!0:this.toolbarModule.action="")},a.prototype.updateDataSource=function(e){var t=this;r.showSpinner(this.element),this.updatePageSettings(!1);var i={mode:"",savedFieldList:this.engineModule.fieldList,pageSettings:this.pageSettings,enableValueSorting:this.enableValueSorting,isDrillThrough:this.allowDrillThrough||this.editSettings.allowEditing,localeObj:this.localeObj,fieldsType:this.fieldsType},n=Object.keys(this.lastSortInfo).length>0,a=Object.keys(this.lastFilterInfo).length>0,o=Object.keys(this.lastAggregationInfo).length>0,l=Object.keys(this.lastCalcFieldInfo).length>0;this.enableVirtualization&&(n||a||o||l)?(n&&(this.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),this.engineModule.onSort(this.lastSortInfo),this.lastSortInfo={}),a&&(this.engineModule.onFilter(this.lastFilterInfo,this.dataSourceSettings),this.lastFilterInfo={}),o&&(this.engineModule.onAggregation(this.lastAggregationInfo),this.lastAggregationInfo={}),l&&(this.engineModule.onCalcOperation(this.lastCalcFieldInfo),this.lastCalcFieldInfo={})):this.engineModule.renderEngine(this.dataSourceSettings,i,this.getValueCellInfo.bind(this));var s={dataSourceSettings:this.dataSourceSettings,pivotValues:this.engineModule.pivotValues};this.trigger("enginePopulated",s,function(e){t.dataSourceSettings=e.dataSourceSettings,t.engineModule.pivotValues=e.pivotValues,t.pivotCommon&&(t.pivotCommon.engineModule=t.engineModule,t.pivotCommon.dataSourceSettings=t.dataSourceSettings),t.setProperties({pivotValues:t.engineModule.pivotValues},!0),t.renderPivotGrid()})},a.prototype.destroy=function(){this.removeInternalEvents(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy(),this.isAdaptive&&this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.tooltip&&this.tooltip.destroy(),this.chart&&this.chart.destroy(),this.unwireEvents(),t.removeClass([this.element],y),t.removeClass([this.element],S),t.removeClass([this.element],b),this.element.innerHTML="",e.prototype.destroy.call(this)},a.prototype.excelExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("Excel"):this.grid.excelExport(e,t,i,r)},a.prototype.csvExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("CSV"):this.grid.csvExport(e,t,i,r)},a.prototype.pdfExport=function(e,t,i,r){this.enableVirtualization?this.pdfExportModule.exportToPDF():this.grid.pdfExport(e,t,i,r)},a.prototype.chartExport=function(e,t,i,r,n){this.chart&&this.chart.enableExport&&this.chart.exportModule.export(e,t,i,null,r,n)},a.prototype.printChart=function(){this.chart&&this.chart.print()},a.prototype.onDrill=function(e){var t=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",i=e.parentElement.getAttribute("fieldname"),n=this.engineModule.pivotValues[Number(e.parentElement.getAttribute("index"))][Number(e.parentElement.getAttribute("aria-colindex"))],a=n.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(t),o=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:i,items:[a],delimiter:t}]}},!0);else{for(var l=0;l<this.dataSourceSettings.drilledMembers.length;l++){var s=this.dataSourceSettings.drilledMembers[l];if(a=a.split(t).join(s.delimiter?s.delimiter:t),t=s.delimiter=s.delimiter?s.delimiter:t,s.name===i){o=!0;var d=s.items.indexOf(a);d>-1?s.items.splice(d,1):s.items.push(a)}}o||this.dataSourceSettings.drilledMembers.push({name:i,items:[a],delimiter:t})}r.showSpinner(this.element);var p={fieldName:i,memberName:a,delimiter:t,axis:e.parentElement.classList.contains("e-rowsheader")?"row":"column",action:e.classList.contains(x)?"up":"down",currentCell:n};this.trigger("drill",{drillInfo:p,pivotview:this}),this.enableVirtualization?(this.engineModule.drilledMembers=this.dataSourceSettings.drilledMembers,this.engineModule.onDrill(p)):this.engineModule.generateGridData(this.dataSourceSettings),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()},a.prototype.onContentReady=function(){if("Table"!==this.currentView&&this.cellTemplate&&window&&window.Blazor&&t.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.isPopupClicked=!1,this.showFieldList?r.hideSpinner(this.pivotFieldListModule.fieldListSpinnerElement):this.fieldListSpinnerElement&&r.hideSpinner(this.fieldListSpinnerElement),this.isEmptyGrid?this.isEmptyGrid=!1:(r.hideSpinner(this.element),this.trigger("dataBound")),this.grid){if(this.enableVirtualization&&this.engineModule){this.element.querySelector(".e-movablecontent")&&!this.element.querySelector(".e-movablecontent").querySelector(".e-virtualtrack")&&(this.virtualDiv=t.createElement("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movablecontent").appendChild(this.virtualDiv)),this.element.querySelector(".e-movableheader")&&!this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack")?(this.virtualHeaderDiv=t.createElement("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movableheader").appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack");var e=this.element.querySelector(".e-movablecontent").querySelector(".e-table"),i=this.gridSettings.rowHeight*this.engineModule.rowCount+.1-e.clientHeight;i>this.scrollerBrowserLimit&&(this.verticalScrollScale=i/this.scrollerBrowserLimit,i=this.scrollerBrowserLimit);var n=this.gridSettings.columnWidth*this.engineModule.columnCount-this.grid.columns[0].width;n>this.scrollerBrowserLimit&&(this.horizontalScrollScale=n/this.scrollerBrowserLimit,n=this.scrollerBrowserLimit),t.setStyleAttribute(this.virtualDiv,{height:(i>.1?i:.1)+"px",width:(n>.1?n:.1)+"px"}),t.setStyleAttribute(this.virtualHeaderDiv,{height:0,width:(n>.1?n:.1)+"px"});var a=this.element.querySelector(".e-movablecontent"),o=this.element.querySelector(".e-frozencontent"),l=this.element.querySelector(".e-movableheader"),s=a.scrollTop>this.scrollerBrowserLimit?a.querySelector("."+D).style.transform.split(",")[1].trim():-(a.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-a.scrollTop)+"px)",d=a.scrollLeft>this.scrollerBrowserLimit?a.querySelector("."+D).style.transform.split(",")[0].trim()+",":"translate("+-(a.scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-a.scrollLeft)+"px,";t.setStyleAttribute(o.querySelector(".e-table"),{transform:"translate(0px,"+s}),t.setStyleAttribute(a.querySelector(".e-table"),{transform:d+s}),t.setStyleAttribute(l.querySelector(".e-table"),{transform:d+0+"px)"})}this.showGroupingBar?(this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"):(this.element.style.minWidth="310px",this.grid.element.style.minWidth="310px"),this.unwireEvents(),this.wireEvents()}if(this.isChartLoaded=!1,this.cellTemplate&&window&&window.Blazor){var p=Object.keys(this.gridCellCollection);if(p.length>0){for(var h=0,c=p;h<c.length;h++){var u=c[h],g=this.gridCellCollection[u];t.append([].slice.call(this.getCellTemplate()({targetCell:g},this,"cellTemplate",this.element.id+"_cellTemplate")),g)}t.updateBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate",this)}}},a.prototype.setToolTip=function(e){var t=Number(e.target.getAttribute("aria-colindex")),i=Number(e.target.getAttribute("index")),r=this.pivotValues.length>0?this.pivotValues[i][t]:void 0;this.tooltip.content="",r?this.tooltip.content="<div class=e-pivottooltip><p class=e-tooltipheader>"+this.localeObj.getConstant("row")+":</p><p class=e-tooltipcontent>"+this.getRowText(i,0)+"</p></br><p class=e-tooltipheader>"+this.localeObj.getConstant("column")+":</p><p class=e-tooltipcontent>"+this.getColText(0,t,i)+"</p></br>"+(""!==r.actualText?"<p class=e-tooltipheader>"+this.localeObj.getConstant(this.engineModule.fieldList[r.actualText].aggregateType)+" "+this.localeObj.getConstant("of")+" "+this.engineModule.fieldList[r.actualText].caption+":</p><p class=e-tooltipcontent>"+("0"===r.formattedText||""===r.formattedText?this.localeObj.getConstant("noValue"):r.formattedText)+"</p></div>":""):e.cancel=!0},a.prototype.getRowText=function(e,t){for(var i=this.pivotValues[e][t],r=i.level,n="grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText;r>0||void 0===i.index;)e--,void 0!==(i=this.pivotValues[e][t]).index&&r>i.level&&(n=n+" - "+i.formattedText,r-=1);return n.split(" - ").reverse().join(" - ")},a.prototype.getColText=function(e,t,i){for(var r=this.pivotValues[0][t],n=r.axis,a="grand sum"===r.type?this.localeObj.getConstant("grandTotal"):r.formattedText;"value"!==n&&i>e;)e++,this.pivotValues[e]&&(n=(r=this.pivotValues[e][t]).axis,"sum"!==r.type&&"grand sum"!==r.type&&"value"!==n&&(a=a+" - "+r.formattedText));return a},a.prototype.updateClass=function(){this.enableRtl?t.addClass([this.element],S):t.removeClass([this.element],S),this.isAdaptive?t.addClass([this.element],b):t.removeClass([this.element],b)},a.prototype.wireEvents=function(){"Chart"!==this.displayOption.view&&(t.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),t.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),t.EventHandler.add(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler,this),t.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),t.EventHandler.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0))},a.prototype.mouseRclickHandler=function(e){3===e.which?this.lastCellClicked=e.target:0===e.which&&(this.lastCellClicked=e.target),this.lastCellClicked=e.target},a.prototype.mouseDownHandler=function(e){if(3===e.which&&(this.lastCellClicked=e.target),this.isCellBoxMultiSelection){this.isMouseDown=!0,this.isMouseUp=!1;var t=this.parentAt(e.target,"TH");this.clearSelection(t,e,Number(t.getAttribute("aria-colindex")),Number(t.getAttribute("index"))),this.lastSelectedElement=void 0}},a.prototype.mouseMoveHandler=function(e){if(this.isCellBoxMultiSelection&&(e.preventDefault(),this.isMouseDown&&e.target)){var t=e.target,i=this.parentAt(t,"TH");this.lastSelectedElement&&this.lastSelectedElement!==i&&i.classList.contains(k)?(this.lastSelectedElement.classList.remove("e-active"),this.lastSelectedElement.classList.remove(k),this.lastSelectedElement=i):(this.lastSelectedElement=i,i.classList.add("e-active"),i.classList.add(k)),this.renderModule.selected()}},a.prototype.mouseUpHandler=function(e){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)},a.prototype.parentAt=function(e,t){for(;e.tagName!==t&&e.parentElement;)e=e.parentElement;return e},a.prototype.mouseClickHandler=function(e){3===e.which?this.lastCellClicked=e.target:0===e.which&&(this.lastCellClicked=e.target);var t=e.target;if((t.classList.contains("e-headercell")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")||t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headertext")||t.classList.contains("e-ascending")||t.classList.contains("e-descending"))&&this.enableValueSorting){var i=null;if(t.classList.contains("e-headercell")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-ascending")||t.classList.contains("e-descending")?i=t.parentElement:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),this.CellClicked(t,e),i.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader")&&"column"===this.dataSourceSettings.valueAxis||i.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(i.parentElement.classList.contains("e-rowsheader")||i.classList.contains("e-stot"))){var n=Number(i.getAttribute("aria-colindex")),a=Number(i.getAttribute("index"));if("row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?a="value"===this.pivotValues[a][n].type?a:a+1:"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(n=Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,a=this.engineModule.headerContent.length-1),this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[a][n].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),r.showSpinner(this.element),this.engineModule.enableValueSorting=!0,this.enableVirtualization){if(this.dataSourceSettings.enableSorting){for(var o=0,l=Object.keys(this.engineModule.fieldList);o<l.length;o++){var s=l[o];this.engineModule.fieldList[s].sort="Ascending"}this.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}this.engineModule.rMembers=this.engineModule.headerCollection.rowHeaders,this.engineModule.cMembers=this.engineModule.headerCollection.columnHeaders,this.engineModule.applyValueSorting(),this.engineModule.updateEngine()}else this.engineModule.generateGridData(this.dataSourceSettings);this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()}}else{if(!t.classList.contains(x)&&!t.classList.contains(T))return void this.CellClicked(t,e);this.onDrill(t)}},a.prototype.framePivotColumns=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.columns&&r.columns.length>0)this.framePivotColumns(r.columns);else{var n="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"",a=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:n,Number("auto"===r.width?r.minWidth:r.width));this.pivotColumns.push({allowReordering:r.allowReordering,allowResizing:r.allowResizing,headerText:n,width:a}),this.totColWidth=this.totColWidth+Number(a)}}},a.prototype.setGridColumns=function(e){if(this.element.offsetWidth<this.totColWidth){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.columns&&r.columns.length>0)this.setGridColumns(r.columns);else{var a="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"";r.allowReordering=this.pivotColumns[this.posCount].allowReordering,r.allowResizing=this.pivotColumns[this.posCount].allowResizing;var o=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:a,Number(this.pivotColumns[this.posCount].width));"auto"!==r.width?r.width=o:r.minWidth=o,this.posCount++,r.allowReordering&&(this.gridSettings.allowReordering=!0),r.allowResizing&&(this.gridSettings.allowResizing=!0)}}this.gridSettings.allowReordering&&n.Grid.Inject(n.Reorder),this.gridSettings.allowResizing&&n.Grid.Inject(n.Resize)}},a.prototype.fillGridColumns=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r.allowReordering=this.gridSettings.allowReordering,r.allowResizing=this.gridSettings.allowResizing,this.posCount++,r.columns&&r.columns.length>0&&this.fillGridColumns(r.columns)}},a.prototype.triggerColumnRenderEvent=function(e){this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(e);var t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings};this.trigger("beforeColumnsRender",i),t!==this.pivotColumns[0].width&&this.element.offsetWidth<this.totColWidth&&(this.firstColWidth=this.pivotColumns[0].width),this.posCount=0,this.setGridColumns(e)},a.prototype.setCommonColumnsWidth=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];"0.formattedText"!==n.field?n.columns?this.setCommonColumnsWidth(n.columns,t):"auto"!==n.width?n.width=t:n.minWidth=t:n.width=this.firstColWidth?this.firstColWidth:n.width}},a.prototype.getHeightAsNumber=function(){var e;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?e=parseFloat(this.height.toString())/100*this.element.offsetHeight:this.height.toString().indexOf("px")>-1&&(e=Number(this.height.toString().split("px")[0])):e=Number(this.height),e<this.gridSettings.rowHeight&&(e=this.gridSettings.rowHeight),e},a.prototype.getWidthAsNumber=function(){var e;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?e=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(e=Number(this.width.toString().split("px")[0])),isNaN(e)&&(e=this.element.offsetWidth)):e=Number(this.width),e<400&&(e=400),e},a.prototype.onWindowResize=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500)},a.prototype.layoutRefresh=function(){if(this.element&&this.element.classList.contains("e-pivotview")&&this.engineModule&&this.engineModule.pivotValues){var e=this.renderModule.resizeColWidth(this.dataSourceSettings.values.length>0&&this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2);this.grid.width=this.renderModule.calculateGridWidth(),this.renderModule.calculateGridHeight(!0),this.setCommonColumnsWidth(this.grid.columns,e),this.posCount=0,this.showGroupingBar||this.setGridColumns(this.grid.columns),"Table"===this.currentView&&this.cellTemplate&&window&&window.Blazor&&t.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.grid.refreshColumns(),this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-grouping-bar")&&this.groupingBarModule.setGridRowWidth()}},a.prototype.CellClicked=function(e,t){var i=this,r=null;if(e.classList.contains("e-headercell")||e.classList.contains("e-rowcell")?r=e:e.classList.contains("e-stackedheadercelldiv")||e.classList.contains("e-cellvalue")||e.classList.contains("e-headercelldiv")?r=e.parentElement:e.classList.contains("e-headertext")?r=e.parentElement.parentElement:e.classList.contains("e-rowselect")&&(e.classList.contains("e-spanclicked")?this.isPopupClicked=!1:this.isPopupClicked=!0),r){var n=Number(r.getAttribute("aria-colindex")),a=Number(r.getAttribute("index")),o=Number(r.getAttribute("aria-colspan")),l={cancel:!1,isCellClick:!0,currentCell:r,data:this.pivotValues[a][n]};this.trigger("cellSelecting",l,function(e){i.gridSettings.allowSelection&&(("Both"===i.gridSettings.selectionSettings.mode?r.classList.contains("e-rowcell"):"Row"===i.gridSettings.selectionSettings.mode)?i.clearSelection(r,t,n,a):(i.clearSelection(r,t,n,a),e.cancel||i.applyColumnSelection(t,r,n,n+(o>0?o-1:0),a)),"Multiple"!==i.gridSettings.selectionSettings.type||"Row"!==i.gridSettings.selectionSettings.mode&&"Both"!==i.gridSettings.selectionSettings.mode||i.applyRowSelection(0,a,t)),i.cellClick&&e.isCellClick&&i.trigger("cellClick",{currentCell:r,data:i.pivotValues[a][n]})})}},a.prototype.clearSelection=function(e,t,i,r){(t.shiftKey||t.ctrlKey)&&"Single"!==this.gridSettings.selectionSettings.type||("Cell"===this.gridSettings.selectionSettings.mode?e.classList.contains("e-columnsheader")?[].slice.call(this.element.querySelectorAll(".e-rowcell.e-cellselectionbackground")).forEach(function(e){e.classList.remove("e-cellselectionbackground")}):[].slice.call(this.element.querySelectorAll(".e-columnsheader.e-active")).forEach(function(e){e.classList.remove("e-active"),e.classList.remove(k)}):"Both"===this.gridSettings.selectionSettings.mode&&(e.classList.contains("e-rowcell")?[].slice.call(this.element.querySelectorAll("."+k)).forEach(function(e){Number(e.getAttribute("index"))!==r&&(e.classList.remove("e-active"),e.classList.remove(k))}):[].slice.call(this.element.querySelectorAll(".e-cellselectionbackground")).forEach(function(e){e.classList.remove("e-cellselectionbackground")})))},a.prototype.applyRowSelection=function(e,t,i){var r=this.engineModule.pivotValues[t][e];if(!i.ctrlKey&&!i.shiftKey&&r&&r.members.length>0){var n=r.level,a=t;do{a++,r=this.engineModule.pivotValues[a][e]}while(r&&n<r.level);var o=this;this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-o.renderModule.rowStartPos,endIndex:a-(1+o.renderModule.rowStartPos)}:o.grid.selectionModule.selectRowsByRange(t-o.renderModule.rowStartPos,a-(1+o.renderModule.rowStartPos))}},a.prototype.applyColumnSelection=function(e,t,i,r,n){if(!t.classList.contains("e-rowsheader")&&("Cell"!==this.gridSettings.selectionSettings.mode||t.classList.contains("e-columnsheader"))){var a=e.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(e),this.isPopupClicked?(this.element.querySelector(".e-rowselect").classList.add("e-spanclicked"),a=!0):(this.element.querySelector(".e-rowselect").classList.remove("e-spanclicked"),a=!1));for(var o=[],l=this.gridSettings.selectionSettings.type,s=t.classList.contains("e-active"),d=[],p={},h=i;h<=r;h++)d.push(h.toString());a&&"Single"!==l?s=!1:([].slice.call(this.element.querySelectorAll(".e-active")).forEach(function(e){e.classList.remove("e-active"),e.classList.remove(k),-1===d.indexOf(e.getAttribute("aria-colindex"))&&(s=!1);var t=Number(e.getAttribute("aria-colindex"));p[t]=t}),d=Object.keys(p).length>0?Object.keys(p).sort(function(e,t){return e-t}):d),"Multiple"===l&&e.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?d:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=i?i=Number(this.shiftLockedPos[0]):r=r<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):r):this.shiftLockedPos=[];var c=[];e.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===l&&!t.classList.contains("e-rowsheader")&&[].slice.call(this.element.querySelectorAll(".e-rowsheader.e-cellselectionbackground")).forEach(function(e){c.push(e.getAttribute("index"))});for(var u=i;u<=r;)o.push('[aria-colindex="'+u+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+n+'"]':"")),u++;if(!s){n=t.classList.contains("e-headercell")?n:this.renderModule.rowStartPos-1;var g=t.classList.contains("e-active");[].slice.call(this.element.querySelectorAll(o.toString())).forEach(function(e){Number(e.getAttribute("index"))>=n&&(g&&a&&-1===c.indexOf(e.getAttribute("index"))?(e.classList.remove("e-active"),e.classList.remove(k)):(e.classList.add("e-active"),e.classList.add(k)))})}this.renderModule.selected()}},a.prototype.getSelectedCellsPos=function(){var e=this;e.savedSelectedCellsPos=[],[].slice.call(this.element.querySelectorAll("."+k)).forEach(function(t){e.savedSelectedCellsPos.push({rowIndex:t.getAttribute("index"),colIndex:t.getAttribute("aria-colindex")})})},a.prototype.setSavedSelectedCells=function(){var e=this;[].slice.call(this.savedSelectedCellsPos).forEach(function(t){var i='[aria-colindex="'+t.colIndex+'"][index="'+t.rowIndex+'"]';e.element.querySelector(i).classList.add("e-active"),e.element.querySelector(i).classList.add(k)})},a.prototype.unwireEvents=function(){"Chart"!==this.displayOption.view&&(t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),t.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector(".e-gridheader")&&t.EventHandler.remove(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler),t.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler),window.removeEventListener("resize",this.onWindowResize.bind(this),!0))},a.prototype.renderEmptyGrid=function(){var e=this;this.isEmptyGrid=!0,this.renderModule=new I(this),this.grid&&this.grid.element&&this.element.querySelector(".e-grid")?(this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns()):(this.element.querySelector(".e-grid")&&t.remove(this.element.querySelector(".e-grid")),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){},this.element.appendChild(t.createElement("div",{id:this.element.id+"_grid"})),this.grid.isStringTemplate=!0,this.grid.appendTo("#"+this.element.id+"_grid"),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",function(){e.grid.scrollModule.setWidth(),e.grid.scrollModule.setHeight(),e.grid.element.querySelector(".e-movablecontent").style.overflowY="auto"}))},a.prototype.initEngine=function(){var e=this;this.trigger("enginePopulating",{dataSourceSettings:this.dataSourceSettings},function(i){if(e.dataSourceSettings=i.dataSourceSettings,e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var r=e.engineModule.data;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:u.getClonedData(r),e.setProperties({dataSourceSettings:{dataSource:[]}},!0),e.clonedReport=e.clonedReport?e.clonedReport:t.extend({},e.dataSourceSettings,null,!0),e.setProperties({dataSourceSettings:{dataSource:r}},!0)}e.updatePageSettings(!1);var n={mode:"",savedFieldList:void 0,pageSettings:e.pageSettings,enableValueSorting:e.enableValueSorting,isDrillThrough:e.allowDrillThrough||e.editSettings.allowEditing,localeObj:e.localeObj,fieldsType:e.fieldsType};e.engineModule.renderEngine(e.dataSourceSettings,n,e.getValueCellInfo.bind(e)),e.setProperties({pivotValues:e.engineModule.pivotValues},!0);var a=e;e.trigger("enginePopulated",{pivotValues:e.pivotValues},function(e){a.pivotValues=e.pivotValues,a.notify(f,{}),a.isEmptyGrid=!1})})},a.prototype.generateData=function(){"Chart"!==this.displayOption.view&&this.renderEmptyGrid(),r.showSpinner(this.element),this.dataSourceSettings&&this.dataSourceSettings.dataSource?this.dataSourceSettings.dataSource instanceof i.DataManager?setTimeout(this.getData.bind(this),100):this.dataSourceSettings.dataSource.length>0?(this.engineModule.data=this.dataSourceSettings.dataSource,this.initEngine()):r.hideSpinner(this.element):r.hideSpinner(this.element)},a.prototype.getValueCellInfo=function(e){var t=e;return this.trigger("aggregateCellInfo",t),t},a.prototype.bindTriggerEvents=function(e){this.trigger(n.getObject("name",e),e)},a.prototype.getData=function(){this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},a.prototype.executeQuery=function(e){this.element.querySelector(".e-spinner-pane")||r.showSpinner(this.element),this.engineModule.data=e.result,this.initEngine()},a.prototype.applyFormatting=function(){if(this.pivotValues){for(var e=[],t=this.pivotValues.length,i=0;i<t;i++)void 0!==this.pivotValues[i]&&void 0===this.pivotValues[i][0]&&e.push(i);for(i=0;i<this.pivotValues.length;i++)for(var r=1;this.pivotValues[i]&&r<this.pivotValues[i].length;r++)if("value"===this.pivotValues[i][r].axis){this.pivotValues[i][r].style=void 0,this.pivotValues[i][r].cssClass=void 0;for(var n=this.dataSourceSettings.conditionalFormatSettings,a=0;a<n.length;a++)if(this.checkCondition(this.pivotValues[i][r].value,n[a].conditions,n[a].value1,n[a].value2)){var o="row"===this.dataSourceSettings.valueAxis?i:this.engineModule.headerContent.length-1,l="row"===this.dataSourceSettings.valueAxis?0:r;(!n[a].measure||1===this.dataSourceSettings.values.length||this.pivotValues[o][l].valueSort&&this.pivotValues[o][l].actualText===n[a].measure&&(!n[a].label||this.pivotValues[e[n[a].label.split(".").length-1]]&&this.pivotValues[e[n[a].label.split(".").length-1]][r]&&this.pivotValues[e[n[a].label.split(".").length-1]][r].valueSort&&this.pivotValues[e[n[a].label.split(".").length-1]][r].valueSort[n[a].label]||this.pivotValues[i][0].valueSort.levelName.indexOf(n[a].label)>-1))&&(n[a].style&&n[a].style.backgroundColor&&(n[a].style.backgroundColor=this.conditionalFormattingModule.isHex(n[a].style.backgroundColor.substr(1))?n[a].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(n[a].style.backgroundColor)),n[a].style&&n[a].style.color&&(n[a].style.color=this.conditionalFormattingModule.isHex(n[a].style.color.substr(1))?n[a].style.color:this.conditionalFormattingModule.colourNameToHex(n[a].style.color)),this.pivotValues[i][r].style=n[a].style,this.pivotValues[i][r].cssClass="format"+this.element.id+a)}}for(var s=this.dataSourceSettings.conditionalFormatSettings,a=0;a<s.length;a++){var d=this.createStyleSheet.bind(this)(),p="color: "+s[a].style.color+"!important;background-color: "+s[a].style.backgroundColor+"!important;font-size: "+s[a].style.fontSize+"!important;font-family: "+s[a].style.fontFamily+" !important;";d.insertRule(".format"+this.element.id+a+"{"+p+"}",0)}}},a.prototype.createStyleSheet=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet},a.prototype.applyHyperlinkSettings=function(){if(this.pivotValues){for(var e=this.pivotValues,i=[],r=e.length,n=0;n<r;n++)void 0!==e[n]&&void 0===e[n][0]&&i.push(n);if(this.hyperlinkSettings.conditionalSettings.length>0)for(n=0;n<e.length;n++)for(d=1;e[n]&&d<e[n].length;d++)if("value"===e[n][d].axis){e[n][d].enableHyperlink=!1;for(var a=this.hyperlinkSettings.conditionalSettings,o=0;o<a.length;o++)if(this.checkCondition(e[n][d].value,a[o].conditions,a[o].value1,a[o].value2)){var l="row"===this.dataSourceSettings.valueAxis?n:this.engineModule.headerContent.length-1,s="row"===this.dataSourceSettings.valueAxis?0:d;(!a[o].measure||1===this.dataSourceSettings.values.length||e[l][s].valueSort&&e[l][s].actualText===a[o].measure)&&(!a[o].label||e[i[a[o].label.split(".").length-1]]&&e[i[a[o].label.split(".").length-1]][d]&&e[i[a[o].label.split(".").length-1]][d].valueSort&&e[i[a[o].label.split(".").length-1]][d].valueSort[a[o].label]||e[n][0].valueSort.levelName.indexOf(a[o].label)>-1)&&(e[n][d].enableHyperlink=!0)}}if(t.isNullOrUndefined(this.hyperlinkSettings.headerText))return;for(n=0;n<e.length;n++)for(var d=1;e[n]&&d<e[n].length;d++)if("value"===e[n][d].axis){var p=this.hyperlinkSettings.headerText,l="row"===this.dataSourceSettings.valueAxis?n:this.engineModule.headerContent.length-1,s="row"===this.dataSourceSettings.valueAxis?0:d;if(e[i[p.split(".").length-1]]&&e[i[p.split(".").length-1]][d]&&e[i[p.split(".").length-1]][d].valueSort&&e[i[p.split(".").length-1]][d].valueSort[p]){for(var h=0,c=i;h<c.length;h++){var u=c[h];e[u][d]&&"column"===e[u][d].axis&&e[u][d].valueSort.levelName.indexOf(p)>-1&&(e[u][d].enableHyperlink=!0)}e[n][d].enableHyperlink=!0}else e[n][0].valueSort.levelName.indexOf(p)>-1&&(e[n][0].enableHyperlink=!0,e[n][d].enableHyperlink=!0)}}},a.prototype.checkCondition=function(e,t,i,r){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r;case"NotBetween":return!(i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r);default:return!1}};var o;return ge([t.Property("USD")],a.prototype,"currencyCode",void 0),ge([t.Property(!1)],a.prototype,"showFieldList",void 0),ge([t.Complex({},Z)],a.prototype,"gridSettings",void 0),ge([t.Complex({},ce)],a.prototype,"chartSettings",void 0),ge([t.Complex({},me)],a.prototype,"groupingBarSettings",void 0),ge([t.Complex({},ye)],a.prototype,"hyperlinkSettings",void 0),ge([t.Complex({},Y)],a.prototype,"dataSourceSettings",void 0),ge([t.Complex({},ve)],a.prototype,"editSettings",void 0),ge([t.Complex({},Se)],a.prototype,"displayOption",void 0),ge([t.Property()],a.prototype,"pivotValues",void 0),ge([t.Property(!1)],a.prototype,"showGroupingBar",void 0),ge([t.Property(!0)],a.prototype,"showTooltip",void 0),ge([t.Property(!1)],a.prototype,"showToolbar",void 0),ge([t.Property([])],a.prototype,"toolbar",void 0),ge([t.Property(!1)],a.prototype,"showValuesButton",void 0),ge([t.Property(!1)],a.prototype,"allowCalculatedField",void 0),ge([t.Property(!1)],a.prototype,"enableValueSorting",void 0),ge([t.Property(!1)],a.prototype,"allowConditionalFormatting",void 0),ge([t.Property(!1)],a.prototype,"allowNumberFormatting",void 0),ge([t.Property("auto")],a.prototype,"height",void 0),ge([t.Property("auto")],a.prototype,"width",void 0),ge([t.Property(!1)],a.prototype,"allowExcelExport",void 0),ge([t.Property(!1)],a.prototype,"enableVirtualization",void 0),ge([t.Property(!1)],a.prototype,"allowDrillThrough",void 0),ge([t.Property(!1)],a.prototype,"allowPdfExport",void 0),ge([t.Property(!1)],a.prototype,"allowDeferLayoutUpdate",void 0),ge([t.Property(1e3)],a.prototype,"maxNodeLimitInMemberEditor",void 0),ge([t.Property()],a.prototype,"cellTemplate",void 0),ge([t.Event()],a.prototype,"queryCellInfo",void 0),ge([t.Event()],a.prototype,"headerCellInfo",void 0),ge([t.Event()],a.prototype,"resizing",void 0),ge([t.Event()],a.prototype,"resizeStop",void 0),ge([t.Event()],a.prototype,"pdfHeaderQueryCellInfo",void 0),ge([t.Event()],a.prototype,"pdfQueryCellInfo",void 0),ge([t.Event()],a.prototype,"excelHeaderQueryCellInfo",void 0),ge([t.Event()],a.prototype,"excelQueryCellInfo",void 0),ge([t.Event()],a.prototype,"columnDragStart",void 0),ge([t.Event()],a.prototype,"columnDrag",void 0),ge([t.Event()],a.prototype,"columnDrop",void 0),ge([t.Event()],a.prototype,"beforeColumnsRender",void 0),ge([t.Event()],a.prototype,"selected",void 0),ge([t.Event()],a.prototype,"cellDeselected",void 0),ge([t.Event()],a.prototype,"rowSelected",void 0),ge([t.Event()],a.prototype,"rowDeselected",void 0),ge([t.Event()],a.prototype,"chartTooltipRender",void 0),ge([t.Event()],a.prototype,"chartLoaded",void 0),ge([t.Event()],a.prototype,"chartLoad",void 0),ge([t.Event()],a.prototype,"chartResized",void 0),ge([t.Event()],a.prototype,"chartAxisLabelRender",void 0),ge([t.Event()],a.prototype,"contextMenuClick",void 0),ge([t.Event()],a.prototype,"contextMenuOpen",void 0),ge([t.Event()],a.prototype,"onPdfCellRender",void 0),ge([t.Event()],a.prototype,"saveReport",void 0),ge([t.Event()],a.prototype,"fetchReport",void 0),ge([t.Event()],a.prototype,"loadReport",void 0),ge([t.Event()],a.prototype,"renameReport",void 0),ge([t.Event()],a.prototype,"removeReport",void 0),ge([t.Event()],a.prototype,"newReport",void 0),ge([t.Event()],a.prototype,"toolbarRender",void 0),ge([t.Event()],a.prototype,"toolbarClick",void 0),ge([t.Event()],a.prototype,"load",void 0),ge([t.Event()],a.prototype,"enginePopulating",void 0),ge([t.Event()],a.prototype,"enginePopulated",void 0),ge([t.Event()],a.prototype,"onFieldDropped",void 0),ge([t.Event()],a.prototype,"dataBound",void 0),ge([t.Event()],a.prototype,"created",void 0),ge([t.Event()],a.prototype,"destroyed",void 0),ge([t.Event()],a.prototype,"beforeExport",void 0),ge([t.Event()],a.prototype,"cellClick",void 0),ge([t.Event()],a.prototype,"drillThrough",void 0),ge([t.Event()],a.prototype,"beginDrillThrough",void 0),ge([t.Event()],a.prototype,"hyperlinkCellClick",void 0),ge([t.Event()],a.prototype,"cellSelecting",void 0),ge([t.Event()],a.prototype,"drill",void 0),ge([t.Event()],a.prototype,"cellSelected",void 0),ge([t.Event()],a.prototype,"chartSeriesCreated",void 0),ge([t.Event()],a.prototype,"aggregateCellInfo",void 0),ge([t.Event()],a.prototype,"fieldListRefreshed",void 0),a=o=ge([t.NotifyPropertyChanges],a)}(t.Component),Ce=function(){function e(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",delete:"delete",enter:"enter"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"delete":this.processDelete(e);break;case"enter":this.processOpenContextMenu(e)}},e.prototype.processOpenContextMenu=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button")&&t.closest(i,".e-values"))return i.querySelector(".e-dropdown-icon").click(),void e.preventDefault()},e.prototype.processSort=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button")&&!t.closest(i,".e-values")&&!t.closest(i,".e-axis-filter"))return i.querySelector(".e-sort").click(),void e.preventDefault()},e.prototype.processFilter=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button")&&!t.closest(i,".e-values"))return i.querySelector(".e-btn-filter").click(),void e.preventDefault()},e.prototype.processDelete=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button"))return i.querySelector(".e-remove").click(),void e.preventDefault()},e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),we=function(){function e(e){this.parent=e}return e.prototype.updateSorting=function(e){if(!e.target.classList.contains("e-btn-filter")&&!e.target.classList.contains("e-remove")){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var i=e.target,r=void 0,n=void 0,a=void 0;i.id?(r=i.id,n=[].slice.call(i.querySelectorAll(".e-descend"))):(r=i.parentElement.id,n=[].slice.call(i.parentElement.querySelectorAll(".e-descend"))),a=0!==n.length;var o=this.getSortItemByName(r);if(t.isNullOrUndefined(o)){s={name:r,order:a?"Ascending":"Descending"};this.parent.dataSourceSettings.sortSettings.push(s)}else{for(var l=0;l<this.parent.dataSourceSettings.sortSettings.length;l++)if(this.parent.dataSourceSettings.sortSettings[l].name===r){this.parent.dataSourceSettings.sortSettings.splice(l,1);break}var s={name:r,order:a?"Ascending":"Descending"};this.parent.dataSourceSettings.sortSettings.push(s)}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1],a?t.removeClass([i],"e-descend"):t.addClass([i],"e-descend")}},e.prototype.updateFiltering=function(e){var i=e.target,r=i.parentElement.id,n=i.parentElement.textContent,a=!1,o=[];this.parent.engineModule.fieldList[r].dateMember="Ascending"===this.parent.engineModule.fieldList[r].sort?this.parent.engineModule.fieldList[r].dateMember.sort(function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0}):"Descending"===this.parent.engineModule.fieldList[r].sort?this.parent.engineModule.fieldList[r].dateMember.sort(function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0}):this.parent.engineModule.fieldList[r].dateMember;var l=this.getFilterItemByName(r);t.isNullOrUndefined(l)||(a="Include"===l.type,o=l.items?l.items:[]);var s=this.getTreeData(a,this.parent.engineModule.fieldList[r].dateMember,o,r);this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var d;d=d="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Wrapper"),this.parent.filterDialog.createFilterDialog(s,r,n,d)},e.prototype.getSortItemByName=function(e){var t=this.parent.dataSourceSettings.sortSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFilterItemByName=function(e){var t=this.parent.dataSourceSettings.filterSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFormatItemByName=function(e){var t=this.parent.dataSourceSettings.formatSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.searchTreeNodes=function(e,t,i){if(i){for(var r=[],n=[],a=0,o=[].slice.call(t.element.querySelectorAll("li"));a<o.length;a++){var l=o[a];l.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?r.push(l):n.push(l)}t.enableNodes(r),t.disableNodes(n)}else{r=[];this.parent.searchTreeItems=[];var s=0;s=1;for(var d=0,p=this.parent.currentTreeItems;d<p.length;d++){var h=p[d];h.name.toLowerCase().indexOf(e.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(h),s<=this.parent.control.maxNodeLimitInMemberEditor&&r.push(h),s++)}--s>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=s-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1),this.parent.isDataOverflow=s>this.parent.control.maxNodeLimitInMemberEditor,this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"inline-block":"none",t.fields={dataSource:r,id:"id",text:"name",isChecked:"checkedStatus"},t.dataBind()}},e.prototype.getTreeData=function(e,t,i,r){this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={},this.parent.savedTreeFilterPos={},this.parent.isDateField=this.parent.engineModule.formatFields[r]&&["date","dateTime","time"].indexOf(this.parent.engineModule.formatFields[r].type)>-1;for(var n=[],a=1,o={},l=0,s=i;l<s.length;l++){var d=s[l];o[d]=d}for(var p=0,h=t;p<h.length;p++){var c=h[p],u=this.parent.isDateField?c.formattedText:c.actualText.toString(),g={id:c.actualText.toString(),name:u,checkedStatus:!e};void 0!==o[u]&&(g.checkedStatus=!!e),a<=this.parent.control.maxNodeLimitInMemberEditor&&n.push(g),g.checkedStatus||(this.parent.savedTreeFilterPos[a-1]=u),this.parent.currentTreeItems.push(g),this.parent.searchTreeItems.push(g),this.parent.currentTreeItemsPos[c.actualText]=a-1,a++}return this.parent.isDataOverflow=a-1>this.parent.control.maxNodeLimitInMemberEditor,n},e}(),xe=function(){function e(e){this.parent=e}return e.prototype.onStateModified=function(e,i){var r="",n=!0,a=t.closest(e.target,".e-droppable"),o=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,a&&(r="e-rows"===a.classList[1]?"rows":"e-columns"===a.classList[1]?"columns":"e-values"===a.classList[1]?"values":"e-filters"===a.classList[1]?"filters":""),e.cancel&&""===r||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===r||"values"===r||r.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return n=!1;if(""!==r){if(this.parent.engineModule.fieldList[i]&&"CalculatedField"===this.parent.engineModule.fieldList[i].aggregateType&&"values"!==r){var l=this.parent.localeObj.getConstant("warning"),s=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(l,s),n=!1}o=this.getButtonPosition(e.target,r)}else this.parent.engineModule.fieldList[i]&&(this.parent.engineModule.fieldList[i].isSelected=!1);return this.parent.dataSourceUpdate.updateDataSource(i,r,o),n},e.prototype.getButtonPosition=function(e,i){var r=-1,n=t.closest(e,".e-pvt-btn-div");if(!t.isNullOrUndefined(n)){n=n.querySelector(".e-pivot-button");for(var a=this.parent.element.querySelector(".e-"+i),o=[].slice.call(a.querySelectorAll(".e-pivot-button")),l=0,s=o.length;l<s;l++)if(o[l].id===n.id){r=l;break}}return r},e}(),Te=function(){function e(e){this.parent=e}return e.prototype.updateDataSource=function(e,t,i){var r;if(this.control&&this.btnElement&&"true"===this.btnElement.getAttribute("isvalue"))switch(t){case"":this.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":this.control.setProperties({dataSourceSettings:{valueAxis:"row"}},!0);break;case"columns":this.control.setProperties({dataSourceSettings:{valueAxis:"column"}},!0)}else"CalculatedField"===(r=(r=this.removeFieldFromReport(e.toString()))||this.getNewField(e.toString())).type&&""!==t&&(t="values");if(this.control){var n={droppedField:r,dataSourceSettings:this.parent.dataSourceSettings,droppedAxis:t};this.control.trigger("onFieldDropped",n)}if(r)switch(t){case"filters":-1!==i?this.parent.dataSourceSettings.filters.splice(i,0,r):this.parent.dataSourceSettings.filters.push(r);break;case"rows":-1!==i?this.parent.dataSourceSettings.rows.splice(i,0,r):this.parent.dataSourceSettings.rows.push(r);break;case"columns":-1!==i?this.parent.dataSourceSettings.columns.splice(i,0,r):this.parent.dataSourceSettings.columns.push(r);break;case"values":-1!==i?this.parent.dataSourceSettings.values.splice(i,0,r):this.parent.dataSourceSettings.values.push(r)}},e.prototype.removeFieldFromReport=function(e){for(var t,i=!1,r=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],n=this.parent.engineModule.fieldList[e],a=0,o=r.length;a<o;a++)if(!i&&r[a])for(var l=0,s=r[a].length;l<s;l++)if(r[a][l].name===e){(t=r[a][l].properties?r[a][l].properties:r[a][l]).type="number"===n.type?t.type:"Count",r[a].splice(l,1),i=!0;break}return t},e.prototype.getNewField=function(e){var t=this.parent.engineModule.fieldList[e];return{name:e,caption:t.caption,type:void 0===t.aggregateType?"number"===t.type?"Sum":"Count":t.aggregateType,showNoDataItems:t.showNoDataItems,baseField:t.baseField,baseItem:t.baseItem}},e}(),De=function(){function e(e){this.parent=e}return e.prototype.createErrorDialog=function(e,i){var n=t.createElement("div",{id:this.parent.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(n),this.errorPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:i,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:1000001,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.isStringTemplate=!0,this.errorPopUp.appendTo(n),this.errorPopUp.element.querySelector(".e-dlg-header").innerHTML=e},e.prototype.closeErrorDialog=function(){this.errorPopUp.close()},e.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&this.errorPopUp.destroy(),document.getElementById(this.parent.parentID+"_ErrorDialog")&&t.remove(document.getElementById(this.parent.parentID+"_ErrorDialog"))},e}(),Me=function(){function e(e){this.parent=e}return e.prototype.createFilterDialog=function(e,i,n,a){var o=t.createElement("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog",attrs:{"data-fieldName":i,"aria-label":n},styles:"visibility:hidden;"}),l=this.parent.engineModule.fieldList[i].caption,s=this.parent.localeObj.getConstant("filter")+' "'+n+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(i),this.allowExcelLikeFilter=this.isExcelFilter(i),this.parent.element.appendChild(o),this.dialogPopUp=new r.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?s:l,content:this.allowExcelLikeFilter?"":this.createTreeView(e,n,i),isModal:"Popup"===this.parent.renderMode||!!this.parent.isAdaptive,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,width:"auto",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:a,close:this.removeFilterDialog.bind(this),open:this.dialogOpen.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(o),this.dialogPopUp.element.querySelector(".e-dlg-header").innerHTML=this.allowExcelLikeFilter?s:l,this.allowExcelLikeFilter?(this.createTabMenu(e,n,i),t.addClass([this.dialogPopUp.element],"e-excel-filter"),this.updateCheckedState(n)):this.updateCheckedState(n),t.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"}),this.allowExcelLikeFilter&&this.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus()},e.prototype.dialogOpen=function(e){e.element.querySelector(".e-editor-label-wrapper")&&(e.element.querySelector(".e-editor-label-wrapper").style.width=e.element.offsetWidth+"px")},e.prototype.createTreeView=function(e,i,r){var n=this,l=t.createElement("div",{id:this.parent.parentID+"EditorDiv",className:"e-member-editor-wrapper"+(this.allowExcelLikeFilter?" e-excelfilter":"")}),s=t.createElement("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),d=this.parent.engineModule.fieldList[r].caption,p=t.createElement("input",{attrs:{type:"text"}}),h=t.createElement("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1"},className:"e-editor-label-wrapper"});this.parent.editorLabelElement=t.createElement("label",{className:"e-editor-label"}),this.parent.editorLabelElement.innerText=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",h.style.display=this.parent.isDataOverflow?"inline-block":"none",h.appendChild(this.parent.editorLabelElement),s.appendChild(p);var c=t.createElement("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-wrapper"}),u=t.createElement("div",{className:"e-select-all"}),g=t.createElement("div",{className:"e-member-editor-container"}),m=t.createElement("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")});c.appendChild(u),l.appendChild(s),l.appendChild(c),l.appendChild(m),this.editorSearch=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+' "'+d+'"',enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",showClearButton:!0,change:function(e){n.parent.eventBase.searchTreeNodes(e,n.memberTreeView,!1);var r=n.dialogPopUp.element;0===[].slice.call(n.memberTreeView.element.querySelectorAll("li")).length?(n.allMemberSelect.disableNodes([n.allMemberSelect.element.querySelector("li")]),r.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),t.removeClass([m],"e-disable")):(n.allMemberSelect.enableNodes([n.allMemberSelect.element.querySelector("li")]),r.querySelector(".e-ok-btn").removeAttribute("disabled"),t.addClass([m],"e-disable")),n.updateCheckedState(i)}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(p);var v=[{id:"all",name:"All",checkedStatus:!0}];return this.allMemberSelect=new a.TreeView({fields:{dataSource:v,id:"id",text:"name",isChecked:"checkedStatus"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeClicked:this.nodeCheck.bind(this),keyPress:this.nodeCheck.bind(this)}),this.allMemberSelect.isStringTemplate=!0,this.allMemberSelect.appendTo(u),l.appendChild(g),this.memberTreeView=new a.TreeView({fields:{dataSource:e,id:"id",text:"name",isChecked:"checkedStatus"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this),keyPress:this.nodeCheck.bind(this)}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(g),l.appendChild(h),l},e.prototype.nodeCheck=function(e){var t=[e.node];(e.event.target.classList.contains("e-fullrow")||"Enter"===e.event.key)&&("true"===this.memberTreeView.getNode(e.node).isChecked?this.memberTreeView.uncheckAll(t):this.memberTreeView.checkAll(t))},e.prototype.createTabMenu=function(e,i,r){var n=t.createElement("div",{className:"e-filter-tab-wrapper"});this.dialogPopUp.content=n,this.dialogPopUp.dataBind();for(var o=["Label","Value","Include","Exclude"],l="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",s=Object.keys(this.parent.engineModule.fieldList[r].members)[0],d=this.parent.engineModule.fieldList[r].type,p=this.parent.eventBase.getFormatItemByName(r),h=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&o.indexOf(this.filterObject.type)>1?"e-selected-option-icon":""},content:this.createTreeView(e,i,r)}],c=0,u=o;c<u.length;c++){var g=u[c];if("Label"===g&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===g&&this.parent.dataSourceSettings.allowValueFilter){var m="Label"===g&&s.match(l)&&s.match(l)[0].length===s.length&&"number"===d?"Number":"Label"===g&&"Invalid Date"!==new Date(s).toString()&&(p&&p.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":g,v={header:{text:"Number"===m?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(m.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===m?"e-selected-option-icon":""},content:this.createCustomFilter(r,this.filterObject&&this.filterObject.type===m?this.filterObject:void 0,m.toLowerCase())};h.push(v)}}var f=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;this.tabObj=new a.Tab({heightAdjustMode:"Auto",items:h,height:"100%",selectedItem:f,enableRtl:this.parent.enableRtl}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(n),f>0&&t.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===f&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},e.prototype.createCustomFilter=function(e,i,r){for(var n=[],a=[],o=this.parent.dataSourceSettings.values,l="DoesNotEquals",s=0,d={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},p=["Between","NotBetween"],h="label"===r?d.label:"date"===r?d.date:d.value,c=0,u=h;c<u.length;c++){var g=u[c];l=i&&g===i.condition?h.indexOf(i.condition)>=0?i.condition:h[0]:l,n.push({value:g,text:this.parent.localeObj.getConstant(g)})}for(var m=o.length;m--;)a.unshift({value:o[m].name,text:o[m].caption?o[m].caption:o[m].name}),s=i&&"Value"===i.type&&i.measure===o[m].name&&i.condition===l?m:s;var v=t.createElement("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(r)>=0?"label":r)+"-filter",id:this.parent.parentID+"_"+r+"_filter_div_content",attrs:{"data-type":r,"data-fieldName":e,"data-operator":l,"data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[s].name:"","data-value1":i&&l===i.condition&&i.value1?i.value1.toString():"","data-value2":i&&l===i.condition&&i.value2?i.value2.toString():""}}),f=t.createElement("div",{className:"e-filter-text-div",innerHTML:this.parent.localeObj.getConstant(r+"TextContent")}),y=t.createElement("div",{className:"e-between-text-div "+(-1===p.indexOf(l)?"e-disable":""),innerHTML:this.parent.localeObj.getConstant("And")}),S=t.createElement("div",{className:"e-separator-div"}),b=t.createElement("div",{className:"e-filter-option-wrapper-1"}),C=t.createElement("div",{className:"e-measure-option-wrapper "+(["label","date","number"].indexOf(r)>=0?"e-disable":"")}),w=t.createElement("div",{className:"e-condition-option-wrapper"}),x=t.createElement("div",{className:"e-filter-option-wrapper-2"}),T=t.createElement("div",{id:this.parent.parentID+"_"+r+"_measure_option_wrapper"}),D=t.createElement("div",{id:this.parent.parentID+"_"+r+"_contition_option_wrapper"}),M=t.createElement("div",{className:"e-filter-input-div-1"}),O=t.createElement("div",{className:"e-filter-input-div-2 "+(-1===p.indexOf(l)?"e-disable":"")}),P=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_1",attrs:{type:"text"}}),L=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_2",attrs:{type:"text"}});return M.appendChild(P),O.appendChild(L),C.appendChild(T),C.appendChild(S),w.appendChild(D),b.appendChild(C),b.appendChild(w),x.appendChild(M),x.appendChild(y),x.appendChild(O),this.createElements(i,p,T,D,P,L,a,n,s,l,r),v.appendChild(f),v.appendChild(b),v.appendChild(x),v},e.prototype.createElements=function(e,i,r,a,s,d,p,c,u,g,m){var v=this,f=new l.DropDownList({dataSource:p,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:u,cssClass:"e-value-options",width:"100%",change:function(e){var i=v.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||(v.updateInputValues(i,m,s,d),n.setStyleAndAttributes(i,{"data-measure":e.value}))}});f.isStringTemplate=!0,f.appendTo(r);var y=new l.DropDownList({dataSource:c,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:g,cssClass:"e-filter-operator",width:"100%",change:function(e){var r=v.dialogPopUp.element.querySelector(".e-selected-tab");if(!t.isNullOrUndefined(r)){v.updateInputValues(r,m,s,d);for(var a=0,o=["e-between-text-div","e-filter-input-div-2"];a<o.length;a++){var l=o[a];i.indexOf(e.value)>=0?t.removeClass([r.querySelector("."+l)],"e-disable"):t.addClass([r.querySelector("."+l)],"e-disable")}n.setStyleAndAttributes(r,{"data-operator":e.value})}}});if(y.isStringTemplate=!0,y.appendTo(a),"date"===m){var S=new h.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&g===e.condition?"string"==typeof e.value1?new Date(e.value1):e.value1:null,change:function(e){var i=v.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||n.setStyleAndAttributes(i,{"data-value1":e.value,"data-value2":b.value})},width:"100%"}),b=new h.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&g===e.condition?"string"==typeof e.value2?new Date(e.value2):e.value2:null,change:function(e){var i=v.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||n.setStyleAndAttributes(i,{"data-value1":S.value,"data-value2":e.value})},width:"100%"});S.isStringTemplate=!0,S.appendTo(s),b.isStringTemplate=!0,b.appendTo(d)}else if("value"===m){var C=new o.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&g===e.condition?parseInt(e.value1,10):void 0,change:function(e){var i=v.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||n.setStyleAndAttributes(i,{"data-value1":e.value?e.value.toString():"0","data-value2":w.value?w.value.toString():"0"})},width:"100%"}),w=new o.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&g===e.condition?parseInt(e.value2,10):void 0,change:function(e){var i=v.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||n.setStyleAndAttributes(i,{"data-value1":C.value?C.value.toString():"0","data-value2":e.value?e.value.toString():"0"})},width:"100%"});C.isStringTemplate=!0,C.appendTo(s),w.isStringTemplate=!0,w.appendTo(d)}else{var x=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&g===e.condition?e.value1:"",change:function(e){var i=v.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||n.setStyleAndAttributes(i,{"data-value1":e.value,"data-value2":T.value})},width:"100%"}),T=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&g===e.condition?e.value2:"",change:function(e){var i=v.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||n.setStyleAndAttributes(i,{"data-value1":x.value,"data-value2":e.value})},width:"100%"});x.isStringTemplate=!0,x.appendTo(s),T.isStringTemplate=!0,T.appendTo(d)}},e.prototype.updateInputValues=function(e,i,r,a){var o,l;if("date"===i){var s=r.ej2_instances[0],d=a.ej2_instances[0];o=t.isNullOrUndefined(s.value)?"":s.value.toString(),l=t.isNullOrUndefined(d.value)?"":d.value.toString()}else{var s=r.ej2_instances[0],d=a.ej2_instances[0];o=s.value,l=d.value}n.setStyleAndAttributes(e,{"data-value1":o,"data-value2":l})},e.prototype.validateTreeNode=function(e){e.node.classList.contains("e-disable")&&(e.cancel=!0)},e.prototype.updateCheckedState=function(e){var i=this.dialogPopUp.element;n.setStyleAndAttributes(i,{role:"menu","aria-haspopup":"true"});var r=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),a=this.getUnCheckedNodes(),o=this.getCheckedNodes(),l=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");r.length>0?o.length>0?(a.length>0?(t.removeClass([l],"e-check"),t.addClass([l],"e-stop")):0===a.length&&(t.removeClass([l],"e-stop"),t.addClass([l],"e-check")),this.dialogPopUp.buttons[0].buttonModel.disabled=!1,i.querySelector(".e-ok-btn").removeAttribute("disabled")):a.length>0&&0===o.length&&(t.removeClass([l],["e-check","e-stop"]),this.getCheckedNodes().length===o.length&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,i.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))):(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,i.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))},e.prototype.getCheckedNodes=function(){return this.parent.searchTreeItems.filter(function(e){return e.checkedStatus})},e.prototype.getUnCheckedNodes=function(){return this.parent.searchTreeItems.filter(function(e){return!e.checkedStatus})},e.prototype.isExcelFilter=function(e){for(var t=!1,i=0,r=this.parent.dataSourceSettings.filters;i<r.length;i++)if(r[i].name===e){t=!0;break}return!(t||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)},e.prototype.getFilterObject=function(e){var t=this.parent.eventBase.getFilterItemByName(e);if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0))return t},e.prototype.closeFilterDialog=function(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy(),this.dialogPopUp.close()},e.prototype.removeFilterDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy(),document.getElementById(this.parent.parentID+"_EditorTreeView")&&t.remove(document.getElementById(this.parent.parentID+"_EditorTreeView"))},e}(),Oe=function(){function e(e){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=e.element,this.moduleName=e.moduleName,this.dataSourceSettings=e.dataSourceSettings,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.nodeStateModified=new xe(this),this.dataSourceUpdate=new Te(this),this.eventBase=new we(this),this.filterDialog=new Me(this),this.errorDialog=new De(this),this.keyboardModule=new Ce(this),this}return e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),Pe=function(){function e(e){this.parent=e}return e.prototype.render=function(){var e=t.createElement("div",{id:this.parent.element.id+"_Wrapper",className:w,styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?t.addClass([e],b):t.removeClass([e],b),this.parent.enableRtl?t.addClass([e],S):t.removeClass([e],S),this.parent.cssClass&&t.addClass([e],this.parent.cssClass),this.parentElement=t.createElement("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=t.createElement("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list")),this.wireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list"))):this.renderStaticLayout(e)},e.prototype.renderStaticLayout=function(e){if(!this.parent.isAdaptive){var i=t.createElement("div",{className:"e-field-list-title"}),r=t.createElement("div",{className:"e-title-content",innerHTML:this.parent.localeObj.getConstant("staticFieldList")});i.appendChild(r),i.appendChild(this.createCalculatedButton()),t.addClass([e],"e-static"),e.appendChild(i),e.appendChild(this.parentElement),t.addClass([e],"e-static"),this.parent.allowDeferLayoutUpdate&&(e.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons())}},e.prototype.renderDeferUpdateButtons=function(){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new c.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:!0,enableRtl:this.parent.enableRtl,change:this.onCheckChange.bind(this)}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo("#"+this.parent.element.id+"DeferUpdateCheckBox"),this.deferUpdateApplyButton=new c.Button({cssClass:"e-defer-apply-button e-defer-update-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,isPrimary:!0}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton1"),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this)),this.deferUpdateCancelButton=new c.Button({cssClass:"e-defer-cancel-button e-cancel-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.isStringTemplate=!0,this.deferUpdateCancelButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton2"),this.deferUpdateCancelButton.element.onclick="Fixed"===this.parent.renderMode?this.cancelButtonClick.bind(this):this.onCloseFieldList.bind(this)},e.prototype.createDeferUpdateButtons=function(){var e=t.createElement("div",{className:"e-layout-footer"});if(this.parent.allowDeferLayoutUpdate){var i=t.createElement("div",{className:"e-checkbox-layout"}),r=t.createElement("input",{id:this.parent.element.id+"DeferUpdateCheckBox"});i.appendChild(r),e.appendChild(i)}var n=t.createElement("div",{className:"e-button-layout"});if(this.parent.allowDeferLayoutUpdate){var a=t.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton1"});n.appendChild(a)}var o=t.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton2"});return n.appendChild(o),e.appendChild(n),e},e.prototype.onCheckChange=function(e){e.checked&&(this.parent.clonedDataSource=t.extend({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)),this.parent.allowDeferLayoutUpdate=!this.parent.allowDeferLayoutUpdate,"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate})):this.parent.allowDeferLayoutUpdate?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0),this.cancelButtonClick()},e.prototype.applyButtonClick=function(){this.parent.updateDataSource(!1),this.parent.axisFieldModule.render(),this.parent.clonedDataSource=t.extend({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)},e.prototype.cancelButtonClick=function(){this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),this.parent.engineModule.fieldList=t.extend({},this.parent.clonedFieldList,null,!0),this.parent.updateDataSource(!1,!0)},e.prototype.renderFieldListDialog=function(e){var i=t.createElement("div",{className:"e-toggle-field-list e-icons e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList")}});if(this.parent.element.appendChild(i),this.parent.isAdaptive){var n='<div class=e-title-mobile-header><span class="e-icons e-field-list-back-icon"></span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"</div></div>",a=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:"e-field-list-btn e-small e-round",iconCss:C+" e-add-icon",isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:C+" e-add-icon",enableRtl:this.parent.enableRtl,isPrimary:!0}}];this.fieldListDialog=new r.Dialog({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:n,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:a,target:document.body,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),this.fieldListDialog.element.querySelector(".e-dlg-header").innerHTML=n,t.setStyleAttribute(e.querySelector("#"+e.id+"_dialog-content"),{padding:"0"});var o=e.querySelector(".e-footer-content");t.addClass([o],"e-field-list-footer"),t.removeClass([o.querySelector(".e-calculated-field-btn")],"e-flat"),t.removeClass([o.querySelector(".e-field-list-btn")],"e-flat"),this.fieldListDialog.element.querySelector(".e-field-list-back-icon").onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)}else{var l=this.createDeferUpdateButtons().outerHTML,n="<div class=e-title-header><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new r.Dialog({animationSettings:{effect:"Zoom"},header:n,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:l,closeOnEscape:!0,target:t.isNullOrUndefined(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),this.fieldListDialog.element.querySelector(".e-dlg-header").innerHTML=n,this.fieldListDialog.element.querySelector(".e-footer-content").innerHTML=l,this.renderDeferUpdateButtons(),t.setStyleAttribute(e.querySelector("#"+e.id+"_title"),{width:"100%"}),e.querySelector(".e-title-header").appendChild(this.createCalculatedButton())}},e.prototype.updateDataSource=function(e){for(var t=["filters","columns","rows","values"],i=0,r=e;i<r.length;i++){var n=r[i],a=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(n,a,-1)}this.parent.axisFieldModule.render(),this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},e.prototype.onDeferUpdateClick=function(){this.parent.updateDataSource(),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.renderAdaptiveLayout=function(e){var i=t.createElement("div",{className:"e-field-list-footer"});e.appendChild(this.parentElement);var r=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||r.pop(),this.adaptiveElement=new a.Tab({heightAdjustMode:"Auto",items:r,height:"100%",enableRtl:this.parent.enableRtl,selected:this.tabSelect.bind(this)}),"Fixed"===this.parent.renderMode?(i.appendChild(this.createAddButton()),t.addClass([e],"e-static"),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(i)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))},e.prototype.tabSelect=function(e){this.parentElement.querySelector("."+w+" .e-field-list-btn")&&(4!==e.selectedIndex?(t.addClass([this.parentElement.querySelector("."+w+" .e-calculated-field-btn")],"e-disable"),t.removeClass([this.parentElement.querySelector("."+w+" .e-field-list-btn")],"e-disable")):(t.removeClass([this.parentElement.querySelector("."+w+" .e-calculated-field-btn")],"e-disable"),t.addClass([this.parentElement.querySelector("."+w+" .e-field-list-btn")],"e-disable"))),4===e.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify("init-calculatedfield",{})):this.parent.axisFieldModule.render()},e.prototype.createCalculatedButton=function(){var e=t.createElement("div",{id:this.parent.element.id+"_CalculatedField"}),i=new c.Button({cssClass:"e-calculated-field e-disable",content:this.parent.localeObj.getConstant("calculatedField"),enableRtl:this.parent.enableRtl});return i.isStringTemplate=!0,i.appendTo(e),this.parent.calculatedFieldModule&&t.removeClass([e],"e-disable"),i.element.onclick=this.showCalculatedField.bind(this),e},e.prototype.createAddButton=function(){var e=t.createElement("div",{className:"e-field-list-footer-content"}),i=t.createElement("div",{}),r=t.createElement("div",{}),n=new c.Button({cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:C+" e-add-icon",enableRtl:this.parent.enableRtl}),a=new c.Button({cssClass:"e-field-list-btn e-small e-round",iconCss:C+" e-add-icon",enableRtl:this.parent.enableRtl});return a.isStringTemplate=!0,a.appendTo(i),n.isStringTemplate=!0,n.appendTo(r),e.appendChild(i),e.appendChild(r),n.element.onclick=this.showCalculatedField.bind(this),a.element.onclick=this.showFieldListDialog.bind(this),e},e.prototype.createAxisTable=function(e){var i=t.createElement("div",{className:"e-field-list-"+e}),r=t.createElement("div",{className:"e-axis-content e-"+e}),n=t.createElement("span",{className:"e-draggable-prompt",innerHTML:this.parent.localeObj.getConstant("addPrompt")});return i.appendChild(r),i.appendChild(n),i},e.prototype.showCalculatedField=function(e){this.parent.isAdaptive||this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),t.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")),this.parent.notify("init-calculatedfield",{})},e.prototype.showFieldListDialog=function(e){var t=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(t)},e.prototype.onShowFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=t.extend({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)),t.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top},e.prototype.onCloseFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.dataSourceSettings=t.extend({},this.parent.clonedDataSource.properties,null,!0),this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),this.parent.engineModule.fieldList=t.extend({},this.parent.clonedFieldList,null,!0),this.parent.pivotGridModule.notify(m,this),this.parent.pivotGridModule.notify(v,this)),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.removeFieldListIcon=function(){document.getElementById(this.parent.element.id+"calculateddialog")||t.removeClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")},e.prototype.keyPress=function(e){e.target;if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireDialogEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.onShowFieldList,this)},e.prototype.unWireDialogEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.onShowFieldList)},e}(),Le=function(){function e(e){this.selectedNodes=[],this.parent=e,this.addEventListener()}return e.prototype.render=function(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.parent.isAdaptive)this.renderTreeDialog(e);else{var i=t.createElement("div",{className:"e-field-table"}),r=t.createElement("div",{className:"e-field-header",innerHTML:this.parent.localeObj.getConstant("allFields")});if(this.treeViewElement=t.createElement("div",{id:this.parent.element.id+"_TreeView",className:"e-field-list"}),i.appendChild(r),i.appendChild(this.treeViewElement),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode){var n=t.createElement("div",{className:"e-center-div"}),a=t.createElement("div",{className:"e-center-title",innerHTML:this.parent.localeObj.getConstant("centerHeader")});this.parentElement.appendChild(n),this.parentElement.appendChild(a)}this.renderTreeView()}},e.prototype.renderTreeView=function(){this.fieldTable=new a.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected"},nodeChecked:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree",showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"Ascending",enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this)}),this.treeViewElement.innerHTML="",this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(this.treeViewElement),this.getTreeUpdate()},e.prototype.renderTreeDialog=function(e){var i=t.createElement("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog"});this.parentElement.appendChild(i),this.fieldDialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,width:"auto",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!0,target:this.parentElement.parentElement,close:this.dialogClose.bind(this)}),this.fieldDialog.isStringTemplate=!0,this.fieldDialog.appendTo(i),this.fieldDialog.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("adaptiveFieldHeader")},e.prototype.dialogClose=function(){document.getElementById(this.parent.element.id+"_FieldListTreeView")&&t.remove(document.getElementById(this.parent.element.id+"_FieldListTreeView"))},e.prototype.createTreeView=function(e){var i=t.createElement("div",{id:this.parent.element.id+"EditorDiv",className:"e-member-editor-wrapper"}),r=t.createElement("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),n=t.createElement("input",{attrs:{type:"text"}});r.appendChild(n);var l=t.createElement("div",{className:"e-member-editor-container"});return i.appendChild(r),this.editorSearch=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(n),i.appendChild(l),this.fieldTable=new a.TreeView({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected"},showCheckBox:!0,sortOrder:"Ascending",enableRtl:this.parent.enableRtl,nodeChecked:this.addNode.bind(this)}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(l),i},e.prototype.textChange=function(e){this.parent.pivotCommon.eventBase.searchTreeNodes(e,this.fieldTable,!0)},e.prototype.dragStart=function(e){if(e.event.target.classList.contains("e-drag")){this.parent.isDragging=!0,t.addClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected");var i=this.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")],r=["e-rows","e-columns","e-filters"];if(i&&"CalculatedField"===i.aggregateType)for(var n=0,a=r;n<a.length;n++){var o=a[n];t.addClass([this.parentElement.querySelector("."+o)],"e-drag-restrict")}}else e.cancel=!0},e.prototype.dragStop=function(e){e.cancel=!0,this.parent.isDragging=!1;for(var i=0,r=["e-rows","e-columns","e-filters"];i<r.length;i++){var n=r[i];t.removeClass([this.parentElement.querySelector("."+n)],"e-drag-restrict")}t.removeClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected"),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var a=e.draggedNodeData.id.toString();this.isNodeDropped(e,a)&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,a)&&(this.parent.allowDeferLayoutUpdate?this.updateDataSource():this.parent.updateDataSource(),this.parent.axisFieldModule.render()))},e.prototype.isNodeDropped=function(e,i){var r=!0;if("true"===e.draggedNodeData.isChecked){var n=this.getButton(i),a=t.closest(n,".e-droppable"),o=t.closest(e.target,".e-droppable");if(n&&a===o){for(var l=[].slice.call(a.querySelectorAll(".e-pivot-button")),s=t.closest(e.target,".e-pvt-btn-div"),d=void 0,p=-1,h=0,c=l.length;h<c;h++)if(l[h].id===n.id&&(d=h),s){var u=s.querySelector(".e-pivot-button");l[h].id===u.id&&(p=h)}if(d===p||d===l.length-1&&-1===p){var g=document.getElementById(this.parent.element.id+"_Wrapper");t.removeClass([].slice.call(g.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),r=!1}}}return r},e.prototype.getButton=function(e){for(var t,i=document.getElementById(this.parent.element.id+"_Wrapper"),r=[].slice.call(i.querySelectorAll(".e-pivot-button")),n=0,a=r.length;n<a;n++)if(r[n].id===e){t=r[n];break}return t},e.prototype.nodeStateChange=function(e){this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var i=t.closest(e.node,".e-text-content"),r=this.parent.pivotFieldList[e.data[0].id.toString()];if("check"===e.action){t.addClass([i.querySelector(".e-list-text")],"e-selected-node");var n=this.parent.pivotCommon.dataSourceUpdate.getNewField(e.data[0].id.toString());"number"===r.type?this.parent.dataSourceSettings.values.push(n):this.parent.dataSourceSettings.rows.push(n)}else t.removeClass([i.querySelector(".e-list-text")],"e-selected-node"),this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(e.data[0].id.toString());this.parent.allowDeferLayoutUpdate?("check"===e.action?r.isSelected=!0:r.isSelected=!1,this.updateDataSource()):this.parent.updateDataSource(!0),this.parent.axisFieldModule.render()},e.prototype.updateDataSource=function(){"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(m,this)):this.parent.triggerPopulateEvent()},e.prototype.addNode=function(e){var t=this.parent.pivotFieldList[e.data[0].id.toString()];if("check"===e.action)this.selectedNodes.push(t.id.toString());else for(var i=this.selectedNodes.length;i--;)if(this.selectedNodes[i]===t.id.toString()){this.selectedNodes.splice(i,1);break}},e.prototype.getTreeUpdate=function(){for(var e=0,i=[].slice.call(this.treeViewElement.querySelectorAll(".e-text-content"));e<i.length;e++){var r=i[e],n=t.createElement("span",{attrs:{tabindex:"-1",title:this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:C+" e-drag"});t.prepend([n],r),r.querySelector(".e-check")&&t.addClass([r.querySelector(".e-list-text")],"e-selected-node")}},e.prototype.refreshTreeView=function(){this.fieldTable&&(this.fieldTable.fields={dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected"},this.fieldTable.dataBind(),this.getTreeUpdate())},e.prototype.getTreeData=function(e){for(var t=[],i=Object.keys(this.parent.pivotFieldList),r={},n=0,a=i;n<a.length;n++){var o=a[n],l=this.parent.pivotFieldList[o];r[o]={id:l.id,caption:l.caption,isSelected:l.isSelected}}if(this.parent.isAdaptive){for(var s=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],d=i.length;d--;)r[i[d]].isSelected=!1;for(var p=0,h=s;p<h.length;p++)r[h[p].name].isSelected=!0}for(var c=r,u=0,g=i;u<g.length;u++){var m=c[l=g[u]];t.push(m)}return t},e.prototype.onFieldAdd=function(e){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()},e.prototype.closeTreeDialog=function(){this.selectedNodes=[],this.fieldDialog.hide()},e.prototype.addEventListener=function(){this.parent.on("tree-view-update",this.refreshTreeView,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("tree-view-update",this.refreshTreeView)},e.prototype.destroy=function(){this.removeEventListener()},e}(),Ee=function(){function e(e){this.parent=e}return e.prototype.render=function(){if(!this.parent.isAdaptive){var e=t.createElement("div",{className:"e-axis-table"});this.leftAxisPanel=t.createElement("div",{className:"e-left-axis-fields"}),this.rightAxisPanel=t.createElement("div",{className:"e-right-axis-fields"}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()},e.prototype.renderAxisTable=function(){for(var e=["filters","rows","columns","values"],i=0,r=e.length;i<r;i++){var n=t.createElement("div",{className:"e-field-list-"+e[i]}),a=t.createElement("div",{className:"e-axis-wrapper"}),o=t.createElement("div",{className:"e-axis-header",innerHTML:this.parent.localeObj.getConstant(e[i])});a.appendChild(this.getIconupdate(e[i])),a.appendChild(o);var l=t.createElement("div",{className:"e-axis-content e-"+e[i]}),s=void 0;s="rows"===e[i]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===e[i]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===e[i]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");var d=t.createElement("span",{className:"e-draggable-prompt",innerHTML:s});new t.Droppable(l,{});n.appendChild(a),n.appendChild(l),n.appendChild(d),i<=1?this.leftAxisPanel.appendChild(n):this.rightAxisPanel.appendChild(n),this.unWireEvent(l),this.wireEvent(l)}},e.prototype.getIconupdate=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-axis-icon-wrapper"}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:C+" e-axis-"+e});return i.appendChild(r),i},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),t.EventHandler.add(e,"mouseleave",this.updateDropIndicator,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),t.EventHandler.remove(e,"mouseleave",this.updateDropIndicator)},e.prototype.updateDropIndicator=function(e){var i=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains("e-axis-content")&&"mouseover"===e.type){t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover");var r=[].slice.call(e.target.querySelectorAll(".e-pvt-btn-div"));r.length>0&&t.addClass([r[r.length-1].querySelector(".e-drop-indicator-last")],"e-drop-hover")}else"mouseleave"===e.type&&(t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},e}(),Fe=function(){function e(e){this.parent=e,this.menuOption=new j(this.parent),this.parent.pivotButtonModule=this,this.addEventListener(),this.parent instanceof Ie&&(this.axisField=new ke(this.parent))}return e.prototype.renderPivotButton=function(e){var i,r=t.extend([],e.field,null,!0),n=e.axis,a=-1,o="pivotfieldlist"==this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton;if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&o&&this.parent.dataSourceSettings.values.length>1&&(a=r.length,r.push({name:this.parent.localeObj.getConstant("values"),caption:this.parent.localeObj.getConstant("values"),axis:e.axis})),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Wrapper"),!this.parentElement.querySelector(".e-field-list-"+n))return;p=this.parentElement.querySelector(".e-field-list-"+n).querySelector(".e-draggable-prompt");0===r.length?t.removeClass([p],"e-disable"):t.addClass([p],"e-disable"),i=this.parentElement.querySelector(".e-field-list-"+n).querySelector(".e-axis-content")}else this.parentElement=this.parent.element,i=this.parentElement.querySelector(".e-group-"+n);if(i)if("pivotview"===this.parent.getModuleName()&&0===r.length){for(var s=0,d=this.parentElement.querySelectorAll(".e-group-"+n);s<d.length;s++)if(!(P=d[s]).classList.contains("e-group-chart-values")){var p=t.createElement("span",{className:"e-draggable-prompt",innerHTML:this.parent.groupingBarSettings.allowDragAndDrop?"rows"===n?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===n?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===n?this.parent.localeObj.getConstant("valueAxisPrompt"):this.parent.localeObj.getConstant("filterAxisPrompt"):""});P.appendChild(p)}}else{for(var h=0,u=r.length;h<u;h++)for(var g=0,m="pivotfieldlist"===this.parent.getModuleName()?[i]:this.parentElement.querySelectorAll(".e-group-"+n);g<m.length;g++)if(!(P=P=m[g]).classList.contains("e-group-chart-values")){var v=t.createElement("div",{className:"e-pvt-btn-div"+(0===h?" e-first-btn":""),attrs:{"data-tag":n+":"+r[h].name}}),f=t.createElement("div",{id:r[h].name,className:"e-pivot-button "+r[h].name.replace(/[^A-Z0-9]/gi,""),attrs:{"data-uid":r[h].name,tabindex:"0",isvalue:h===a?"true":"false","aria-disabled":"false","aria-label":r[h].caption?r[h].caption:r[h].name,"data-type":r[h].type,"data-caption":r[h].caption?r[h].caption:r[h].name,"data-basefield":r[h].baseField,"data-baseitem":r[h].baseItem}}),y=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator"}),S=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator-last"}),b=this.createButtonDragIcon(f),w=this.createButtonText(r,h,n,a);f.appendChild(w),-1===["filters","values"].indexOf(n)&&a!==h&&this.createSortOption(f,r[h].name),"values"!==n&&a!==h&&this.createFilterOption(f,r[h].name),"values"===n&&this.getTypeStatus(r,h,f);var x=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:C+" e-remove"});"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showRemoveIcon?t.removeClass([x],"e-disable"):t.addClass([x],"e-disable")),f.appendChild(x),v.appendChild(y),v.appendChild(f),v.appendChild(S),P.appendChild(v);var T=new c.Button({enableRtl:this.parent.enableRtl});T.isStringTemplate=!0,T.appendTo(f),this.unWireEvent(v,h===a?"values":n),this.wireEvent(v,h===a?"values":n),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&this.createDraggable("pivotview"===this.parent.getModuleName()?w:b)}if("values"===n)for(var D=this,M=0,O=this.parentElement.querySelectorAll(".e-group-"+n);M<O.length;M++){var P=O[M];!function(e){if(e.classList.contains("e-group-chart-values")){var i=r.map(function(e){return{text:e.caption?e.caption:e.name,value:e.name}}),n=D.parent;if(D.valueFiedDropDownList&&e.querySelector(".e-group-chart-values-drodown-div"))D.valueFiedDropDownList.dataSource=i,D.valueFiedDropDownList.value=n.chartSettings.enableMultiAxis?i[0].value:n.chartModule.currentMeasure;else{var a=t.createElement("div",{className:"e-group-chart-values-drodown-div"});e.appendChild(a),D.valueFiedDropDownList=new l.DropDownList({dataSource:i,enableRtl:D.parent.enableRtl,value:n.chartSettings.enableMultiAxis?i[0].value:n.chartModule.currentMeasure,width:200,fields:{value:"value",text:"text"},cssClass:"e-group-chart-values-drodown",change:function(e){e.e&&null!==e.e&&(n.chartSettings.value=e.value)}}),D.valueFiedDropDownList.isStringTemplate=!0,D.valueFiedDropDownList.appendTo(a)}}}(P)}}},e.prototype.createButtonText=function(e,i,r,n){var a,o;"filters"===r&&(o=this.updateButtontext(e[i].name)),void 0!==this.parent.engineModule.fieldList[e[i].name]&&(void 0!==(a=this.parent.engineModule.fieldList[e[i].name].aggregateType)||"string"!==this.parent.engineModule.fieldList[e[i].name].type&&"include"!==this.parent.engineModule.fieldList[e[i].name].type&&"exclude"!==this.parent.engineModule.fieldList[e[i].name].type?void 0===a&&(a=void 0!==this.parent.engineModule.fieldList[e[i].name].aggregateType?this.parent.engineModule.fieldList[e[i].name].aggregateType:"Sum"):a="Count");var l=e[i].caption?e[i].caption:e[i].name;return t.createElement("span",{attrs:{title:"filters"===r?l+" ("+o+")":this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===r&&"CalculatedField"!==a?this.parent.localeObj.getConstant(a)+" of "+l:l,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":n===i?"":a},className:"e-content "+("pivotview"!==this.parent.getModuleName()||this.parent.groupingBarSettings.allowDragAndDrop?"":"e-disable-drag"),innerHTML:"filters"===r?l+" ("+o+")":this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===r&&"CalculatedField"!==a?this.parent.localeObj.getConstant(a)+" of "+l:l})},e.prototype.getTypeStatus=function(e,t,i){var r=this.parent.engineModule.fieldList[e[t].name];"CalculatedField"!==r.aggregateType&&"number"===r.type&&this.createSummaryType(i,e[t].name)},e.prototype.createSummaryType=function(e,i){var r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:C+" e-dropdown-icon"});return"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showValueTypeIcon?t.removeClass([r],"e-disable"):t.addClass([r],"e-disable")),e.appendChild(r),r},e.prototype.createMenuOption=function(e){this.menuOption.render(e,this.parentElement),this.parent.pivotButtonModule=this},e.prototype.createDraggable=function(e){this.draggable=new t.Draggable(e,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"!==this.parent.getModuleName()||this.parent.groupingBarSettings.allowDragAndDrop?"":".e-pivot-button"})},e.prototype.createButtonDragIcon=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:C+" e-drag"});return i.appendChild(r),e.appendChild(i),i},e.prototype.createSortOption=function(e,i){var r,n;if(this.parent.allowDeferLayoutUpdate){r="";for(var a=0;a<this.parent.dataSourceSettings.sortSettings.length;a++)this.parent.dataSourceSettings.sortSettings[a].name===i&&(r="Descending"===this.parent.dataSourceSettings.sortSettings[a].order?"e-descend":"")}else r="Descending"===this.parent.engineModule.fieldList[i].sort?"e-descend":"";return n="None"===this.parent.engineModule.fieldList[i].sort?t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:C}):t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:C+" e-sort "+r}),this.parent.dataSourceSettings.enableSorting?t.removeClass([n],"e-disable"):t.addClass([n],"e-disable"),"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showSortIcon?t.removeClass([n],"e-disable"):t.addClass([n],"e-disable")),e.appendChild(n),n},e.prototype.createFilterOption=function(e,i){var r;if(this.parent.allowDeferLayoutUpdate){r="e-pv-filter";for(var n=0;n<this.parent.dataSourceSettings.filterSettings.length;n++)this.parent.dataSourceSettings.filterSettings[n].name===i&&(r="e-pv-filtered")}else r=0===this.parent.engineModule.fieldList[i].filter.length?this.parent.engineModule.fieldList[i].isExcelFilter?"e-pv-filtered":"e-pv-filter":"e-pv-filtered";var a=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-btn-filter e-icons "+r});return"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showFilterIcon?t.removeClass([a],"e-disable"):t.addClass([a],"e-disable")),e.appendChild(a),a},e.prototype.createDragClone=function(e){var i=t.closest(e.element,".e-pivot-button"),r=t.createElement("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"}),n=t.createElement("span",{className:"e-text-content",innerHTML:i.textContent});return r.appendChild(n),document.body.appendChild(r),r},e.prototype.onDragStart=function(e){this.parent.isDragging=!0;var i=t.closest(e.element,".e-pivot-button"),r=this.parent.engineModule.fieldList[i.getAttribute("data-uid")],n=["e-rows","e-columns","e-filters"];if(t.addClass([i],"e-list-selected"),r&&"CalculatedField"===r.aggregateType)for(var a=0,o=n;a<o.length;a++){var l=o[a];t.addClass([this.parentElement.querySelector("."+l)],"e-drag-restrict")}},e.prototype.onDragging=function(e){this.draggable.setProperties({cursorAt:{top:!t.isNullOrUndefined(e.event.targetTouches)||t.Browser.isDevice?60:-20}})},e.prototype.onDragStop=function(e){this.parent.isDragging=!1,e.target.classList&&(e.target.classList.contains("e-group-chart-values")||e.target.classList.contains("e-group-chart-values-drodown"))&&(e.target=this.parent.element.querySelector(".e-group-chart-rows"));var i=t.closest(e.element,".e-pivot-button");t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-pivot-button")),"e-list-selected"),t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover");for(var r=0,n=["e-rows","e-columns","e-filters"];r<n.length;r++){var a=n[r];t.removeClass([this.parentElement.querySelector("."+a)],"e-drag-restrict")}this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&t.remove(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(e.target,i)&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,i.id)&&(this.updateDataSource(),this.parent.axisFieldModule.render()))},e.prototype.isButtonDropped=function(e,i){var r=t.closest(i,".e-droppable"),n=!0;if(r===t.closest(e,".e-droppable")){for(var a=[].slice.call(r.querySelectorAll(".e-pivot-button")),o=t.closest(e,".e-pvt-btn-div"),l=void 0,s=-1,d=0,p=a.length;d<p;d++)if(a[d].id===i.id&&(l=d),o){var h=o.querySelector(".e-pivot-button");a[d].id===h.id&&(s=d)}(l===s||l===a.length-1&&-1===s)&&(t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),n=!1)}return n},e.prototype.updateSorting=function(e){e.target.classList.contains("e-btn-filter")||e.target.classList.contains("e-remove")||(this.parent instanceof Ie||this.parent.groupingBarSettings.showSortIcon)&&(("pivotview"===this.parent.getModuleName()&&this.parent.enableValueSorting||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableValueSorting)&&(this.parent.enableValueSorting||this.parent.pivotGridModule.enableValueSorting)&&(e.target.classList.contains("e-pivot-button")?"rows"===e.target.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0):"rows"===e.target.parentElement.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0)),this.parent.pivotCommon.eventBase.updateSorting(e),this.parent.allowDeferLayoutUpdate||this.updateDataSource(!0),this.parent instanceof Ie&&this.axisField.render())},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(m,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateFiltering=function(e){this.parent.pivotCommon.eventBase.updateFiltering(e);var t=e.target;this.fieldName=t.parentElement.id,this.dialogPopUp=this.parent.pivotCommon.filterDialog.dialogPopUp,this.memberTreeView=this.parent.pivotCommon.filterDialog.memberTreeView,this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=this.nodeStateModified.bind(this),this.parent.pivotCommon.filterDialog.allMemberSelect.nodeChecked=this.nodeStateModified.bind(this),this.bindDialogEvents()},e.prototype.bindDialogEvents=function(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):(this.index=0,this.updateDialogButtonEvents())},e.prototype.buttonModel=function(){return[{buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}]},e.prototype.tabSelect=function(e){this.index=e.selectedIndex,this.updateDialogButtonEvents(),t.removeClass([].slice.call(this.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),e.selectedIndex>0&&t.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===e.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab"),0===e.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.dialogPopUp.element.querySelector(".e-ok-btn").removeAttribute("disabled"))},e.prototype.updateDialogButtonEvents=function(){this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind()},e.prototype.updateCustomFilter=function(e){var i=this.dialogPopUp.element.querySelector(".e-selected-tab"),r=i.getAttribute("data-fieldname"),n=i.getAttribute("data-type"),a=i.getAttribute("data-measure"),o=i.getAttribute("data-operator"),l=i.getAttribute("data-value1"),s=i.getAttribute("data-value2"),d="value"===n?"Value":"date"===n?"Date":"number"===n?"Number":"Label",p={name:r,type:d,measure:a,condition:o,value1:"date"===n?new Date(l):l,value2:"date"===n?new Date(s):s};if(t.isNullOrUndefined(l)||""===l||["Between","NotBetween"].indexOf(o)>-1&&(t.isNullOrUndefined(s)||""===s)){var h=d.toLowerCase()+(t.isNullOrUndefined(l)||""===l?"_input_option_1":"_input_option_2"),c=i.querySelector("#"+this.parent.element.id+"_"+h);return t.addClass([c],"e-empty-field"),void c.focus()}var u=this.parent.pivotCommon.eventBase.getFilterItemByName(r);u?((u=u.properties?u.properties:u).type=d,u.measure=a,u.condition=o,u.value1="date"===n?new Date(l):l,u.value2="date"===n?new Date(s):s):this.parent.dataSourceSettings.filterSettings.push(p),"Value"!==d&&(this.parent.lastFilterInfo=this.parent.pivotCommon.eventBase.getFilterItemByName(r)),this.dialogPopUp.close(),this.refreshPivotButtonState(r,!0),this.updateDataSource(!0)},e.prototype.ClearFilter=function(e){var t=this.dialogPopUp.element.getAttribute("data-fieldname");this.dialogPopUp.close(),this.removeDataSourceSettings(t),this.refreshPivotButtonState(t,!1),this.updateDataSource(!0)},e.prototype.removeButton=function(e){var t=e.target,i=t.parentElement.id;"true"===t.parentElement.getAttribute("isvalue")?this.parent.setProperties({dataSourceSettings:{values:[]}},!0):this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.axisFieldModule.render(),this.updateDataSource()},e.prototype.nodeStateModified=function(e){if("all"===e.node.parentElement.parentElement.getAttribute("data-uid"))this.memberTreeView.nodeChecked=null,"check"===e.action?this.memberTreeView.checkAll():this.memberTreeView.uncheckAll(),this.checkedStateAll(e.action),this.memberTreeView.nodeChecked=this.nodeStateModified.bind(this);else{var t=this.parent.pivotCommon.currentTreeItemsPos[e.data[0].id];"check"===e.action?this.parent.pivotCommon.currentTreeItems[t].checkedStatus=!0:this.parent.pivotCommon.currentTreeItems[t].checkedStatus=!1}this.parent.pivotCommon.filterDialog.updateCheckedState()},e.prototype.checkedStateAll=function(e){for(var t={},i=0,r=this.parent.pivotCommon.searchTreeItems;i<r.length;i++)(o=r[i]).checkedStatus="check"===e,t[o.id]=o.id;for(var n=0,a=this.parent.pivotCommon.currentTreeItems;n<a.length;n++){var o=a[n];void 0!==t[o.id]&&(o.checkedStatus="check"===e)}},e.prototype.updateFilterState=function(e,t){for(var i=!1,r={items:[],name:e,type:"Include"},n=0,a=this.parent.pivotCommon.searchTreeItems;n<a.length;n++){var o=a[n];o.checkedStatus&&(this.parent.pivotCommon.isDateField?r.items.push(o.name):r.items.push(o.id))}if(i=r.items.length!==this.parent.pivotCommon.currentTreeItems.length,this.parent.pivotCommon.eventBase.getFilterItemByName(e)){for(var l=0;l<this.parent.dataSourceSettings.filterSettings.length;l++)if(this.parent.dataSourceSettings.filterSettings[l].name===e){this.parent.dataSourceSettings.filterSettings.splice(l,1);break}this.parent.dataSourceSettings.filterSettings.push(r)}else this.parent.dataSourceSettings.filterSettings.push(r);this.dialogPopUp.close(),this.refreshPivotButtonState(e,i),i||this.removeDataSourceSettings(e),this.parent.lastFilterInfo=r,this.updateDataSource(!0),this.parent instanceof Ie&&this.axisField.render()},e.prototype.refreshPivotButtonState=function(e,i){for(var r,n=0,a=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));n<a.length;n++){var o=a[n];if(o.getAttribute("data-uid")===e){r=o.querySelector(".e-btn-filter");break}}i?(t.removeClass([r],"e-pv-filter"),t.addClass([r],"e-pv-filtered")):(t.removeClass([r],"e-pv-filtered"),t.addClass([r],"e-pv-filter"))},e.prototype.removeDataSourceSettings=function(e){for(var t=this.parent.dataSourceSettings.filterSettings,i=0,r=t.length;i<r;i++)if(t[i].name===e){t.splice(i,1);break}},e.prototype.updateDropIndicator=function(e){if(this.parent.isDragging){t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"),t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover");var i=t.closest(e.target,".e-pvt-btn-div");t.addClass([i.querySelector(".e-drop-indicator")],"e-drop-hover")}},e.prototype.wireEvent=function(e,i){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),-1===["filters","values"].indexOf(i)&&t.EventHandler.add(e.querySelector(".e-pivot-button"),"click",this.updateSorting,this),"values"!==i&&t.EventHandler.add(e.querySelector(".e-btn-filter"),"click",this.updateFiltering,this),"values"===i&&null!==e.querySelector(".e-dropdown-icon")&&t.EventHandler.add(e.querySelector(".e-dropdown-icon"),"click",this.createMenuOption,this),t.EventHandler.add(e.querySelector(".e-remove"),"click",this.removeButton,this)},e.prototype.unWireEvent=function(e,i){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),-1===["filters","values"].indexOf(i)&&t.EventHandler.remove(e.querySelector(".e-pivot-button"),"click",this.updateSorting),"values"!==i&&t.EventHandler.remove(e.querySelector(".e-btn-filter"),"click",this.updateFiltering),"values"===i&&null!==e.querySelector(".e-dropdown-icon")&&t.EventHandler.remove(e.querySelector(".e-dropdown-icon"),"click",this.createMenuOption),t.EventHandler.remove(e.querySelector(".e-remove"),"click",this.removeButton)},e.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on("pivot-button-update",this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("pivot-button-update",this.handlers.load)},e.prototype.destroy=function(){this.menuOption.destroy(),this.removeEventListener()},e.prototype.updateButtontext=function(e){var t,i=this.parent.engineModule.fieldList[e].filter.length,r=this.parent.engineModule.fieldList[e].filterType,n=this.parent.engineModule.fieldList[e].dateMember.length,a=this.parent.engineModule.fieldList[e].filter[0];if("include"===r)1===i?t=a:i>1&&(t=i===n?this.parent.localeObj.getConstant("all"):this.parent.localeObj.getConstant("multipleItems"));else if("exclude"===r){if(1===i)t=2===n?a!==this.parent.engineModule.fieldList[e].dateMember[0].actualText?a:this.parent.engineModule.fieldList[e].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(i>1){var o=void 0,l=Object.keys(this.parent.engineModule.fieldList[e].members),s=this.parent.engineModule.fieldList[e].filter;if(i===l.length-1)e:for(o=0;o<l.length;o++){var d=l[o];if(-1===s.indexOf(d)){t=l[o];break e}}else t=this.parent.localeObj.getConstant("multipleItems")}}else t=this.parent.localeObj.getConstant("all");return t},e}(),ke=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new Fe(this.parent),this.createPivotButtons()},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=this.parent.dialogRenderer.parentElement;t.querySelector(".e-field-list-filters")&&(t.querySelector(".e-field-list-filters").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-rows")&&(t.querySelector(".e-field-list-rows").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-columns")&&(t.querySelector(".e-field-list-columns").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-values")&&(t.querySelector(".e-field-list-values").querySelector(".e-axis-content").innerHTML="");for(var i=["rows","columns","values","filters"],r=0,n=e.length;r<n;r++)if(e[r]){var a={field:e[r],axis:i[r].toString()};this.parent.notify("pivot-button-update",a)}},e}(),Ae=function(){function e(e){this.parent=e,this.parent.dialogRenderer=new Pe(this.parent),this.parent.treeViewModule=new Le(this.parent),this.parent.axisTableModule=new Ee(this.parent),this.parent.axisFieldModule=new ke(this.parent)}return e.prototype.render=function(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()},e}(),Ne=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),je=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Ie=function(e){function n(t,i){var r=e.call(this,t,i)||this;return r.isRequiredUpdate=!0,r.lastSortInfo={},r.lastFilterInfo={},r.lastAggregationInfo={},r.lastCalcFieldInfo={},r.engineModule=new g,r}return Ne(n,e),n.prototype.requiredModules=function(){var e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedfield"}),e},n.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice,this.globalize=new t.Internationalization(this.locale),this.renderModule=new Ae(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"APPLY",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption :",summarizeValuesBy:"Summarize values by :",baseField:"Base field :",baseItem:"Base item :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.captionData=[],this.wireEvent()},n.prototype.frameCustomProperties=function(){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var e=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,t=!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing);return{mode:"",savedFieldList:void 0,pageSettings:e,enableValueSorting:this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,isDrillThrough:t,localeObj:this.localeObj}},n.prototype.render=function(){var e=this;this.trigger("load",{dataSourceSettings:this.dataSourceSettings},function(i){e.dataSourceSettings=i.dataSourceSettings,t.addClass([e.element],y),e.enableRtl?t.addClass([e.element],S):t.removeClass([e.element],S),e.isAdaptive?t.addClass([e.element],b):t.removeClass([e.element],b),e.cssClass&&t.addClass([e.element],e.cssClass),e.notify("initial-load",{})}),t.isBlazor()&&this.renderComplete()},n.prototype.wireEvent=function(){this.on("initial-load",this.generateData,this),this.on(f,this.fieldListRender,this)},n.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off("initial-load",this.generateData),this.off(f,this.fieldListRender))},n.prototype.getPersistData=function(){var e=["dataSourceSettings"];return this.addOnPersist(e)},n.prototype.getModuleName=function(){return"pivotfieldlist"},n.prototype.onPropertyChanged=function(e,i){for(var r=!1,n=0,a=Object.keys(e);n<a.length;n++){switch(a[n]){case"locale":this.refresh();break;case"enableRtl":this.enableRtl?t.addClass([this.element],S):t.removeClass([this.element],S),r=!0}r&&this.fieldListRender()}},n.prototype.initEngine=function(){var e=this;this.trigger("enginePopulating",{dataSourceSettings:this.dataSourceSettings},function(i){if(e.dataSourceSettings=i.dataSourceSettings,e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var r=e.engineModule.data;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:u.getClonedData(r),e.setProperties({dataSourceSettings:{dataSource:[]}},!0),e.clonedReport=e.clonedReport?e.clonedReport:t.extend({},e.dataSourceSettings,null,!0),e.setProperties({dataSourceSettings:{dataSource:r}},!0)}e.engineModule.renderEngine(e.dataSourceSettings,e.frameCustomProperties(),e.getValueCellInfo.bind(e)),e.pivotFieldList=e.engineModule.fieldList;var n={pivotFieldList:e.pivotFieldList,pivotValues:e.engineModule.pivotValues},a=e;e.trigger("enginePopulated",n,function(e){a.pivotFieldList=e.pivotFieldList,a.engineModule.pivotValues=e.pivotValues,a.notify(f,{}),a.trigger("dataBound")})})},n.prototype.generateData=function(){this.pivotFieldList={},this.dataSourceSettings&&this.dataSourceSettings.dataSource?this.dataSourceSettings.dataSource.length>0?(this.engineModule.data=this.dataSourceSettings.dataSource,this.initEngine()):this.dataSourceSettings.dataSource instanceof i.DataManager&&setTimeout(this.getData.bind(this),100):(this.notify(f,{}),this.trigger("dataBound"))},n.prototype.getValueCellInfo=function(e){var t=e;return this.trigger("aggregateCellInfo",t),t},n.prototype.getData=function(){this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},n.prototype.executeQuery=function(e){this.engineModule.data=e.result,this.initEngine()},n.prototype.fieldListRender=function(){this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(this.dialogRenderer.fieldListDialog.destroy(),t.remove(document.getElementById(this.element.id+"_Wrapper"))),this.renderModule.render(),this.fieldListSpinnerElement="Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:this.element.querySelector(".e-pivotfieldlist-wrapper"),r.createSpinner({target:this.fieldListSpinnerElement},this.createElement);var e={pivotEngine:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:document.getElementById(this.element.id+"_Wrapper"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj};this.pivotCommon=new Oe(e),this.pivotCommon.control=this,this.allowDeferLayoutUpdate&&(this.clonedDataSource=t.extend({},this.dataSourceSettings,null,!0),this.clonedFieldList=t.extend({},this.pivotFieldList,null,!0))},n.prototype.getFieldCaption=function(e){if(this.getFields(e),this.captionData.length>0)for(var t=this.captionData.length;t--;)if(this.captionData[t])for(var i=0,r=this.captionData[t];i<r.length;i++){var n=r[i];n&&(this.engineModule.fieldList[n.name]&&n.caption?this.engineModule.fieldList[n.name].caption=n.caption:this.engineModule.fieldList[n.name].caption=n.name)}},n.prototype.getFields=function(e){this.captionData=[e.rows,e.columns,e.values,e.filters]},n.prototype.updateDataSource=function(e,i){var n=this;if(this.pivotGridModule&&r.showSpinner(this.pivotGridModule.element),r.showSpinner(this.fieldListSpinnerElement),t.isNullOrUndefined(i)){var a=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,o=this.frameCustomProperties();o.savedFieldList=this.pivotFieldList;var l=this.pivotGridModule?this.pivotGridModule.lastSortInfo:this.lastSortInfo;this.pivotGridModule&&(this.pivotGridModule.lastSortInfo={}),this.lastSortInfo={};var s=Object.keys(this.lastAggregationInfo).length>0,d=Object.keys(this.lastCalcFieldInfo).length>0,p=Object.keys(l).length>0,h=Object.keys(this.lastFilterInfo).length>0;a&&(p||h||s||d)?(p&&(this.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),this.engineModule.onSort(l)),h&&(this.engineModule.onFilter(this.lastFilterInfo,this.dataSourceSettings),this.lastFilterInfo={}),s&&(this.engineModule.onAggregation(this.lastAggregationInfo),this.lastAggregationInfo={}),d&&(this.engineModule.onCalcOperation(this.lastCalcFieldInfo),this.lastCalcFieldInfo={})):this.engineModule.renderEngine(this.dataSourceSettings,o,this.getValueCellInfo.bind(this)),this.getFieldCaption(this.dataSourceSettings)}else this.axisFieldModule.render(),this.isRequiredUpdate=!1;var c={dataSourceSettings:this.dataSourceSettings,pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues};this.trigger("enginePopulated",c,function(i){n.dataSourceSettings=i.dataSourceSettings,n.pivotFieldList=i.pivotFieldList,n.engineModule.pivotValues=i.pivotValues,n.pivotCommon.engineModule=n.engineModule,n.pivotCommon.dataSourceSettings=n.dataSourceSettings,n.pivotFieldList=n.engineModule.fieldList,e||!n.treeViewModule.fieldTable||n.isAdaptive||n.notify("tree-view-update",{}),n.isRequiredUpdate?(n.allowDeferLayoutUpdate&&(n.clonedDataSource=t.extend({},n.dataSourceSettings,null,!0),n.clonedFieldList=t.extend({},n.pivotFieldList,null,!0)),n.updateView(n.pivotGridModule)):"Popup"===n.renderMode&&n.allowDeferLayoutUpdate&&(n.pivotGridModule.engineModule=n.engineModule,n.pivotGridModule.setProperties({dataSourceSettings:n.dataSourceSettings.properties},!0),n.pivotGridModule.notify(m,n),r.hideSpinner(n.fieldListSpinnerElement)),n.isRequiredUpdate=!0,n.pivotGridModule?n.pivotGridModule.fieldListSpinnerElement=n.fieldListSpinnerElement:r.hideSpinner(n.fieldListSpinnerElement)})},n.prototype.update=function(e){e&&(this.clonedDataSet=e.clonedDataSet,this.setProperties({dataSourceSettings:e.dataSourceSettings},!0),this.engineModule=e.engineModule,this.pivotFieldList=e.engineModule.fieldList,"Popup"===this.renderMode&&(this.pivotGridModule=e),this.getFieldCaption(e.dataSourceSettings),this.pivotCommon.engineModule=this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=e,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify("tree-view-update",{}),this.axisFieldModule.render(),"Fixed"===this.renderMode&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=t.extend({},this.dataSourceSettings,null,!0),this.clonedFieldList=t.extend({},this.pivotFieldList,null,!0)))},n.prototype.updateView=function(e){if(e){e.clonedDataSet=this.clonedDataSet,e.setProperties({dataSourceSettings:this.dataSourceSettings},!0),e.engineModule=this.engineModule,e.pivotValues=this.engineModule.pivotValues;var t={dataSourceSettings:this.dataSourceSettings,pivotValues:this.engineModule.pivotValues};e.trigger("fieldListRefreshed",t),e.dataBind()}},n.prototype.triggerPopulateEvent=function(){var e=this,t={dataSourceSettings:this.dataSourceSettings,pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues};this.trigger("enginePopulated",t,function(t){e.dataSourceSettings=t.dataSourceSettings,e.pivotFieldList=t.pivotFieldList,e.engineModule.pivotValues=t.pivotValues})},n.prototype.destroy=function(){this.unWireEvent(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),this.allowDeferLayoutUpdate&&this.dialogRenderer&&this.dialogRenderer.deferUpdateCheckBox&&!this.dialogRenderer.deferUpdateCheckBox.isDestroyed&&this.dialogRenderer.deferUpdateCheckBox.destroy(),e.prototype.destroy.call(this),this.element.innerHTML="",t.removeClass([this.element],y),t.removeClass([this.element],S),t.removeClass([this.element],b),"Popup"===this.renderMode&&(this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&this.dialogRenderer.fieldListDialog.destroy(),document.getElementById(this.element.id+"_Wrapper")&&t.remove(document.getElementById(this.element.id+"_Wrapper")))},je([t.Complex({},Y)],n.prototype,"dataSourceSettings",void 0),je([t.Property("Popup")],n.prototype,"renderMode",void 0),je([t.Property()],n.prototype,"target",void 0),je([t.Property("")],n.prototype,"cssClass",void 0),je([t.Property(!1)],n.prototype,"allowCalculatedField",void 0),je([t.Property(!1)],n.prototype,"showValuesButton",void 0),je([t.Property(!1)],n.prototype,"allowDeferLayoutUpdate",void 0),je([t.Property(1e3)],n.prototype,"maxNodeLimitInMemberEditor",void 0),je([t.Event()],n.prototype,"load",void 0),je([t.Event()],n.prototype,"enginePopulating",void 0),je([t.Event()],n.prototype,"enginePopulated",void 0),je([t.Event()],n.prototype,"onFieldDropped",void 0),je([t.Event()],n.prototype,"aggregateCellInfo",void 0),je([t.Event()],n.prototype,"dataBound",void 0),je([t.Event()],n.prototype,"created",void 0),je([t.Event()],n.prototype,"destroyed",void 0),n=je([t.NotifyPropertyChanges],n)}(t.Component),Re="PopulationVar",qe="CalculatedField",Ve=function(){function e(e){this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.dialog=null,this.inputObj=null,this.treeObj=null,this.droppable=null,this.menuObj=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.isEdit=!1,this.currentFieldName=null,this.confirmPopUp=null}return e.prototype.getModuleName=function(){return"calculatedfield"},e.prototype.keyActionHandler=function(e){var t=e.currentTarget.querySelector(".e-hover.e-node-focus");if(t)switch(e.action){case"moveRight":this.displayMenu(t.previousSibling);break;case"enter":var i=t.getAttribute("data-field"),r=t.getAttribute("data-type"),n=this.dialog.element.querySelector("#"+this.parentID+"droppable");""===n.value?n.value=r===qe?t.getAttribute("data-uid"):'"'+r+"("+i+')"':""!==n.value&&(n.value=r===qe?n.value+t.getAttribute("data-uid"):n.value+'"'+r+"("+i+')"')}},e.prototype.fieldClickHandler=function(e){var t=e.event.target.parentElement;(e.event.target.classList.contains(P)||e.event.target.classList.contains("e-edit")||e.event.target.classList.contains("e-edited"))&&this.displayMenu(t.parentElement)},e.prototype.displayMenu=function(e){null===document.querySelector("."+this.parentID+"calculatedmenu")||!e.querySelector(".e-list-icon").classList.contains(C)||e.querySelector(".e-list-icon").classList.contains("e-edited")||e.querySelector(".e-list-icon").classList.contains("e-edit")||"LI"!==e.tagName?e.querySelector(".e-list-icon").classList.contains("e-edit")&&"LI"===e.tagName?(t.addClass([e.querySelector(".e-list-icon")],"e-edited"),t.removeClass([e.querySelector(".e-list-icon")],"e-edit"),e.querySelector(".e-edited").setAttribute("title",this.parent.localeObj.getConstant("clear")),this.isEdit=!0,this.currentFieldName=e.getAttribute("data-field"),this.inputObj.value=e.getAttribute("data-caption"),this.dialog.element.querySelector("."+M).value=e.getAttribute("data-caption"),document.querySelector("#"+this.parentID+"droppable").value=e.getAttribute("data-uid")):e.querySelector(".e-list-icon").classList.contains("e-edited")&&"LI"===e.tagName&&(t.addClass([e.querySelector(".e-list-icon")],"e-edit"),t.removeClass([e.querySelector(".e-list-icon")],"e-edited"),e.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit")),this.isEdit=!1,this.inputObj.value="",this.dialog.element.querySelector("."+M).value="",document.querySelector("#"+this.parentID+"droppable").value=""):(this.menuObj.close(),this.curMenu=e.querySelector(".e-list-text"),this.openContextMenu())},e.prototype.openContextMenu=function(){var e=this.curMenu.getBoundingClientRect();this.parent.enableRtl?this.menuObj.open(e.top+30,e.left-100):this.menuObj.open(e.top+30,e.left+150)},e.prototype.selectContextMenu=function(e){if(null!==e.element.textContent){var i=t.closest(this.curMenu,".e-list-item").getAttribute("data-caption");t.closest(this.curMenu,".e-list-item").setAttribute("data-type",e.element.id),this.curMenu.textContent=i+" ("+e.element.id.split(this.parent.element.id+"_")[1]+")",t.addClass([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","-1"),this.curMenu.parentElement.parentElement.focus()}},e.prototype.createMenu=function(){var e=[{id:this.parent.element.id+"_Sum",text:this.parent.localeObj.getConstant("Sum")},{id:this.parent.element.id+"_Count",text:this.parent.localeObj.getConstant("Count")},{id:this.parent.element.id+"_DistinctCount",text:this.parent.localeObj.getConstant("DistinctCount")},{id:this.parent.element.id+"_Avg",text:this.parent.localeObj.getConstant("Avg")},{id:this.parent.element.id+"_Min",text:this.parent.localeObj.getConstant("Min")},{id:this.parent.element.id+"_Max",text:this.parent.localeObj.getConstant("Max")},{id:this.parent.element.id+"_Product",text:this.parent.localeObj.getConstant("Product")},{id:this.parent.element.id+"_SampleStDev",text:this.parent.localeObj.getConstant("SampleStDev")},{id:this.parent.element.id+"_SampleVar",text:this.parent.localeObj.getConstant("SampleVar")},{id:this.parent.element.id+"_PopulationStDev",text:this.parent.localeObj.getConstant("PopulationStDev")},{id:this.parent.element.id+"_PopulationVar",text:this.parent.localeObj.getConstant("PopulationVar")}],i={cssClass:this.parentID+"calculatedmenu",items:e,enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this),select:this.selectContextMenu.bind(this)},r=t.createElement("ul",{id:this.parentID+"contextmenu"});this.parent.element.appendChild(r),this.menuObj=new a.ContextMenu(i),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(r)},e.prototype.applyFormula=function(){var e=this,i=!1;if(t.removeClass([document.getElementById(this.parentID+"ddlelement")],"e-empty-field"),Object.keys(e.parent.engineModule.fieldList).forEach(function(t,r){e.inputObj.value&&e.inputObj.value===t&&"CalculatedField"!==e.parent.engineModule.fieldList[t].aggregateType&&(i=!0)}),i)return void e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("fieldExist"));this.newFields=t.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.existingReport=t.extend({},this.parent.dataSourceSettings,null,!0);var r=this.parent.dataSourceSettings,n=document.querySelector("#"+this.parentID+"droppable");if(null!==this.inputObj.value&&""!==this.inputObj.value&&""!==n.value){var a={name:this.inputObj.value,type:"CalculatedField"},o={name:this.inputObj.value,formula:n.value};if(this.isFieldExist=!0,this.isEdit){for(l=0;l<r.values.length;l++)if(r.values[l].type===qe&&null!==this.currentFieldName&&r.values[l].name===this.currentFieldName&&this.isEdit)for(s=0;s<r.calculatedFieldSettings.length;s++)r.calculatedFieldSettings[s].name===this.currentFieldName&&(r.values[l].caption=this.inputObj.value,r.calculatedFieldSettings[s].formula=n.value,this.parent.engineModule.fieldList[this.currentFieldName].caption=this.inputObj.value,this.isFieldExist=!1)}else for(var l=0;l<r.values.length;l++)if(r.values[l].type===qe&&r.values[l].name===a.name){for(var s=0;s<r.calculatedFieldSettings.length;s++)if(r.calculatedFieldSettings[s].name===a.name)return void this.createConfirmDialog(e.parent.localeObj.getConstant("alert"),e.parent.localeObj.getConstant("confirmText"));this.isFieldExist=!1}this.isFieldExist&&(r.values.push(a),r.calculatedFieldSettings.push(o)),this.parent.lastCalcFieldInfo=o,this.addFormula(r,a.name)}else null===this.inputObj.value||""===this.inputObj.value?(t.addClass([document.getElementById(this.parentID+"ddlelement")],"e-empty-field"),document.getElementById(this.parentID+"ddlelement").focus()):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula"))},e.prototype.addFormula=function(e,t){try{this.parent.setProperties({dataSourceSettings:e},!0),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.isRequiredUpdate=!1),this.parent.updateDataSource(!1),this.isEdit=!1,this.dialog?this.dialog.close():(this.inputObj.value="",this.formulaText=null,this.fieldText=null,this.parent.dialogRenderer.parentElement.querySelector("."+M).value="",this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value="")}catch(e){this.parent.engineModule.fieldList[t]&&delete this.parent.engineModule.fieldList[t],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),this.parent.setProperties({dataSourceSettings:this.existingReport},!0),this.parent.lastCalcFieldInfo={},this.parent.updateDataSource(!1)}},e.prototype.getFieldListData=function(e){var t=[];return Object.keys(e.engineModule.fieldList).forEach(function(i){var r=null;r="string"===e.engineModule.fieldList[i].type||"include"===e.engineModule.fieldList[i].type||"exclude"===e.engineModule.fieldList[i].type?"Count":void 0!==e.engineModule.fieldList[i].aggregateType?e.engineModule.fieldList[i].aggregateType:"Sum",t.push({index:e.engineModule.fieldList[i].index,name:e.engineModule.fieldList[i].caption+" ("+r+")",type:r,icon:P+" "+C,formula:e.engineModule.fieldList[i].formula,field:i,caption:e.engineModule.fieldList[i].caption?e.engineModule.fieldList[i].caption:i})}),t},e.prototype.beforeMenuOpen=function(e){e.element.style.zIndex=(this.dialog.zIndex+1).toString(),e.element.style.display="inline"},e.prototype.fieldDropped=function(e){e.cancel=!0;var t=e.draggedNode.getAttribute("data-field"),i=e.draggedNode.getAttribute("data-type"),r=this.dialog.element.querySelector("#"+this.parentID+"droppable");if(e.target.id===this.parentID+"droppable"&&""===r.value)r.value=i===qe?e.draggedNodeData.id.toString():'"'+i+"("+t+')"',r.focus();else if(e.target.id===this.parentID+"droppable"&&""!==r.value){var n=void 0,a=r.selectionStart,o=r.value,l=o.substring(0,a),s=o.substring(a,o.length);i===qe?(n=l+e.draggedNodeData.id.toString(),r.value=l+e.draggedNodeData.id.toString()+s):(n=l+'"'+i+"("+t+')"',r.value=l+'"'+i+"("+t+')"'+s),r.focus(),r.setSelectionRange(n.length,n.length)}else e.cancel=!0},e.prototype.createDialog=function(){null!==document.querySelector("#"+this.parentID+"calculateddialog")&&t.remove(document.querySelector("#"+this.parentID+"calculateddialog")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div"})),this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.applyFormula.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),animationSettings:{effect:"Zoom"},width:"25%",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parentID+"calculateddialog")},e.prototype.cancelClick=function(){this.dialog.close(),this.isEdit=!1},e.prototype.beforeOpen=function(e){this.dialog.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("createCalculatedField"),this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))},e.prototype.closeDialog=function(e){"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&(t.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show())),this.treeObj.destroy(),this.dialog.destroy(),this.newFields=null,t.remove(document.getElementById(this.parentID+"calculateddialog")),t.remove(document.querySelector("."+this.parentID+"calculatedmenu"))},e.prototype.renderDialogElements=function(){var e=t.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-outer-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+L)&&this.parent.isAdaptive){var i=t.createElement("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(i);var r=t.createElement("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"}),n=t.createElement("button",{id:this.parentID+"addBtn",innerHTML:this.parent.localeObj.getConstant("add"),className:"e-pivot-add-button"}),a=t.createElement("button",{id:this.parentID+"cancelBtn",innerHTML:this.parent.localeObj.getConstant("cancel"),className:"e-pivot-cancel-button"});r.appendChild(a),r.appendChild(n),e.appendChild(r)}else{var o=t.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-input-div"}),l=t.createElement("input",{id:this.parentID+"ddlelement",attrs:{type:"text",tabindex:"1"},className:M});if(o.appendChild(l),e.appendChild(o),!this.parent.isAdaptive){var s=t.createElement("div",{className:"e-pivot-all-field-title",innerHTML:this.parent.localeObj.getConstant("formulaField")});e.appendChild(s)}var d=t.createElement("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"});if(d.appendChild(t.createElement("div",{id:this.parentID+"tree",className:"e-pivot-treeview"})),e.appendChild(d),!this.parent.isAdaptive){var p=t.createElement("div",{className:"e-pivot-formula-title",innerHTML:this.parent.localeObj.getConstant("formula")});e.appendChild(p)}var h=t.createElement("textarea",{id:this.parentID+"droppable",className:L,attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):this.parent.localeObj.getConstant("dropText")}});if(e.appendChild(h),this.parent.isAdaptive){var r=t.createElement("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"}),c=t.createElement("button",{id:this.parentID+"okBtn",innerHTML:this.parent.localeObj.getConstant("apply"),className:"e-pivot-ok-button"});r.appendChild(c),e.appendChild(r)}}return e},e.prototype.renderAdaptiveLayout=function(){document.querySelector("#"+this.parentID+"droppable")&&(this.formulaText=document.querySelector("#"+this.parentID+"droppable").value,this.fieldText=this.inputObj.value),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createTreeView=function(){this.treeObj=new a.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),sortOrder:"Ascending"}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"tree")},e.prototype.nodeCollapsing=function(e){e.cancel=!0},e.prototype.dragStart=function(e){if(e.event.target.classList.contains("e-drag")){var i=document.querySelector(".e-drag-item.e-treeview");t.addClass([i],"e-pivot-calc"),i.style.zIndex=(this.dialog.zIndex+1).toString(),i.style.display="inline"}else e.cancel=!0},e.prototype.drawTreeNode=function(e){var i=e.nodeData.field;e.node.setAttribute("data-field",i),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);var r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:C+" e-drag"});t.prepend([r],e.node.querySelector(".e-text-content")),t.append([e.node.querySelector("."+P)],e.node.querySelector(".e-text-content")),"number"!==this.parent.engineModule.fieldList[i].type&&this.parent.engineModule.fieldList[i].aggregateType!==qe?t.removeClass([e.node.querySelector("."+P)],C):e.node.querySelector("."+P).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[i].aggregateType===qe&&(e.node.querySelector("."+P).setAttribute("title",this.parent.localeObj.getConstant("edit")),t.addClass([e.node.querySelector("."+P)],"e-edit"),t.removeClass([e.node.querySelector("."+P)],P))},e.prototype.createTypeContainer=function(e){for(var i=t.createElement("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"}),r=["Sum","Count","Avg","Min","Max","DistinctCount","Product","SampleStDev","PopulationStDev","SampleVar",Re],n=0;n<r.length;n++){var a=t.createElement("input",{id:this.parentID+"radio"+r[n],attrs:{type:"radio","data-ftxt":e},className:"e-pivot-calc-radio"});i.appendChild(a)}return i},e.prototype.getAccordionData=function(e){var t=this,i=[];return Object.keys(e.engineModule.fieldList).forEach(function(r,n){i.push({header:"<input id="+t.parentID+"_"+n+' class=e-pivot-calc-check type="checkbox" data-field='+r+" data-caption="+t.parent.engineModule.fieldList[r].caption+" data-type="+t.parent.engineModule.fieldList[r].type+"/>",content:e.engineModule.fieldList[r].aggregateType===qe||"number"!==t.parent.engineModule.fieldList[r].type?"":t.createTypeContainer(r).outerHTML})}),i},e.prototype.renderMobileLayout=function(e){e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind();var t=new c.Button({cssClass:O,isPrimary:!0});if(t.isStringTemplate=!0,t.appendTo("#"+this.parentID+"cancelBtn"),t.element&&(t.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+L)&&this.parent.isAdaptive){var i=new c.Button({cssClass:O+" e-outline",isPrimary:!0});i.isStringTemplate=!0,i.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),null!==this.formulaText&&null!==this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable")&&(this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value=this.formulaText),null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+M)&&(this.parent.dialogRenderer.parentElement.querySelector("."+M).value=this.fieldText,this.inputObj.value=this.fieldText),i.element&&(i.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){var r=new a.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,expanding:this.accordionExpand.bind(this)}),n=new c.Button({cssClass:O,isPrimary:!0});n.isStringTemplate=!0,n.appendTo("#"+this.parentID+"addBtn"),r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"accordDiv"),Object.keys(this.parent.engineModule.fieldList).forEach(this.updateType.bind(this)),n.element&&(n.element.onclick=this.addBtnClick.bind(this))}},e.prototype.accordionExpand=function(e){var t=this;0===e.element.querySelectorAll(".e-radio-wrapper").length&&Object.keys(this.parent.engineModule.fieldList).forEach(function(i){var r,n=["Sum","Count","Avg","Min","Max","DistinctCount","Product","SampleStDev","PopulationStDev","SampleVar",Re];if(i===e.element.querySelector("[data-field").getAttribute("data-field"))for(var a=0;a<n.length;a++)(r=new c.RadioButton({label:t.parent.localeObj.getConstant(n[a]),name:"AggregateType"+i,change:t.onChange.bind(t)})).isStringTemplate=!0,r.appendTo("#"+t.parentID+"radio"+n[a])})},e.prototype.onChange=function(e){var t=e.event.target.id.split(this.parent.element.id+"radio")[1],i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",t)},e.prototype.updateType=function(e,t){var i=null;i="string"===this.parent.engineModule.fieldList[e].type||"include"===this.parent.engineModule.fieldList[e].type||"exclude"===this.parent.engineModule.fieldList[e].type?"Count":void 0!==this.parent.engineModule.fieldList[e].aggregateType?this.parent.engineModule.fieldList[e].aggregateType:"Sum";var r=new c.CheckBox({label:this.parent.engineModule.fieldList[e].caption+" ("+i+")"});r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"_"+t),document.querySelector("#"+this.parentID+"_"+t).setAttribute("data-field",e),document.querySelector("#"+this.parentID+"_"+t).setAttribute("data-type",i)},e.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.addBtnClick=function(){for(var e=document.querySelectorAll(".e-accordion .e-check"),t="",i=null,r=null,n=0;n<e.length;n++)if(i=e[n].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(r=e[n].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(qe))t=t+'"'+r+"("+i+')"';else for(var a=0;a<this.parent.dataSourceSettings.calculatedFieldSettings.length;a++)if(this.parent.dataSourceSettings.calculatedFieldSettings[a].name===i){t+=this.parent.dataSourceSettings.calculatedFieldSettings[a].formula;break}this.formulaText=null!==this.formulaText?this.formulaText+t:t,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createCalculatedFieldDialog=function(){this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName()?this.renderAdaptiveLayout():this.parent.isAdaptive||(this.renderDialogLayout(),this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top)},e.prototype.renderDialogLayout=function(){this.newFields=t.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.createDialog(),this.dialog.content=this.renderDialogElements(),this.dialog.refresh(),this.inputObj=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),this.createTreeView(),this.createMenu(),this.droppable=new t.Droppable(this.dialog.element.querySelector("#"+this.parentID+"droppable")),this.keyboardEvents=new t.KeyboardEvents(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter"},eventName:"keydown"})},e.prototype.createConfirmDialog=function(e,i){var n=t.createElement("div",{id:this.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(n),this.confirmPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.replaceFormula.bind(this),buttonModel:{cssClass:"e-ok-btn e-outline",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.removeErrorDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.confirmPopUp.isStringTemplate=!0,this.confirmPopUp.appendTo(n),this.confirmPopUp.element.querySelector(".e-dlg-header").innerHTML=e},e.prototype.replaceFormula=function(){for(var e=this.parent.dataSourceSettings,t=document.querySelector("#"+this.parentID+"droppable"),i=0;i<e.values.length;i++)if(e.values[i].type===qe&&e.values[i].name===this.inputObj.value)for(var r=0;r<e.calculatedFieldSettings.length;r++)e.calculatedFieldSettings[r].name===this.inputObj.value&&(e.calculatedFieldSettings[r].formula=t.value,this.parent.lastCalcFieldInfo=e.calculatedFieldSettings[r]);this.addFormula(e,this.inputObj.value),this.removeErrorDialog()},e.prototype.removeErrorDialog=function(){document.getElementById(this.parentID+"_ErrorDialog")&&t.remove(document.getElementById(this.parentID+"_ErrorDialog").parentElement)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-calculatedfield",this.createCalculatedFieldDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-calculatedfield",this.createCalculatedFieldDialog)},e.prototype.destroy=function(){this.removeEventListener()},e}();Ie.Inject(Ve);var He=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"fieldlist"},e.prototype.initiateModule=function(){this.element=t.createElement("div",{id:this.parent.element.id+"_PivotFieldList",styles:"position:"+(this.parent.enableRtl?"static":"absolute")+";height:0;width:"+this.parent.element.style.width+";display:none"}),this.parent.element.parentElement.setAttribute("id","ContainerWrapper"),this.parent.element.parentElement.appendChild(this.element),this.parent.element.parentElement.appendChild(this.parent.element),this.parent.pivotFieldListModule=new Ie({dataSourceSettings:{rows:[],columns:[],values:[],filters:[]},allowDeferLayoutUpdate:this.parent.allowDeferLayoutUpdate,renderMode:"Popup",allowCalculatedField:this.parent.allowCalculatedField,enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:this.parent.element.parentElement,aggregateCellInfo:this.parent.bindTriggerEvents.bind(this.parent)}),this.parent.pivotFieldListModule.appendTo("#"+this.element.id)},e.prototype.updateControl=function(){this.element&&(this.element.style.display="block",t.prepend([this.element],this.parent.element),this.parent.showGroupingBar&&this.parent.groupingBarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.update.bind(this))):(t.setStyleAttribute(this.element.querySelector(".e-toggle-field-list"),{left:"auto"}),this.parent.enableRtl?t.removeClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"):t.addClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left")),t.setStyleAttribute(this.element,{width:t.formatUnit(this.parent.element.offsetWidth)})),this.parent.pivotFieldListModule.update(this.parent)},e.prototype.update=function(){var e;if(e="Table"!==this.parent.currentView?this.parent.chart?this.parent.chartModule.calculatedWidth:e:this.parent.grid?this.parent.grid.element.offsetWidth:e){var i=e<400?400:e;t.setStyleAttribute(this.element.querySelector(".e-toggle-field-list"),{left:t.formatUnit(this.parent.enableRtl?-Math.abs(i-this.element.querySelector(".e-toggle-field-list").offsetWidth):i-this.element.querySelector(".e-toggle-field-list").offsetWidth)}),this.parent.enableRtl?t.addClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"):t.removeClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left")}},e.prototype.addEventListener=function(){this.handlers={load:this.initiateModule,update:this.updateControl},this.parent.isDestroyed||(this.parent.on("init-groupingbar",this.handlers.load,this),this.parent.on(m,this.handlers.update,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("init-groupingbar",this.handlers.load),this.parent.off(m,this.handlers.update))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.destroy()},e}(),Be=function(){function e(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"common"},e.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule=this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=t.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj;else{var e={pivotEngine:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,isAdaptive:t.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj};this.parent.pivotCommon=new Oe(e)}this.parent.pivotCommon.control=this.parent},e.prototype.addEventListener=function(){this.handlers={load:this.initiateCommonModule},this.parent.isDestroyed||(this.parent.gridSettings.contextMenuItems&&(this.parent.showFieldList&&this.parent.showGroupingBar||this.parent.on("initial-load",this.handlers.load,this)),this.parent.on(m,this.handlers.load,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(m,this.handlers.load)},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotCommon&&this.parent.pivotCommon.destroy()},e}(),_e=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new Fe(this.parent),this.createPivotButtons();for(var e=[],i=0,r=this.parent.element.querySelectorAll(".e-group-rows");i<r.length;i++){var n=r[i];n.classList.contains("e-group-chart-rows")||(e=e.concat([].slice.call(n.querySelectorAll(".e-pvt-btn-div"))))}for(var a=e.length,o=0;o<a;o++){var l=t.createElement("span",{className:"e-indent-div",styles:"width:"+24*o+"px"});t.prepend([l],e[o])}},e.prototype.createPivotButtons=function(){for(var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=0,i=this.parent.element.querySelectorAll(".e-group-rows,.e-group-columns,.e-group-values,.e-group-filters");t<i.length;t++){var r=i[t];this.parent.dataSourceSettings.values.length>0&&r.classList.contains("e-group-chart-values")||(r.innerHTML="")}for(var n=["rows","columns","values","filters"],a=0,o=e.length;a<o;a++)if(e[a]){var l={field:e[a],axis:n[a].toString()};this.parent.notify("pivot-button-update",l)}},e}();be.Inject(Be);var Ue=function(){function e(e){this.parent=e,this.parent.groupingBarModule=this,this.resColWidth=this.parent.isAdaptive?180:249,this.addEventListener(),this.parent.axisFieldModule=new _e(this.parent),this.touchObj=new t.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return e.prototype.getModuleName=function(){return"grouping"},e.prototype.renderLayout=function(){this.groupingTable=t.createElement("div",{className:"e-grouping-bar"}),this.leftAxisPanel=t.createElement("div",{className:"e-left-axis-fields"}),this.rightAxisPanel=t.createElement("div",{className:"e-right-axis-fields"});var e=t.createElement("div",{className:"e-axis-row e-axiswrapper"}),i=t.createElement("div",{className:"e-axis-column e-axiswrapper"}),r=t.createElement("div",{className:"e-axis-value e-axiswrapper"}),n=t.createElement("div",{className:"e-axis-filter e-axiswrapper"});this.rowPanel=t.createElement("div",{className:"e-group-rows e-rows"}),this.columnPanel=t.createElement("div",{className:"e-group-columns e-columns"}),this.valuePanel=t.createElement("div",{className:"e-group-values e-values"}),this.filterPanel=t.createElement("div",{className:"e-group-filters e-filters"}),e.appendChild(this.rowPanel),i.appendChild(this.columnPanel),r.appendChild(this.valuePanel),n.appendChild(this.filterPanel),this.rowAxisPanel=e,this.columnAxisPanel=i,this.valueAxisPanel=r,this.filterAxisPanel=n,this.leftAxisPanel.appendChild(r),this.leftAxisPanel.appendChild(e),this.rightAxisPanel.appendChild(n),this.rightAxisPanel.appendChild(i),this.groupingTable.appendChild(this.leftAxisPanel),this.groupingTable.appendChild(this.rightAxisPanel),this.groupingTable.classList.add("e-pivot-grouping-bar");for(var a=0,o=[this.rowPanel,this.columnPanel,this.valuePanel,this.filterPanel];a<o.length;a++){var l=o[a];this.parent.groupingBarSettings.allowDragAndDrop&&new t.Droppable(l,{}),this.unWireEvent(l),this.wireEvent(l)}"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode?(this.groupingChartTable=this.groupingTable.cloneNode(!0),this.groupingChartTable.classList.add("e-chart-grouping-bar"),this.groupingChartTable.classList.remove("e-pivot-grouping-bar"),this.groupingChartTable.querySelector(".e-group-rows").classList.add("e-group-chart-rows"),this.groupingChartTable.querySelector(".e-group-columns").classList.add("e-group-chart-columns"),this.parent.chartSettings.enableMultiAxis?this.groupingChartTable.querySelector(".e-group-values").classList.add("e-group-chart-multi-values"):(this.groupingChartTable.querySelector(".e-group-values").classList.add("e-group-chart-values"),this.groupingChartTable.querySelector(".e-group-values").classList.remove("e-droppable")),this.groupingChartTable.querySelector(".e-group-filters").classList.add("e-group-chart-filters")):this.groupingChartTable=void 0,"Chart"!==this.parent.displayOption.view&&"Chart"!==this.parent.groupingBarSettings.displayMode||(this.groupingTable=void 0)},e.prototype.appendToElement=function(){if((this.parent.element.querySelector(".e-grid")||this.parent.element.querySelector(".e-pivotchart"))&&this.parent.showGroupingBar){if(this.parent.element.querySelector(".e-grouping-bar"))for(var e=0,i=this.parent.element.querySelectorAll(".e-grouping-bar");e<i.length;e++){c=i[e];t.remove(c)}if(this.groupingChartTable&&(this.parent.element.querySelector("#"+this.parent.element.id+"_chart")?(t.setStyleAttribute(this.groupingChartTable,{width:t.formatUnit(this.parent.chart.width)}),this.parent.element.insertBefore(this.groupingChartTable,this.parent.element.querySelector("#"+this.parent.element.id+"_chart"))):this.groupingChartTable=void 0),"Chart"!==this.parent.displayOption.view&&this.groupingTable){if(this.parent.isAdaptive&&(this.leftAxisPanel.style.minWidth="180px",this.valuePanel.style.minWidth="180px"),this.parent.firstColWidth&&(this.leftAxisPanel.style.minWidth="auto",this.valuePanel.style.minWidth="auto"),this.filterPanel.removeAttribute("style"),this.columnPanel.removeAttribute("style"),this.rowPanel.removeAttribute("style"),this.filterPanel.removeAttribute("style"),Object.keys(this.parent.engineModule.headerContent).length){var r=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([r],"e-row"),r.removeAttribute("style"),t.addClass([r.querySelector(".e-headercell")],"e-group-row"),r.querySelector(".e-group-row").appendChild(this.rowAxisPanel),r.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",r.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none"}this.parent.element.insertBefore(this.groupingTable,this.parent.element.querySelector(".e-grid")),t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.grid.width)}),this.groupingTable.style.minWidth="400px",this.parent.axisFieldModule.render(),this.setGridRowWidth();var n=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],a=t.formatUnit(this.groupingTable.offsetWidth-parseInt(n.style.width,10));t.setStyleAttribute(this.valuePanel,{width:n.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:a});var o=this.valuePanel.offsetHeight/2;o>this.columnPanel.offsetHeight&&(t.setStyleAttribute(this.filterPanel,{height:t.formatUnit(o)}),t.setStyleAttribute(this.columnPanel,{height:t.formatUnit(o+1)}));var l=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:l+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=l+"px");for(var s=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),d=l/s.length,p=0,h=s;p<h.length;p++){var c=h[p];t.setStyleAttribute(c,{height:d+"px"});for(var u=0,g=[].slice.call(c.querySelectorAll(".e-rhandler"));u<g.length;u++){var m=g[u];t.setStyleAttribute(m,{height:d+"px"})}}}else this.parent.axisFieldModule.render();this.parent.showToolbar&&"Both"===this.parent.displayOption.view&&("Table"===this.parent.currentView?this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none":this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none")}},e.prototype.refreshUI=function(){t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.grid.width)}),this.groupingTable.style.minWidth="400px";var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],i=t.formatUnit(this.groupingTable.offsetWidth-parseInt(e.style.width,10));if(t.setStyleAttribute(this.valuePanel,{width:e.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:i}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this))),!this.parent.grid.element.querySelector(".e-group-row")){var r=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([r],"e-row"),t.addClass([r.querySelector(".e-headercell")],"e-group-row"),t.setStyleAttribute(this.rowPanel,{height:this.parent.element.querySelector(".e-headercontent").offsetHeight+"px"}),r.querySelector(".e-group-row").appendChild(this.rowAxisPanel),t.setStyleAttribute(r.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"}),t.setStyleAttribute(r.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});var n=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:n+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=n+"px");for(var a=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),o=n/a.length,l=0,s=a;l<s.length;l++){var d=s[l];t.setStyleAttribute(d,{height:o+"px"});for(var p=0,h=[].slice.call(d.querySelectorAll(".e-rhandler"));p<h.length;p++){var c=h[p];t.setStyleAttribute(c,{height:o+"px"})}}}},e.prototype.alignIcon=function(){var e,i=this.parent.pivotFieldListModule.element;if(e="Table"===this.parent.currentView?this.parent.grid?this.parent.grid.element.offsetWidth:e:this.parent.chart?this.parent.chartModule.calculatedWidth:e){var r=e<400?400:e;t.setStyleAttribute(i.querySelector(".e-toggle-field-list"),{left:t.formatUnit(this.parent.enableRtl?-Math.abs(r-i.querySelector(".e-toggle-field-list").offsetWidth):r-i.querySelector(".e-toggle-field-list").offsetWidth)})}},e.prototype.setGridRowWidth=function(){var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];if(this.rowPanel.querySelector(".e-pivot-button"))if(this.parent.isAdaptive){if(!this.parent.firstColWidth){var i=this.parent.grid.columns;i&&i.length>0&&(i[0].width=this.resColWidth),this.parent.posCount=0,this.parent.grid.headerModule.refreshUI()}}else{var r=[].slice.call(this.rowPanel.querySelectorAll(".e-pvt-btn-div")),n=r[r.length-1],a=n.querySelector(".e-pivot-button").offsetWidth+n.querySelector(".e-indent-div").offsetWidth+20,o=t.formatUnit(a<this.resColWidth?this.resColWidth:a),l=this.parent.element.querySelector(".e-frozenheader").querySelector("table"),s=this.parent.element.querySelector(".e-frozencontent").querySelector("table"),d=this.parent.element.querySelector(".e-frozencontent").querySelector("colgroup").children[0],p=parseInt(o,10);(i=this.parent.grid.columns)&&i.length>0&&(i[0].width=(i[0].width,this.resColWidth,p>this.resColWidth?p:this.resColWidth));for(var h=this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.engineModule.pivotValues.length>0?this.parent.engineModule.pivotValues[0].length:2),c=0;c<i.length;c++)if(0!==c)if(i[c].columns)this.setColWidth(i[c].columns,h);else if("auto"!==i[c].width){var u=i[c].customAttributes?i[c].customAttributes.cell.valueSort.levelName:"";i[c].width=this.parent.renderModule.setSavedWidth(u,h)}else i[c].minWidth=h;this.parent.posCount=0,this.parent.setGridColumns(this.parent.grid.columns),this.parent.grid.headerModule.refreshUI(),this.parent.firstColWidth||(e.style.width=o,d.style.width=o,l.style.width=o,s.style.width=o,t.setStyleAttribute(l,{width:o}),t.setStyleAttribute(s,{width:o}))}else this.parent.grid.columns&&this.parent.grid.columns.length>0&&(this.parent.grid.columns[0].width=this.parent.grid.columns[0].width>this.resColWidth?this.parent.grid.columns[0].width:this.resColWidth),this.parent.grid.headerModule.refreshUI();this.groupingTable&&this.refreshUI()},e.prototype.setColWidth=function(e,t){for(var i=0;i<e.length;i++)e[i].columns?this.setColWidth(e[i].columns,t):e[i].width=t},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.dropIndicatorUpdate,this),t.EventHandler.add(e,"mouseleave",this.dropIndicatorUpdate,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.dropIndicatorUpdate),t.EventHandler.remove(e,"mouseleave",this.dropIndicatorUpdate)},e.prototype.dropIndicatorUpdate=function(e){(this.parent.isDragging&&e.target.classList.contains("e-droppable")&&"mouseover"===e.type||"mouseleave"===e.type)&&(t.removeClass([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),t.removeClass([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},e.prototype.tapHoldHandler=function(e){var i=t.closest(e.originalEvent.target,".e-pivot-button");if(!t.isNullOrUndefined(i)&&this.parent.isAdaptive){var r=i.getBoundingClientRect();return this.parent.contextMenuModule.fieldElement=i,void this.parent.contextMenuModule.menuObj.open(r.top,r.left)}},e.prototype.addEventListener=function(){this.handlers={load:this.renderLayout,end:this.appendToElement},this.parent.isDestroyed||(this.parent.on("init-groupingbar",this.handlers.load,this),this.parent.on(m,this.handlers.end,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("init-groupingbar",this.handlers.end),this.parent.off(m,this.handlers.load))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotButtonModule&&(this.parent.pivotButtonModule.destroy(),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy())},e}(),Ge=function(){function e(e){this.parent=e,this.parent.conditionalFormattingModule=this,this.parentID=this.parent.element.id,this.dialog=null,this.fieldsDropDown=[],this.conditionsDropDown=[],this.fontNameDropDown=[],this.fontSizeDropDown=[],this.fontColor=[],this.backgroundColor=[],this.newFormat=[]}return e.prototype.getModuleName=function(){return"conditionalformatting"},e.prototype.createDialog=function(){null!==document.querySelector("#"+this.parentID+"conditionalformatting")&&t.remove(document.querySelector("#"+this.parentID+"conditionalformatting")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"conditionalformatting"}));var e=[{click:this.addButtonClick.bind(this),buttonModel:{cssClass:this.parent.isAdaptive?"e-small e-round e-format-condition-button":"e-format-condition-button",iconCss:C+" e-add-icon",content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:this.applyButtonClick.bind(this),buttonModel:{cssClass:"e-flat e-primary e-format-apply-button",content:this.parent.localeObj.getConstant("apply")}},{click:this.cancelButtonClick.bind(this),buttonModel:{cssClass:"e-flat e-primary e-format-cancel-button",content:this.parent.localeObj.getConstant("cancel")}}];this.parent.isAdaptive?this.dialog=new r.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,position:{X:"center",Y:"center"},allowDragging:!0,buttons:e,beforeOpen:this.beforeOpen.bind(this),cssClass:"e-pivot-formatting-dialog",header:this.parent.localeObj.getConstant("conditionalFormating"),target:document.body}):this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:e,beforeOpen:this.beforeOpen.bind(this),cssClass:"e-pivot-formatting-dialog",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormating"),target:this.parent.element}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parentID+"conditionalformatting"),this.dialog.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("conditionalFormating")},e.prototype.beforeOpen=function(e){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("conditionalFormating"))},e.prototype.addButtonClick=function(){var e={conditions:"LessThan",value1:0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}};this.refreshConditionValues(),this.newFormat.push(e),this.addFormat()},e.prototype.applyButtonClick=function(){this.refreshConditionValues()&&(this.parent.setProperties({dataSourceSettings:{conditionalFormatSettings:this.newFormat}},!0),this.parent.renderPivotGrid(),this.destroy())},e.prototype.cancelButtonClick=function(){this.destroy(),this.newFormat=[]},e.prototype.refreshConditionValues=function(){for(var e=0;e<this.newFormat.length;e++){if(""===document.querySelector("#"+this.parentID+"conditionvalue1"+e).value||""===document.querySelector("#"+this.parentID+"conditionvalue2"+e).value)return""===document.querySelector("#"+this.parentID+"conditionvalue1"+e).value?document.querySelector("#"+this.parentID+"conditionvalue1"+e).focus():document.querySelector("#"+this.parentID+"conditionvalue2"+e).focus(),!1;this.newFormat[e].value1=Number(document.querySelector("#"+this.parentID+"conditionvalue1"+e).value),this.newFormat[e].value2=Number(document.querySelector("#"+this.parentID+"conditionvalue2"+e).value)}return!0},e.prototype.addFormat=function(){for(var e=t.createElement("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),i=0;i<this.newFormat.length;i++)e.appendChild(this.createDialogElements(i));if(0===this.newFormat.length){var r=this.createDialogElements(),n=t.createElement("p",{id:this.parentID+"emptyFormat",innerHTML:this.parent.localeObj.getConstant("emptyFormat"),styles:"margin: 10px"});r.appendChild(n),e.appendChild(r)}this.dialog.setProperties({content:e},!1);for(i=0;i<this.newFormat.length;i++)this.renderDropDowns(i),this.renderColorPicker(i)},e.prototype.createDialogElements=function(e){var i=t.createElement("div",{id:this.parentID+"outerDiv"+e,className:"e-format-outer-div"});if(void 0!==e){var r=this.newFormat[e],n=t.createElement("button",{id:this.parentID+"removeButton"+e,className:"e-format-delete-button",attrs:{title:this.parent.localeObj.getConstant("delete")}});i.appendChild(n);var a=t.createElement("div",{id:this.parentID+"innerDiv",className:"e-format-inner-div"}),o=t.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"}),l=t.createElement("tr"),s=t.createElement("td"),d=t.createElement("span",{id:this.parentID+"valuelabel"+e,className:"e-format-value-label",innerHTML:this.parent.localeObj.getConstant("value")});s.appendChild(d),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var p=t.createElement("div",{id:this.parentID+"measure"+e}),h=t.createElement("input",{id:this.parentID+"measureinput"+e,attrs:{type:"text",tabindex:"1"}});p.appendChild(h),s.appendChild(p),l.appendChild(s),s=t.createElement("td");var c=t.createElement("div",{id:this.parentID+"condition"}),u=t.createElement("input",{id:this.parentID+"conditioninput"+e,attrs:{type:"text",tabindex:"1"}});c.appendChild(u),s.appendChild(c),l.appendChild(s),s=t.createElement("td");var g="Between"!==r.conditions&&"NotBetween"!==r.conditions?"display:none; width:10px":"",m=t.createElement("input",{id:this.parentID+"conditionvalue1"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(r.value1)?"0":r.value1.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive?""===g?"width: 35%":"width: 100%":""===g?"width: 45px":"width: 120px",className:F+" e-format-value1"});s.appendChild(m);var v=t.createElement("span",{id:this.parentID+"valuespan"+e,className:"e-format-value-span",innerHTML:"&",styles:g});s.appendChild(v);var f=t.createElement("input",{id:this.parentID+"conditionvalue2"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(r.value2)?"0":r.value2.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive&&""===g?"width: 35%":""===g?"width: 45px":g,className:F+" e-format-value2"});s.appendChild(f),l.appendChild(s),o.appendChild(l),this.parent.isAdaptive&&(a.appendChild(o),o=t.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"})),l=t.createElement("tr"),s=t.createElement("td");var y=t.createElement("span",{id:this.parentID+"formatlabel"+e,className:"e-format-label",innerHTML:this.parent.localeObj.getConstant("formatLabel")});s.appendChild(y),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var S=t.createElement("div",{id:this.parentID+"fontname"}),b=t.createElement("input",{id:this.parentID+"fontnameinput"+e,attrs:{type:"text",tabindex:"1"}});S.appendChild(b),s.appendChild(S),l.appendChild(s),s=t.createElement("td");var C=t.createElement("div",{id:this.parentID+"fontsize"}),w=t.createElement("input",{id:this.parentID+"fontsizeinput"+e,attrs:{type:"text",tabindex:"1"}});C.appendChild(w),s.appendChild(C),l.appendChild(s),this.parent.isAdaptive&&(o.appendChild(l),l=t.createElement("tr"),o.appendChild(l),l=t.createElement("tr")),s=t.createElement("td");var x=t.createElement("input",{id:this.parentID+"fontcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-font-color"});s.appendChild(x);var T=t.createElement("input",{id:this.parentID+"backgroundcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-back-color"});s.appendChild(T),l.appendChild(s),s=t.createElement("td");var D=t.createElement("div",{id:this.parentID+"valuepreview"+e,className:F+" e-format-value-preview",innerHTML:"123.45"});s.appendChild(D),l.appendChild(s),o.appendChild(l),a.appendChild(o),i.appendChild(a)}return i},e.prototype.renderDropDowns=function(e){var i=this.newFormat[e],r=[];r.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var n=0;n<this.parent.dataSourceSettings.values.length;n++)r.push({index:n+1,name:this.parent.dataSourceSettings.values[n].caption||this.parent.dataSourceSettings.values[n].name,field:this.parent.dataSourceSettings.values[n].name});var a=t.isNullOrUndefined(i.measure)?this.parent.localeObj.getConstant("AllValues"):i.measure;this.fieldsDropDown[e]=new l.DropDownList({dataSource:r,fields:{text:"name",value:"field"},value:a,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.measureChange.bind(this,e)}),this.fieldsDropDown[e].isStringTemplate=!0,this.fieldsDropDown[e].appendTo("#"+this.parentID+"measureinput"+e);var o=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];a=t.isNullOrUndefined(i.conditions)?"LessThan":i.conditions,this.conditionsDropDown[e]=new l.DropDownList({dataSource:o,fields:{value:"value",text:"name"},value:a,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.conditionChange.bind(this,e)}),this.conditionsDropDown[e].isStringTemplate=!0,this.conditionsDropDown[e].appendTo("#"+this.parentID+"conditioninput"+e);var s=[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}];a=t.isNullOrUndefined(i.style.fontFamily)?"Arial":i.style.fontFamily,this.fontNameDropDown[e]=new l.DropDownList({dataSource:s,fields:{text:"name"},value:a,width:this.parent.isAdaptive?"100%":"120px",popupWidth:"150px",popupHeight:"200px",change:this.fontNameChange.bind(this,e)}),this.fontNameDropDown[e].isStringTemplate=!0,this.fontNameDropDown[e].appendTo("#"+this.parentID+"fontnameinput"+e);var d=[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}];a=t.isNullOrUndefined(i.style.fontSize)?"12px":i.style.fontSize,this.fontSizeDropDown[e]=new l.DropDownList({dataSource:d,fields:{text:"name"},popupHeight:"200px",value:a,width:this.parent.isAdaptive?"100%":"120px",change:this.fontSizeChange.bind(this,e)}),this.fontSizeDropDown[e].isStringTemplate=!0,this.fontSizeDropDown[e].appendTo("#"+this.parentID+"fontsizeinput"+e)},e.prototype.conditionChange=function(e,t){this.newFormat[e].conditions=t.value,"Between"===t.value||"NotBetween"===t.value?(document.querySelector("#"+this.parentID+"valuespan"+e).style.display="inline-block",document.querySelector("#"+this.parentID+"valuespan"+e).style.width=this.parent.isAdaptive?"10%":"10px",document.querySelector("#"+this.parentID+"conditionvalue2"+e).style.display="inline-block",document.querySelector("#"+this.parentID+"conditionvalue2"+e).style.width=this.parent.isAdaptive?"35%":"45px",document.querySelector("#"+this.parentID+"conditionvalue1"+e).style.width=this.parent.isAdaptive?"35%":"45px"):(document.querySelector("#"+this.parentID+"valuespan"+e).style.display="none",document.querySelector("#"+this.parentID+"conditionvalue2"+e).style.display="none",document.querySelector("#"+this.parentID+"conditionvalue1"+e).style.width=this.parent.isAdaptive?"100%":"120px")},e.prototype.fontNameChange=function(e,t){this.newFormat[e].style.fontFamily=t.value.toString(),document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontFamily=t.value},e.prototype.fontSizeChange=function(e,t){this.newFormat[e].style.fontSize=t.value.toString(),document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontSize=t.value},e.prototype.measureChange=function(e,t){this.newFormat[e].measure=t.value.toString()===this.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()},e.prototype.renderColorPicker=function(e){var i=this.newFormat[e],r=t.isNullOrUndefined(i.style.color)?"black":i.style.color,n=this.isHex(r.substr(1))?r:this.colourNameToHex(r);document.querySelector("#"+this.parentID+"valuepreview"+e).style.color=n,this.fontColor[e]=new o.ColorPicker({cssClass:"e-format-color-picker",value:n,mode:"Palette",change:this.fontColorChange.bind(this,e)}),this.fontColor[e].isStringTemplate=!0,this.fontColor[e].appendTo("#"+this.parentID+"fontcolor"+e),t.addClass([this.fontColor[e].element.nextElementSibling.querySelector(".e-selected-color")],C),r=t.isNullOrUndefined(i.style.backgroundColor)?"white":i.style.backgroundColor,n=this.isHex(r.substr(1))?r:this.colourNameToHex(r),document.querySelector("#"+this.parentID+"valuepreview"+e).style.backgroundColor=n,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontFamily=i.style.fontFamily,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontSize=i.style.fontSize,this.backgroundColor[e]=new o.ColorPicker({cssClass:"e-format-color-picker",value:n,mode:"Palette",change:this.backColorChange.bind(this,e)}),this.backgroundColor[e].isStringTemplate=!0,this.backgroundColor[e].appendTo("#"+this.parentID+"backgroundcolor"+e),t.addClass([this.backgroundColor[e].element.nextElementSibling.querySelector(".e-selected-color")],C);var a=new c.Button({iconCss:C+" e-format-delete-icon",cssClass:O});a.isStringTemplate=!0,a.appendTo("#"+this.parentID+"removeButton"+e),a.element.onclick=this.toggleButtonClick.bind(this,e)},e.prototype.backColorChange=function(e,t){this.newFormat[e].style.backgroundColor=t.currentValue.hex,document.querySelector("#"+this.parentID+"valuepreview"+e).style.backgroundColor=t.currentValue.hex},e.prototype.fontColorChange=function(e,t){this.newFormat[e].style.color=t.currentValue.hex,document.querySelector("#"+this.parentID+"valuepreview"+e).style.color=t.currentValue.hex},e.prototype.toggleButtonClick=function(e){this.newFormat.splice(e,1),this.addFormat()},e.prototype.isHex=function(e){for(var t=parseInt(e,16);"0"===e.charAt(0);)e=e.substr(1);return t.toString(16)===e.toLowerCase()||0===t&&""===e},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.prototype.colourNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==t[e.toLowerCase()]?t[e.toLowerCase()]:"#d5d5d5"},e.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var e=0;e<this.parent.dataSourceSettings.conditionalFormatSettings.length;e++)this.newFormat.push(t.extend({},this.parent.dataSourceSettings.conditionalFormatSettings[e].properties,null,!0));this.createDialog(),this.dialog.refresh(),this.addFormat()},e.prototype.destroy=function(){if(this.dialog&&!this.dialog.isDestroyed){this.dialog.hide();for(var e=0;e<this.newFormat.length;e++)this.fontColor[e]&&!this.fontColor[e].isDestroyed&&this.fontColor[e].destroy(),this.backgroundColor[e]&&!this.backgroundColor[e].isDestroyed&&this.backgroundColor[e].destroy();this.dialog.destroy()}},e}();be.Inject(Be);var ze=function(){function e(e){this.currentReport="",this.parent=e,this.parent.toolbarModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.createToolbar=function(){this.parent.isModified=!1,this.renderDialog(),null!==document.querySelector("#"+this.parent.element.id+"pivot-toolbar")&&t.remove(document.querySelector("#"+this.parent.element.id+"pivot-toolbar"));var e=t.createElement("div",{id:this.parent.element.id+"pivot-toolbar",className:"e-pivot-toolbar"});this.parent.showFieldList&&this.parent.element.querySelector("#"+this.parent.element.id+"_PivotFieldList")?this.parent.element.insertBefore(e,this.parent.element.querySelector("#"+this.parent.element.id+"_PivotFieldList")):this.parent.showGroupingBar&&this.parent.element.querySelector("#"+this.parent.element.id+" .e-pivot-grouping-bar")?this.parent.element.insertBefore(e,this.parent.element.querySelector("#"+this.parent.element.id+" .e-pivot-grouping-bar")):this.parent.element.insertBefore(e,this.parent.element.querySelector("#"+this.parent.element.id+"_grid")),this.toolbar=new a.Toolbar({created:this.create.bind(this),enableRtl:this.parent.enableRtl,width:this.parent.width?Number(this.parent.width)-2:Number(this.parent.element.offsetWidth)-2,items:this.getItems()}),this.toolbar.isStringTemplate=!0,this.toolbar.appendTo("#"+this.parent.element.id+"pivot-toolbar")},e.prototype.fetchReports=function(){var e={reportName:[]};return this.parent.trigger("fetchReport",e),e},e.prototype.getItems=function(){for(var e=[],t=0,i=this.parent.toolbar.filter(function(e,t,i){return i.indexOf(e)===t});t<i.length;t++)switch(i[t]){case"New":e.push({prefixIcon:"e-new-report "+C,tooltipText:this.parent.localeObj.getConstant("new"),click:this.actionClick.bind(this),id:this.parent.element.id+"new"});break;case"Save":e.push({prefixIcon:"e-save-report "+C,tooltipText:this.parent.localeObj.getConstant("save"),click:this.actionClick.bind(this),id:this.parent.element.id+"save"});break;case"SaveAs":e.push({prefixIcon:"e-saveas-report "+C,tooltipText:this.parent.localeObj.getConstant("saveAs"),click:this.actionClick.bind(this),id:this.parent.element.id+"saveas"});break;case"Rename":e.push({prefixIcon:"e-rename-report "+C,tooltipText:this.parent.localeObj.getConstant("rename"),click:this.actionClick.bind(this),id:this.parent.element.id+"rename"});break;case"Remove":e.push({prefixIcon:"e-remove-report "+C,tooltipText:this.parent.localeObj.getConstant("deleteReport"),click:this.actionClick.bind(this),id:this.parent.element.id+"remove"});break;case"Load":e.push({template:"<div><input class=e-load-report id="+this.parent.element.id+"_reportlist></input></div>",click:this.actionClick.bind(this),id:this.parent.element.id+"load"});break;case"Grid":var r="Chart"===this.parent.displayOption.view;e.push({prefixIcon:"e-toolbar-grid "+C,tooltipText:this.parent.localeObj.getConstant("grid"),id:this.parent.element.id+"grid",cssClass:r?"e-disabled":"",click:this.menuItemClick.bind(this)});break;case"Chart":e.push({template:'<ul id="'+this.parent.element.id+'chart_menu"></ul>',id:this.parent.element.id+"chartmenu"});break;case"Export":e.push({template:'<ul id="'+this.parent.element.id+'export_menu"></ul>',id:this.parent.element.id+"exportmenu"});break;case"SubTotal":e.push({template:'<ul id="'+this.parent.element.id+'subtotal_menu"></ul>',id:this.parent.element.id+"subtotalmenu"});break;case"GrandTotal":e.push({template:'<ul id="'+this.parent.element.id+'grandtotal_menu"></ul>',id:this.parent.element.id+"grandtotalmenu"});break;case"ConditionalFormatting":e.push({prefixIcon:"e-toolbar-formatting "+C,id:this.parent.element.id+"formatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("toolbarFormatting")});break;case"NumberFormatting":e.push({prefixIcon:"e-pivot-format-toolbar "+C,id:this.parent.element.id+"numberFormatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("numberFormat")});break;case"Formatting":e.push({template:'<ul id="'+this.parent.element.id+'formatting_menu"></ul>',id:this.parent.element.id+"formattingmenu"});break;case"FieldList":e.push({prefixIcon:"e-toolbar-fieldlist "+C,tooltipText:this.parent.localeObj.getConstant("fieldList"),click:this.actionClick.bind(this),align:"Right",id:this.parent.element.id+"fieldlist"}),this.parent.element.querySelector(".e-toggle-field-list")&&(this.parent.element.querySelector(".e-toggle-field-list").style.display="none")}var n={customToolbar:e};return this.parent.trigger("toolbarRender",n),e},e.prototype.reportChange=function(e){this.dropArgs=e,this.parent.isModified&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.reportLoad(e)},e.prototype.reportLoad=function(e){var t=this;if("Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){var i={reportName:e.itemData.value};this.parent.trigger("loadReport",i,function(e){t.currentReport=e.reportName,t.parent.isModified=!1})}},e.prototype.saveReport=function(e){if(this.currentReport&&""!==this.currentReport&&e.item.id===this.parent.element.id+"save"){var t={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger("saveReport",t),this.parent.isModified=!1}else this.dialogShow(e,"saveAs")},e.prototype.dialogShow=function(e,i){this.dialog.header=e.item.tooltipText;var r=t.createElement("div",{className:"e-report-outer"}),n=t.createElement("div",{className:"e-pivotview-report-label",innerHTML:this.parent.localeObj.getConstant("reportName")}),a=t.createElement("input",{className:"e-pivotview-report-input "+F,innerHTML:i&&"rename"===i?this.currentReport:"",attrs:{placeholder:this.parent.localeObj.getConstant("emptyReportName"),value:i&&"rename"===i?this.currentReport:""}});a.setSelectionRange(a.textContent.length,a.textContent.length),r.appendChild(n),r.appendChild(a),this.dialog.content=r,this.dialog.refresh(),this.dialog.show()},e.prototype.renameReport=function(e){if(this.parent.trigger("toolbarClick",e),!this.currentReport||""===this.currentReport)return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"));this.dialogShow(e,"rename")},e.prototype.actionClick=function(e){switch(e.item.id){case this.parent.element.id+"save":case this.parent.element.id+"saveas":this.saveReport(e);break;case this.parent.element.id+"remove":return this.action="Remove",void(this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeConfirm")):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport")));case this.parent.element.id+"rename":this.renameReport(e);break;case this.parent.element.id+"new":this.action="New",this.parent.isModified?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.createNewReport();break;case this.parent.element.id+"load":this.action="Load";break;case this.parent.element.id+"fieldlist":this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.show();break;case this.parent.element.id+"formatting":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"numberFormatting":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog()}},e.prototype.renderDialog=function(){null!==document.querySelector("#"+this.parent.element.id+"report-dialog")&&t.remove(document.querySelector("#"+this.parent.element.id+"report-dialog")),this.parent.element.appendChild(t.createElement("div",{id:this.parent.element.id+"report-dialog",className:"e-pivotview-report-dialog"})),this.dialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,position:{X:"center",Y:"center"},buttons:[{click:this.okBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parent.element.id+"report-dialog")},e.prototype.okBtnClick=function(){var e=this.dialog.element.querySelector(".e-pivotview-report-input");if(e&&""===e.value)return void e.focus();var t=!1;if(this.dialog.header!==this.parent.localeObj.getConstant("save")&&this.dialog.header!==this.parent.localeObj.getConstant("saveAs")||!e.value||""===e.value){if(this.dialog.header===this.parent.localeObj.getConstant("rename")&&e.value&&""!==e.value){this.action="Rename";var i={reportName:this.currentReport,rename:e.value};this.parent.trigger("renameReport",i),this.currentReport=e.value}}else{"New"===this.action?t=!0:this.action="Save",this.currentReport=e.value;var r={report:this.parent.getPersistData(),reportName:e.value};this.parent.trigger("saveReport",r),this.parent.isModified=!1}this.updateReportList(),this.dialog.hide(),t&&this.createNewReport()},e.prototype.createNewReport=function(){this.currentReport="",this.reportList.value="",this.reportList.text="",this.reportList.refresh(),this.parent.trigger("newReport"),this.parent.isModified=!1},e.prototype.cancelBtnClick=function(){this.dialog.hide()},e.prototype.createConfirmDialog=function(e,i){document.getElementById(this.parent.element.id+"_ConfirmDialog")&&t.remove(document.getElementById(this.parent.element.id+"_ConfirmDialog").parentElement);var n=t.createElement("div",{id:this.parent.element.id+"_ConfirmDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(n),this.confirmPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0,cssClass:"e-ok-btn"},click:this.okButtonClick.bind(this)},{buttonModel:{content:this.parent.localeObj.getConstant("cancel"),cssClass:"e-cancel-btn"},click:this.cancelButtonClick.bind(this)}]}),this.confirmPopUp.isStringTemplate=!0,this.confirmPopUp.appendTo(n),this.confirmPopUp.element.querySelector(".e-dlg-header").innerHTML=e},e.prototype.okButtonClick=function(){if("Remove"===this.action){var e={reportName:this.currentReport};this.parent.trigger("removeReport",e),this.currentReport="",this.parent.isModified=!1,this.action="",this.updateReportList()}else if("New"===this.action||"Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action)if(this.currentReport&&""!==this.currentReport){var t={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger("saveReport",t),this.parent.isModified=!1,"New"===this.action?this.createNewReport():this.reportLoad(this.dropArgs)}else this.dialogShow({item:{tooltipText:this.parent.localeObj.getConstant("save")}});this.confirmPopUp.hide()},e.prototype.cancelButtonClick=function(){"New"===this.action?this.createNewReport():this.dropArgs&&this.reportLoad(this.dropArgs),this.confirmPopUp.hide()},e.prototype.create=function(){var e="Table"===this.parent.displayOption.view;if(this.parent.element.querySelector("#"+this.parent.element.id+"chart_menu")){t=[{iconCss:"e-toolbar-chart "+C,items:e?[]:[{text:this.parent.localeObj.getConstant("column"),id:this.parent.element.id+"_Column"},{text:this.parent.localeObj.getConstant("bar"),id:this.parent.element.id+"_Bar"},{text:this.parent.localeObj.getConstant("line"),id:this.parent.element.id+"_Line"},{text:this.parent.localeObj.getConstant("area"),id:this.parent.element.id+"_Area"},{text:this.parent.localeObj.getConstant("scatter"),id:this.parent.element.id+"_Scatter"},{text:this.parent.localeObj.getConstant("polar"),id:this.parent.element.id+"_Polar"}]}];this.chartMenu=new a.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this)}),this.chartMenu.isStringTemplate=!0,this.chartMenu.appendTo("#"+this.parent.element.id+"chart_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"export_menu")){t=[{iconCss:"e-export "+C,items:[{text:this.parent.localeObj.getConstant("pdf"),iconCss:"e-pivotview-pdf-export "+C,id:this.parent.element.id+"pdf"},{text:this.parent.localeObj.getConstant("excel"),iconCss:"e-pivotview-excel-export "+C,id:this.parent.element.id+"excel"},{text:this.parent.localeObj.getConstant("csv"),iconCss:"e-pivotview-csv-export "+C,id:this.parent.element.id+"csv"}]}];this.exportMenu=new a.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this)}),this.exportMenu.isStringTemplate=!0,this.exportMenu.appendTo("#"+this.parent.element.id+"export_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"subtotal_menu")){t=[{iconCss:"e-sub-total "+C,items:[{text:this.parent.localeObj.getConstant("showSubTotals"),id:this.parent.element.id+"subtotal",iconCss:N+" "+C},{text:this.parent.localeObj.getConstant("doNotShowSubTotals"),id:this.parent.element.id+"notsubtotal",iconCss:N+" "+C},{text:this.parent.localeObj.getConstant("showSubTotalsRowsOnly"),id:this.parent.element.id+"subtotalrow",iconCss:N+" "+C},{text:this.parent.localeObj.getConstant("showSubTotalsColumnsOnly"),id:this.parent.element.id+"subtotalcolumn",iconCss:N+" "+C}]}];this.subTotalMenu=new a.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateSubtotalSelection.bind(this)}),this.subTotalMenu.isStringTemplate=!0,this.subTotalMenu.appendTo("#"+this.parent.element.id+"subtotal_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"grandtotal_menu")){t=[{iconCss:"e-grand-total "+C,items:[{text:this.parent.localeObj.getConstant("showGrandTotals"),id:this.parent.element.id+"grandtotal",iconCss:N+" "+C},{text:this.parent.localeObj.getConstant("doNotShowGrandTotals"),id:this.parent.element.id+"notgrandtotal",iconCss:N+" "+C},{text:this.parent.localeObj.getConstant("showGrandTotalsRowsOnly"),id:this.parent.element.id+"grandtotalrow",iconCss:N+" "+C},{text:this.parent.localeObj.getConstant("showGrandTotalsColumnsOnly"),id:this.parent.element.id+"grandtotalcolumn",iconCss:N+" "+C}]}];this.grandTotalMenu=new a.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateGrandtotalSelection.bind(this)}),this.grandTotalMenu.isStringTemplate=!0,this.grandTotalMenu.appendTo("#"+this.parent.element.id+"grandtotal_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"formatting_menu")){var t=[{iconCss:"e-pivot-format-menu "+C,items:[{text:this.parent.localeObj.getConstant("numberFormat"),iconCss:"e-pivot-number-format-menu "+C,id:this.parent.element.id+"numberFormattingMenu"},{text:this.parent.localeObj.getConstant("conditionalFormating"),iconCss:"e-pivot-conditional-format-menu "+C,id:this.parent.element.id+"conditionalFormattingMenu"}]}];this.formattingMenu=new a.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this)}),this.formattingMenu.isStringTemplate=!0,this.formattingMenu.appendTo("#"+this.parent.element.id+"formatting_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"_reportlist")){var i=this.fetchReports();this.reportList=new l.DropDownList({dataSource:i.reportName,width:"150px",popupHeight:"200px",placeholder:""===this.currentReport?this.parent.localeObj.getConstant("reportList"):"",enableRtl:this.parent.enableRtl,cssClass:"e-reportlist-drop",select:this.reportChange.bind(this),value:this.currentReport}),this.reportList.isStringTemplate=!0,this.reportList.appendTo("#"+this.parent.element.id+"_reportlist")}},e.prototype.updateSubtotalSelection=function(e){e.element.querySelector("#"+this.parent.element.id+"subtotal ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"subtotal ."+N).classList.add(A),e.element.querySelector("#"+this.parent.element.id+"notsubtotal ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"notsubtotal ."+N).classList.add(A),e.element.querySelector("#"+this.parent.element.id+"subtotalrow ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"subtotalrow ."+N).classList.add(A),e.element.querySelector("#"+this.parent.element.id+"subtotalcolumn ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"subtotalcolumn ."+N).classList.add(A),this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&!this.parent.dataSourceSettings.showColumnSubTotals?e.element.querySelector("#"+this.parent.element.id+"subtotalrow ."+N).classList.remove(A):this.parent.dataSourceSettings.showSubTotals&&!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?e.element.querySelector("#"+this.parent.element.id+"subtotalcolumn ."+N).classList.remove(A):this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?e.element.querySelector("#"+this.parent.element.id+"subtotal ."+N).classList.remove(A):this.parent.dataSourceSettings.showSubTotals&&(this.parent.dataSourceSettings.showRowSubTotals||this.parent.dataSourceSettings.showColumnSubTotals)||e.element.querySelector("#"+this.parent.element.id+"notsubtotal ."+N).classList.remove(A)},e.prototype.updateGrandtotalSelection=function(e){e.element.querySelector("#"+this.parent.element.id+"grandtotal ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"grandtotal ."+N).classList.add(A),e.element.querySelector("#"+this.parent.element.id+"notgrandtotal ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"notgrandtotal ."+N).classList.add(A),e.element.querySelector("#"+this.parent.element.id+"grandtotalrow ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"grandtotalrow ."+N).classList.add(A),e.element.querySelector("#"+this.parent.element.id+"grandtotalcolumn ."+N).classList.contains(A)||e.element.querySelector("#"+this.parent.element.id+"grandtotalcolumn ."+N).classList.add(A),this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&!this.parent.dataSourceSettings.showColumnGrandTotals?e.element.querySelector("#"+this.parent.element.id+"grandtotalrow ."+N).classList.remove(A):this.parent.dataSourceSettings.showGrandTotals&&!this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?e.element.querySelector("#"+this.parent.element.id+"grandtotalcolumn ."+N).classList.remove(A):this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?e.element.querySelector("#"+this.parent.element.id+"grandtotal ."+N).classList.remove(A):this.parent.dataSourceSettings.showGrandTotals&&(this.parent.dataSourceSettings.showRowGrandTotals||this.parent.dataSourceSettings.showColumnGrandTotals)||e.element.querySelector("#"+this.parent.element.id+"notgrandtotal ."+N).classList.remove(A)},e.prototype.updateReportList=function(){var e=this.fetchReports();this.reportList.dataSource=e.reportName,""===this.currentReport&&this.reportList.dataSource.length>0?(this.reportList.value=this.reportList.dataSource[this.reportList.dataSource.length-1],this.reportList.text=this.reportList.dataSource[this.reportList.dataSource.length-1],this.currentReport=this.reportList.dataSource[this.reportList.dataSource.length-1]):(this.reportList.value=this.currentReport,this.reportList.text=this.currentReport),this.reportList.refresh()},e.prototype.menuItemClick=function(e){switch(e.item.id){case this.parent.element.id+"grid":this.parent.grid&&this.parent.chart&&(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.currentView="Table",this.parent.showGroupingBar&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"),this.parent.layoutRefresh());break;case this.parent.element.id+"_Column":case this.parent.element.id+"_Bar":case this.parent.element.id+"_Line":case this.parent.element.id+"_Area":case this.parent.element.id+"_Scatter":case this.parent.element.id+"_Polar":e.item&&e.item.text&&(this.parent.chartSettings.chartSeries.type=e.item.id.split("_")[e.item.id.split("_").length-1],this.parent.grid&&this.parent.chart&&(this.parent.grid.element.style.display="none",this.parent.chart.element.style.display="",this.parent.currentView="Chart",this.parent.showGroupingBar&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="")));break;case this.parent.element.id+"pdf":this.parent.pdfExportModule?this.parent.pdfExportModule.exportToPDF():this.parent.pdfExport();break;case this.parent.element.id+"excel":this.parent.excelExportModule?this.parent.excelExportModule.exportToExcel("Excel"):this.parent.excelExport();break;case this.parent.element.id+"csv":this.parent.excelExportModule?this.parent.excelExportModule.exportToExcel("csv"):this.parent.csvExport();break;case this.parent.element.id+"notsubtotal":this.parent.dataSourceSettings.showSubTotals=!1,this.parent.dataSourceSettings.showColumnSubTotals=!1,this.parent.dataSourceSettings.showRowSubTotals=!1;break;case this.parent.element.id+"subtotalrow":this.parent.dataSourceSettings.showSubTotals=!0,this.parent.dataSourceSettings.showColumnSubTotals=!1,this.parent.dataSourceSettings.showRowSubTotals=!0;break;case this.parent.element.id+"subtotalcolumn":this.parent.dataSourceSettings.showSubTotals=!0,this.parent.dataSourceSettings.showColumnSubTotals=!0,this.parent.dataSourceSettings.showRowSubTotals=!1;break;case this.parent.element.id+"subtotal":this.parent.dataSourceSettings.showSubTotals=!0,this.parent.dataSourceSettings.showColumnSubTotals=!0,this.parent.dataSourceSettings.showRowSubTotals=!0;break;case this.parent.element.id+"notgrandtotal":this.parent.dataSourceSettings.showGrandTotals=!1,this.parent.dataSourceSettings.showColumnGrandTotals=!1,this.parent.dataSourceSettings.showRowGrandTotals=!1;break;case this.parent.element.id+"grandtotalrow":this.parent.dataSourceSettings.showGrandTotals=!0,this.parent.dataSourceSettings.showColumnGrandTotals=!1,this.parent.dataSourceSettings.showRowGrandTotals=!0;break;case this.parent.element.id+"grandtotalcolumn":this.parent.dataSourceSettings.showGrandTotals=!0,this.parent.dataSourceSettings.showColumnGrandTotals=!0,this.parent.dataSourceSettings.showRowGrandTotals=!1;break;case this.parent.element.id+"grandtotal":this.parent.dataSourceSettings.showGrandTotals=!0,this.parent.dataSourceSettings.showColumnGrandTotals=!0,this.parent.dataSourceSettings.showRowGrandTotals=!0;break;case this.parent.element.id+"numberFormattingMenu":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog();break;case this.parent.element.id+"conditionalFormattingMenu":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog()}},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-toolbar",this.createToolbar,this)},e.prototype.refreshToolbar=function(){this.createToolbar()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-toolbar",this.createToolbar)},e.prototype.destroy=function(){this.removeEventListener(),this.confirmPopUp&&!this.confirmPopUp.isDestroyed&&this.confirmPopUp.destroy(),this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),this.chartMenu&&!this.chartMenu.isDestroyed&&this.chartMenu.destroy(),this.exportMenu&&!this.exportMenu.isDestroyed&&this.exportMenu.destroy(),this.subTotalMenu&&!this.subTotalMenu.isDestroyed&&this.subTotalMenu.destroy(),this.grandTotalMenu&&!this.grandTotalMenu.isDestroyed&&this.grandTotalMenu.destroy(),this.formattingMenu&&!this.formattingMenu.isDestroyed&&this.formattingMenu.destroy(),this.reportList&&!this.reportList.isDestroyed&&this.reportList.destroy(),this.toolbar&&!this.toolbar.isDestroyed&&this.toolbar.destroy()},e}(),We=function(){function e(e){this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,this.parent=e,this.parent.numberFormattingModule=this,this.removeEventListener(),this.addEventListener()}return e.prototype.getModuleName=function(){return"numberformatting"},e.prototype.showNumberFormattingDialog=function(){var e=this,i=t.createElement("div",{id:this.parent.element.id+"_FormatDialog",className:"e-pivot-format-dialog"});this.parent.element.appendChild(i),this.dialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("numberFormat"),content:this.getDialogContent(),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateFormatting.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("apply"),isPrimary:!0}},{click:function(){e.dialog.hide()},buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parent.element,overlayClick:function(){e.removeDialog()},close:this.removeDialog.bind(this)}),this.dialog.isStringTemplate=!0,this.dialog.appendTo(i),this.dialog.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("numberFormat"),this.renderControls()},e.prototype.getDialogContent=function(){var e=t.createElement("div",{id:this.parent.element.id+"_FormatDialogOuter",className:"e-pivot-format-dialog-outer"}),i=t.createElement("table",{id:this.parent.element.id+"_FormatTable",className:"e-pivot-format-table"}),r=t.createElement("tr"),n=t.createElement("td"),a=t.createElement("div",{id:this.parent.element.id+"_FormatValueLable",className:"e-pivot-format-value-lable",innerHTML:this.parent.localeObj.getConstant("values")}),o=t.createElement("div",{id:this.parent.element.id+"_FormatValueDrop"});n.appendChild(a),n.appendChild(o),r.appendChild(n),n=t.createElement("td");var l=t.createElement("div",{id:this.parent.element.id+"_GroupingLable",className:"e-pivot-format-grouping-lable",innerHTML:this.parent.localeObj.getConstant("grouping")}),s=t.createElement("div",{id:this.parent.element.id+"_GroupingDrop"});n.appendChild(l),n.appendChild(s),r.appendChild(n),i.appendChild(r),r=t.createElement("tr"),n=t.createElement("td");var d=t.createElement("div",{id:this.parent.element.id+"_FormatLable",className:"e-pivot-format-lable",innerHTML:this.parent.localeObj.getConstant("formatType")}),p=t.createElement("div",{id:this.parent.element.id+"_FormatDrop"});n.appendChild(d),n.appendChild(p),r.appendChild(n),n=t.createElement("td");var h=t.createElement("div",{id:this.parent.element.id+"_DecimalLable",className:"e-pivot-format-decimal-lable",innerHTML:this.parent.localeObj.getConstant("decimalPlaces")}),c=t.createElement("div",{id:this.parent.element.id+"_DecimalDrop"});n.appendChild(h),n.appendChild(c),r.appendChild(n),i.appendChild(r),r=t.createElement("tr"),n=t.createElement("td"),this.customLable=t.createElement("div",{id:this.parent.element.id+"_CustomLable",className:"e-pivot-format-custom-lable",innerHTML:this.parent.localeObj.getConstant("customText")}),this.customText=t.createElement("input",{id:this.parent.element.id+"_CustomText",attrs:{type:"text",tabindex:"1"},className:F+" e-pivot-format-custom-text"}),n.appendChild(this.customLable),n.appendChild(this.customText),r.appendChild(n),n=t.createElement("td"),this.symbolLable=t.createElement("div",{id:this.parent.element.id+"_SymbolLable",className:"e-pivot-format-symbol-lable",innerHTML:this.parent.localeObj.getConstant("symbolPosition")});var u=t.createElement("div",{id:this.parent.element.id+"_SymbolDrop"});return n.appendChild(this.symbolLable),n.appendChild(u),r.appendChild(n),i.appendChild(r),e.appendChild(i),e},e.prototype.renderControls=function(){if(this.dialog.element.querySelector("#"+this.parent.element.id+"_FormatValueDrop")){var e=[];e.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var t=0;t<this.parent.dataSourceSettings.values.length;t++)e.push({index:t+1,name:this.parent.dataSourceSettings.values[t].caption||this.parent.dataSourceSettings.values[t].name,field:this.parent.dataSourceSettings.values[t].name});this.valuesDropDown=new l.DropDownList({dataSource:e,fields:{text:"name",value:"field"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-value-drop",change:this.valueChange.bind(this)}),this.valuesDropDown.isStringTemplate=!0,this.valuesDropDown.appendTo("#"+this.parent.element.id+"_FormatValueDrop")}if(this.dialog.element.querySelector("#"+this.parent.element.id+"_FormatDrop")){i=[{index:0,name:this.parent.localeObj.getConstant("number")},{index:1,name:this.parent.localeObj.getConstant("currency")},{index:2,name:this.parent.localeObj.getConstant("percentage")}];this.formatDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},index:0,change:this.dropDownChange.bind(this),enableRtl:this.parent.enableRtl,cssClass:"e-pivot-format-drop"}),this.formatDropDown.isStringTemplate=!0,this.formatDropDown.appendTo("#"+this.parent.element.id+"_FormatDrop")}if(this.formatDropDown.value!==this.parent.localeObj.getConstant("currency")&&(this.customText&&this.customText.classList.add("e-disable"),this.customLable&&this.customLable.classList.add("e-disable"),this.symbolLable&&this.symbolLable.classList.add("e-disable")),this.dialog.element.querySelector("#"+this.parent.element.id+"_SymbolDrop")){i=[{index:0,name:this.parent.localeObj.getConstant("left")},{index:1,name:this.parent.localeObj.getConstant("right")}];this.symbolDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-symbol-drop"+(this.formatDropDown.value===this.parent.localeObj.getConstant("currency")?"":" e-disable")}),this.symbolDropDown.isStringTemplate=!0,this.symbolDropDown.appendTo("#"+this.parent.element.id+"_SymbolDrop")}if(this.dialog.element.querySelector("#"+this.parent.element.id+"_GroupingDrop")){i=[{index:0,name:this.parent.localeObj.getConstant("true")},{index:1,name:this.parent.localeObj.getConstant("false")}];this.groupingDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-grouping-drop"}),this.groupingDropDown.isStringTemplate=!0,this.groupingDropDown.appendTo("#"+this.parent.element.id+"_GroupingDrop")}if(this.dialog.element.querySelector("#"+this.parent.element.id+"_DecimalDrop")){var i=[{index:0,name:0},{index:1,name:1},{index:2,name:2},{index:3,name:3},{index:4,name:4},{index:5,name:5},{index:6,name:6},{index:7,name:7},{index:8,name:8},{index:9,name:9},{index:10,name:10}];this.decimalDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-decimal-drop",popupHeight:150}),this.decimalDropDown.isStringTemplate=!0,this.decimalDropDown.appendTo("#"+this.parent.element.id+"_DecimalDrop")}},e.prototype.valueChange=function(e){for(var t=this.parent.dataSourceSettings.formatSettings,i=!1,r=0;r<t.length;r++)if(t[r].name===e.value){var n=t[r].format,a=n.split("")[0].toLowerCase();if(2===n.length&&["n","p"].indexOf(a)>-1)this.formatDropDown.value="n"===a?this.parent.localeObj.getConstant("number"):"p"===a?this.parent.localeObj.getConstant("percentage"):this.parent.localeObj.getConstant("number"),this.decimalDropDown.value=Number(n.split("")[1]),this.groupingDropDown.value=t[r].useGrouping;else{this.formatDropDown.value=this.parent.localeObj.getConstant("currency");var o=this.parent.globalize.formatNumber(11111,{format:n}).split("1").join("#").match(this.customRegex);o&&o.length>0&&(this.symbolDropDown.value=""===o[10]?this.parent.localeObj.getConstant("left"):this.parent.localeObj.getConstant("right"),this.customText.value=""===o[10]?o[1]:o[10],this.decimalDropDown.value=o[7]&&o[7].lastIndexOf("0"),this.groupingDropDown.value=o[6]&&-1===o[6].indexOf(",")?this.parent.localeObj.getConstant("false"):this.parent.localeObj.getConstant("true"))}i=!0;break}i||(this.formatDropDown.value=this.parent.localeObj.getConstant("number"),this.decimalDropDown.value=0,this.groupingDropDown.value=this.parent.localeObj.getConstant("true"))},e.prototype.dropDownChange=function(e){e.value===this.parent.localeObj.getConstant("currency")?(this.customText.classList.contains("e-disable")&&this.customText.classList.remove("e-disable"),this.customLable.classList.contains("e-disable")&&this.customLable.classList.remove("e-disable"),this.symbolLable.classList.contains("e-disable")&&this.symbolLable.classList.remove("e-disable"),this.dialog.element.querySelector(".e-pivot-format-symbol-drop").classList.contains("e-disable")&&this.dialog.element.querySelector(".e-pivot-format-symbol-drop").classList.remove("e-disable")):(this.customText.classList.contains("e-disable")||this.customText.classList.add("e-disable"),this.customLable.classList.contains("e-disable")||this.customLable.classList.add("e-disable"),this.symbolLable.classList.contains("e-disable")||this.symbolLable.classList.add("e-disable"),this.dialog.element.querySelector(".e-pivot-format-symbol-drop").classList.contains("e-disable")||this.dialog.element.querySelector(".e-pivot-format-symbol-drop").classList.add("e-disable"))},e.prototype.removeDialog=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),document.getElementById(this.parent.element.id+"_FormatDialog")&&t.remove(document.getElementById(this.parent.element.id+"_FormatDialog"))},e.prototype.repeatString=function(e,t){for(var i="";t>0;)i+=e,t--;return i},e.prototype.updateFormatting=function(){var e,t=this;if(this.formatDropDown.value===this.parent.localeObj.getConstant("number")||this.formatDropDown.value===this.parent.localeObj.getConstant("percentage")?(e=this.formatDropDown.value===this.parent.localeObj.getConstant("number")?"N":"P",e+=this.decimalDropDown.value):e=this.symbolDropDown.value===this.parent.localeObj.getConstant("left")?this.customText.value+"##,###"+(0===this.decimalDropDown.value?"":".")+this.repeatString("0",this.decimalDropDown.value):"##,###"+(0===this.decimalDropDown.value?"":".")+this.repeatString("0",this.decimalDropDown.value)+this.customText.value,this.valuesDropDown.value===this.parent.localeObj.getConstant("AllValues")){var i=this.parent.engineModule.fieldList;Object.keys(i).forEach(function(r){"number"===i[r].type&&t.insertFormat(r,e)})}else this.insertFormat(this.valuesDropDown.value.toString(),e);this.parent.updateDataSource(!1),this.dialog.close()},e.prototype.insertFormat=function(e,t){for(var i=!1,r={name:e,format:t,useGrouping:this.groupingDropDown.value===this.parent.localeObj.getConstant("true")},n=this.parent.dataSourceSettings.formatSettings,a=0;a<n.length;a++)n[a].name===e&&(n[a]=r,i=!0);i||n.push(r)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-formatting",this.showNumberFormattingDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-formatting",this.showNumberFormattingDialog)},e.prototype.destroy=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),this.removeEventListener()},e}();return be.Inject(Ue,He,Ve,Ge,ie,ne,ze,ae,J,$,We),e.GroupingBarSettings=me,e.CellEditSettings=ve,e.ConditionalSettings=fe,e.HyperlinkSettings=ye,e.DisplayOption=Se,e.PivotView=be,e.Render=I,e.ExcelExport=$,e.PDFExport=J,e.KeyboardInteraction=ee,e.VirtualScroll=ie,e.DrillThrough=ne,e.PivotChart=ae,e.PivotFieldList=Ie,e.TreeViewRenderer=Le,e.AxisFieldRenderer=ke,e.AxisTableRenderer=Ee,e.DialogRenderer=Pe,e.EventBase=we,e.NodeStateModified=xe,e.DataSourceUpdate=Te,e.FieldList=He,e.CommonKeyboardInteraction=Ce,e.GroupingBar=Ue,e.CalculatedField=Ve,e.ConditionalFormatting=Ge,e.PivotCommon=Oe,e.load="load",e.enginePopulating="enginePopulating",e.enginePopulated="enginePopulated",e.onFieldDropped="onFieldDropped",e.beforePivotTableRender="beforePivotTableRender",e.afterPivotTableRender="afterPivotTableRender",e.beforeExport="beforeExport",e.excelHeaderQueryCellInfo="excelHeaderQueryCellInfo",e.pdfHeaderQueryCellInfo="pdfHeaderQueryCellInfo",e.excelQueryCellInfo="excelQueryCellInfo",e.pdfQueryCellInfo="pdfQueryCellInfo",e.onPdfCellRender="onPdfCellRender",e.dataBound="dataBound",e.queryCellInfo="queryCellInfo",e.headerCellInfo="headerCellInfo",e.hyperlinkCellClick="hyperlinkCellClick",e.resizing="resizing",e.resizeStop="resizeStop",e.cellClick="cellClick",e.drillThrough="drillThrough",e.beforeColumnsRender="beforeColumnsRender",e.selected="selected",e.cellSelecting="cellSelecting",e.drill="drill",e.cellSelected="cellSelected",e.cellDeselected="cellDeselected",e.rowSelected="rowSelected",e.rowDeselected="rowDeselected",e.beginDrillThrough="beginDrillThrough",e.saveReport="saveReport",e.fetchReport="fetchReport",e.loadReport="loadReport",e.renameReport="renameReport",e.removeReport="removeReport",e.newReport="newReport",e.toolbarRender="toolbarRender",e.toolbarClick="toolbarClick",e.chartTooltipRender="chartTooltipRender",e.chartLoaded="chartLoaded",e.chartLoad="chartLoad",e.chartResized="chartResized",e.chartAxisLabelRender="chartAxisLabelRender",e.chartSeriesCreated="chartSeriesCreated",e.aggregateCellInfo="aggregateCellInfo",e.contextMenuClick="contextMenuClick",e.contextMenuOpen="contextMenuOpen",e.fieldListRefreshed="fieldListRefreshed",e.initialLoad="initial-load",e.uiUpdate=m,e.scroll="scroll",e.contentReady=v,e.dataReady=f,e.initSubComponent="init-groupingbar",e.treeViewUpdate="tree-view-update",e.pivotButtonUpdate="pivot-button-update",e.initCalculatedField="init-calculatedfield",e.click="click",e.initToolbar="init-toolbar",e.initFormatting="init-formatting",e.ErrorDialog=De,e.FilterDialog=Me,e.PivotContextMenu=te,e.AggregateMenu=j,e.Toolbar=ze,e.NumberFormatting=We,e.PivotEngine=g,e.PivotUtil=u,e}({},ej.base,ej.data,ej.popups,ej.grids,ej.navigations,ej.inputs,ej.dropdowns,ej.excelexport,ej.pdfexport,ej.charts,ej.calendars,ej.buttons),this.ejs=ej;
//# sourceMappingURL=ej2-pivotview.min.js.map
